import{c as M,_ as w}from"./D_c8rnT5.js";import{_ as C}from"./VQ9UhDMB.js";import{J as S,r as f,N as $,aM as D,aN as o,aT as H,Q as n,b5 as a,K as l,aR as d,aU as y,aV as k,aQ as h,b8 as p,b4 as N}from"./BxKQXmcp.js";const U={key:0,class:"echo-loading"},z={key:1,class:"echo-error"},G={key:2,class:"echo-empty"},V={key:3,class:"echo-list"},W=["href","title"],J={class:"echo-header"},L={class:"echo-content"},O={class:"echo-text"},R={class:"echo-meta"},F={key:0,class:"echo-tags"},K=["title"],P={class:"echo-time"},Q={key:0,class:"echo-thumbnail"},j=["src","alt"],A=S({__name:"EchoTrend",setup(Z){const x=M(),_=f([]),u=f(!1),g=f(!1),b=async()=>{u.value=!0;try{const{echo:s}=x,t=await $fetch(`${s.apiBase}${s.apiEndpoint}?page=1&pageSize=3`);if(t?.data?.items){const i=t.data.items;_.value=i.filter(c=>!c.private).sort((c,e)=>new Date(e.created_at).getTime()-new Date(c.created_at).getTime()).slice(0,3)}}catch(s){console.error("Failed to fetch echos:",s),g.value=!0}finally{u.value=!1}},T=s=>{const t=new Date(s),c=new Date().getTime()-t.getTime(),e=Math.floor(c/1e3),r=Math.floor(e/60),m=Math.floor(r/60),v=Math.floor(m/24);return e<60?"刚刚":r<60?`${r}分钟前`:m<24?`${m}小时前`:v<7?`${v}天前`:t.toLocaleDateString("zh-CN")},E=(s,t=60)=>s?s.length>t?`${s.slice(0,t)}...`:s:"[无内容]",I=s=>{switch(s){case"GITHUBPROJ":case"GITHUB":return{icon:"mdi:github",color:"var(--c-text-2)"};case"MUSIC":return{icon:"mdi:music",color:"var(--c-primary)"};case"WEBSITE":return{icon:"mdi:globe",color:"var(--c-text-2)"};default:return{icon:"mdi:link",color:"var(--c-text-2)"}}},B=s=>({GITHUBPROJ:"GitHub 项目",GITHUB:"GitHub",MUSIC:"音乐",WEBSITE:"网站",LINK:"链接"})[s||""]||s||"";return $(()=>{b()}),(s,t)=>{const i=w,c=C;return o(),D(c,{card:"",title:"最新动态"},{default:H(()=>[l(u)?(o(),n("div",U,[d(i,{name:"eos-icons:loading",size:"16",class:"spin"}),t[0]||(t[0]=a("span",null,"加载中...",-1))])):l(g)?(o(),n("div",z,[d(i,{name:"mdi:alert-circle",size:"16"}),t[1]||(t[1]=a("span",null,"加载失败",-1))])):l(_).length===0?(o(),n("div",G,[d(i,{name:"mdi:inbox",size:"16"}),t[2]||(t[2]=a("span",null,"暂无动态",-1))])):(o(),n("div",V,[(o(!0),n(y,null,k(l(_),e=>(o(),n("a",{key:e.id,href:`https://echo.sotkg.com/echo/${e.id}`,target:"_blank",rel:"noopener noreferrer",class:"echo-item",title:e.content},[a("div",J,[a("div",L,[a("div",O,p(E(e.content,40)),1),a("div",R,[e.tags&&e.tags.length>0?(o(),n("div",F,[(o(!0),n(y,null,k(e.tags.slice(0,1),r=>(o(),n("span",{key:r.id,class:"echo-tag"}," #"+p(r.name),1))),128))])):h("",!0),e.extension_type?(o(),n("span",{key:1,class:"echo-extension-badge",title:B(e.extension_type)},[d(i,{name:I(e.extension_type).icon,size:"14"},null,8,["name"])],8,K)):h("",!0)])]),a("div",P,p(T(e.created_at)),1)]),e.images?.[0]?(o(),n("div",Q,[a("img",{src:e.images[0].image_url,alt:e.content},null,8,j)])):h("",!0)],8,W))),128))])),t[3]||(t[3]=a("div",{class:"echo-footer"},[a("a",{href:"/echo",class:"echo-link"},"查看更多 →")],-1))]),_:1})}}}),ee=Object.assign(N(A,[["__scopeId","data-v-23cf3006"]]),{__name:"WidgetEchoTrend"});export{ee as default};
