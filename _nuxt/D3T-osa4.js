const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./DvBnP_cS.js","./BYGqOC-p.js","./entry.DV8GKag2.css","./Alert.CtchqJiG.css","./DgD9KTZZ.js","./DuyiyQy-.js","./Badge.dpIaIqoD.css","./DX7SOQHw.js","./Blur.B-jU4pb_.css","./C868Bytw.js","./CardList.CUzalQHM.css","./ml5QgzrZ.js","./Chat.DflUvKVA.css","./D-eJHuyl.js","./Copy.2AyI_DCj.css","./B0gibjZN.js","./CcCM8wuB.js","./Folding.C2PAOQ-n.css","./DbaesHrK.js","./DBK03fJ4.js","./LinkBanner.B451pqZ3.css","./DjkbXbI6.js","./LinkCard.CKSSmepd.css","./CMHVM7QS.js","./MusicScore.T8ZaJg5P.css","./D-oPN9Sv.js","./rJCbAzvX.js","./ChI1zaDy.js","./Pic.BzJZ6rrE.css","./DuC4UknK.js","./Poetry.ywBKvOeN.css","./Dbj8QmDW.js","./ProseA.BTfGpl4j.css","./DYkC7e7V.js","./ProseCode.a2_W97gt.css","./-0pyIeX_.js","./ProseTable.DQgQdj7r.css","./DqzoMEW0.js","./Quote.JA7pZPsL.css","./BvYaVT4k.js","./Tab.B_z8VZ-t.css","./Cv_4tztT.js","./Timeline.C44sJ9Hm.css","./B8AK4tiX.js","./Tip.DbdmvSUm.css","./BR-PUW8w.js","./VideoEmbed.Bbf35Hia.css","./Xe8oAWP7.js","./Lightbox.CBHK7Kjn.css"])))=>i.map(i=>d[i]);
import{d as N,a7 as R,a8 as ne,c as E,a9 as F,aa as oe,N as D,e as q,ab as P,ac as A,ad as O,ae as se,af as H,ag as ae,ah as h,ai as ie,f as ce,Z as ue,h as K,X as le,u as M,B as pe,a3 as me,aj as de,ak as fe,o as _e,al as k,am as ge,W as he,k as ye,j as I,i as B,y as $,q as ve,z as be}from"#entry";import{f as Te,h as Ee}from"./rJCbAzvX.js";import{t as Pe}from"./ChI1zaDy.js";const C=["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","label","legend","li","link","main","map","mark","math","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rb","rp","rt","rtc","ruby","s","samp","script","section","select","slot","small","source","span","strong","style","sub","summary","sup","svg","table","tbody","td","template","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr"],Ce=["p","h1","h2","h3","h4","h5","h6","li"];function L(e,r){return e.type===r||typeof e.type=="object"&&e.type.tag===r||e.tag===r}function V(e){return L(e,"text")||L(e,Symbol.for("v-txt"))}function U(e){return Array.isArray(e.children)||typeof e.children=="string"?e.children:typeof e.children?.default=="function"?e.children.default():[]}function w(e){if(!e)return"";if(Array.isArray(e))return e.map(w).join("");if(V(e))return e.value||e.children||"";const r=U(e);return Array.isArray(r)?r.map(w).filter(Boolean).join(""):""}function X(e,r=[]){if(Array.isArray(e))return e.flatMap(n=>X(n,r));let t=e;return r.some(n=>n==="*"||L(e,n))&&(t=U(e)||e,!Array.isArray(t)&&Ce.some(n=>L(e,n))&&(t=[t])),t}function z(e,r=[]){return e=Array.isArray(e)?e:[e],r.length?e.flatMap(t=>z(X(t,[r[0]]),r.slice(1))).filter(t=>!(V(t)&&w(t).trim()==="")):e}function W(e,r=[]){return typeof r=="string"&&(r=r.split(/[,\s]/).map(t=>t.trim()).filter(Boolean)),r.length?z(e,r).reduce((t,n)=>(V(n)?typeof t[t.length-1]=="string"?t[t.length-1]+=n.children:t.push(n.children):t.push(n),t),[]):e}function Ae(e,r){return r.reduce((t,n)=>{const o=Oe(e,n);return o!==void 0&&(t[n]=o),t},{})}function Oe(e,r){return r.split(".").reduce((t,n)=>t&&t[n],e)}const S="default",G=/^@|^v-on:/,Q=/^:|^v-bind:/,Le=/^v-model/,we=["select","textarea","input"],xe=["math","svg"],ke=Object.fromEntries(["p","a","blockquote","code","pre","code","em","h1","h2","h3","h4","h5","h6","hr","img","ul","ol","li","strong","table","thead","tbody","td","th","tr","script"].map(e=>[e,`prose-${e}`])),Ie=["script","base"],Re=N({name:"MDCRenderer",props:{body:{type:Object,required:!0},data:{type:Object,default:()=>({})},class:{type:[String,Object],default:void 0},tag:{type:[String,Boolean],default:void 0},prose:{type:Boolean,default:void 0},components:{type:Object,default:()=>({})},unwrap:{type:[Boolean,String],default:!1}},async setup(e){const t=ne()?.appContext?.app?.$nuxt,n=t?.$route||t?._route,{mdc:o}=t?.$config?.public||{},i=E(()=>({...o?.components?.prose&&e.prose!==!1?ke:{},...o?.components?.map||{},...F(e.data?.mdc?.components||{}),...e.components})),g=E(()=>{const a=(e.body?.children||[]).map(c=>c.tag||c.type).filter(c=>!C.includes(c));return Array.from(new Set(a)).sort().join(".")}),d=oe({...e.data});D(()=>e.data,a=>{Object.assign(d,a)}),await He(e.body,{tags:i.value});function _(a,c){const y=a.split(".").length-1;return a.split(".").reduce((l,f,p)=>p==y&&l?(l[f]=c,l[f]):typeof l=="object"?l[f]:void 0,d)}return{tags:i,contentKey:g,route:n,runtimeData:d,updateRuntimeData:_}},render(e){const{tags:r,tag:t,body:n,data:o,contentKey:i,route:g,unwrap:d,runtimeData:_,updateRuntimeData:a}=e;if(!n)return null;const c={...o,tags:r,$route:g,runtimeData:_,updateRuntimeData:a},y=t!==!1?j(t||c.component?.name||c.component||"div"):void 0;return y?R(y,{...c.component?.props,class:e.class,...this.$attrs,key:i},{default:l}):l?.();function l(){const f=Z(n,R,{documentMeta:c,parentScope:c,resolveComponent:j});return f?.default?d?W(f.default(),typeof d=="string"?d.split(" "):["*"]):f.default():null}}});function De(e,r,t,n){const{documentMeta:o,parentScope:i,resolveComponent:g}=t;if(e.type==="text")return r(O,e.value);if(e.type==="comment")return r(se,null,e.value);const d=e.tag,_=Y(e,o.tags);if(e.tag==="binding")return Se(e,r,o,i);const a=J(_)?l=>l:g;if(Ie.includes(_))return r("pre",{class:"mdc-renderer-dangerous-tag"},"<"+_+">"+w(e)+"</"+_+">");const c=a(_);typeof c=="object"&&(c.tag=d);const y=je(e,o);return n&&(y.key=n),r(c,y,Z(e,r,{documentMeta:o,parentScope:{...i,...y},resolveComponent:a}))}function Z(e,r,t){const{documentMeta:n,parentScope:o,resolveComponent:i}=t,d=(e.children||[]).reduce((a,c)=>{if(!Fe(c))return a[S].children.push(c),a;const y=Ne(c);return a[y]=a[y]||{props:{},children:[]},c.type==="element"&&(a[y].props=c.props,a[y].children.push(...c.children||[])),a},{[S]:{props:{},children:[]}});return Object.entries(d).reduce((a,[c,{props:y,children:l}])=>(l.length&&(a[c]=(f={})=>{const p=Ae(f,Object.keys(y||{}));let s=l.map((u,m)=>De(u,r,{documentMeta:n,parentScope:{...o,...p},resolveComponent:i},String(u.props?.key||m)));return y?.unwrap&&(s=W(s,y.unwrap)),qe(s)}),a),{})}function Se(e,r,t,n={}){const o={...t.runtimeData,...n,$document:t,$doc:t},i=/\.|\[(\d+)\]/,d=(e.props?.value.trim().split(i).filter(Boolean)).reduce((a,c)=>{if(a&&c in a)return typeof a[c]=="function"?a[c]():a[c]},o),_=e.props?.defaultValue;return r(O,d??_??"")}function je(e,r){const{tag:t="",props:n={}}=e;return Object.keys(n).reduce(function(o,i){if(i==="__ignoreMap")return o;const g=n[i];if(Le.test(i))return Ve(i,g,o,r,{native:we.includes(t)});if(i==="v-bind")return Me(i,g,o,r);if(G.test(i))return Be(i,g,o,r);if(Q.test(i))return $e(i,g,o,r);const{attribute:d}=Te(Ee,i);return Array.isArray(g)&&g.every(_=>typeof _=="string")?(o[d]=g.join(" "),o):(o[d]=g,o)},{})}function Ve(e,r,t,n,{native:o}){const i=e.match(/^v-model:([^=]+)/)?.[1]||"modelValue",g=o?"value":i,d=o?"onInput":`onUpdate:${i}`;return t[g]=x(r,n.runtimeData),t[d]=_=>{n.updateRuntimeData(r,o?_.target?.value:_)},t}function Me(e,r,t,n){const o=x(r,n);return t=Object.assign(t,o),t}function Be(e,r,t,n){return e=e.replace(G,""),t.on=t.on||{},t.on[e]=()=>x(r,n),t}function $e(e,r,t,n){return e=e.replace(Q,""),t[e]=x(r,n),t}const j=e=>{if(typeof e=="string"){if(C.includes(e))return e;const r=q(P(e),!1);return!e||r?.name==="AsyncComponentWrapper"||typeof r=="string"?r:"setup"in r?A(()=>new Promise(t=>t(r))):r}return e};function x(e,r){const t=e.split(".").reduce((n,o)=>typeof n=="object"?n[o]:void 0,r);return typeof t>"u"?ae(e):t}function Ne(e){let r="";for(const t of Object.keys(e.props||{}))if(!(!t.startsWith("#")&&!t.startsWith("v-slot:"))){r=t.split(/[:#]/,2)[1];break}return r||S}function Fe(e){return e.tag==="template"}function J(e){return xe.includes(e)}function qe(e){const r=[];for(const t of e){const n=r[r.length-1];t.type===O&&n?.type===O?n.children=n.children+t.children:r.push(t)}return r}async function He(e,r){if(!e)return;const t=Array.from(new Set(n(e,r)));await Promise.all(t.map(async o=>{if(o?.render||o?.ssrRender||o?.__ssrInlineRender)return;const i=j(o);i?.__asyncLoader&&!i.__asyncResolved&&await i.__asyncLoader()}));function n(o,i){const g=o.tag;if(o.type==="text"||g==="binding"||o.type==="comment")return[];const d=Y(o,i.tags);if(J(d))return[];const _=[];o.type!=="root"&&!C.includes(d)&&_.push(d);for(const a of o.children||[])_.push(...n(a,i));return _}}function Y(e,r){const t=e.tag;return!t||typeof e.props?.__ignoreMap<"u"?t:r[t]||r[P(t)]||r[H(e.tag)]||t}const Ke=Object.assign(Re,{__name:"MDCRenderer"}),Ue=()=>h(()=>import("./DvBnP_cS.js"),__vite__mapDeps([0,1,2,3]),import.meta.url),Xe=()=>h(()=>import("./DgD9KTZZ.js"),__vite__mapDeps([4,1,2,5,6]),import.meta.url),ze=()=>h(()=>import("./DX7SOQHw.js"),__vite__mapDeps([7,1,2,8]),import.meta.url),We=()=>h(()=>import("./C868Bytw.js"),__vite__mapDeps([9,1,2,10]),import.meta.url),Ge=()=>h(()=>import("./ml5QgzrZ.js"),__vite__mapDeps([11,1,2,12]),import.meta.url),Qe=()=>h(()=>import("./D-eJHuyl.js"),__vite__mapDeps([13,1,2,14]),import.meta.url),Ze=()=>h(()=>import("./B0gibjZN.js"),__vite__mapDeps([15,1,2]),import.meta.url),Je=()=>h(()=>import("./CcCM8wuB.js"),__vite__mapDeps([16,1,2,17]),import.meta.url),Ye=()=>h(()=>import("#entry").then(e=>e.bg),[],import.meta.url),et=()=>h(()=>import("./DbaesHrK.js"),__vite__mapDeps([18,19,1,2,5,20]),import.meta.url),tt=()=>h(()=>import("./DjkbXbI6.js"),__vite__mapDeps([21,19,1,2,5,22]),import.meta.url),rt=()=>h(()=>import("./CMHVM7QS.js"),__vite__mapDeps([23,1,2,24]),import.meta.url),nt=()=>h(()=>import("./D-oPN9Sv.js"),__vite__mapDeps([25,19,1,2,5,26,27,28]),import.meta.url),ot=()=>h(()=>import("./DuC4UknK.js"),__vite__mapDeps([29,1,2,30]),import.meta.url),st=()=>h(()=>import("./Dbj8QmDW.js"),__vite__mapDeps([31,1,2,32]),import.meta.url),at=()=>h(()=>import("./DYkC7e7V.js"),__vite__mapDeps([33,1,2,34]),import.meta.url),it=()=>h(()=>import("#entry").then(e=>e.bh),[],import.meta.url),ct=()=>h(()=>import("./-0pyIeX_.js"),__vite__mapDeps([35,1,2,36]),import.meta.url),ut=()=>h(()=>import("./DqzoMEW0.js"),__vite__mapDeps([37,1,2,38]),import.meta.url),lt=()=>h(()=>import("./BvYaVT4k.js"),__vite__mapDeps([39,1,2,40]),import.meta.url),pt=()=>h(()=>import("./Cv_4tztT.js"),__vite__mapDeps([41,1,2,42]),import.meta.url),mt=()=>h(()=>import("./B8AK4tiX.js"),__vite__mapDeps([43,1,2,44]),import.meta.url),dt=()=>h(()=>import("./BR-PUW8w.js"),__vite__mapDeps([45,1,2,46]),import.meta.url),ee=["ZhiluHeader","ProseBlockquote","ProseEm","ProseH1","ProseH2","ProseH3","ProseH4","ProseH5","ProseH6","ProseHr","ProseImg","ProseLi","ProseOl","ProseP","ProseScript","ProseStrong","ProseTbody","ProseTd","ProseTh","ProseThead","ProseTr","ProseUl","Icon"],te=["Alert","Badge","Blur","CardList","Chat","Copy","EmojiClock","Folding","Key","LinkBanner","LinkCard","MusicScore","Pic","Poetry","ProseA","ProseCode","ProsePre","ProseTable","Quote","Tab","Timeline","Tip","VideoEmbed"],ft=Object.freeze(Object.defineProperty({__proto__:null,Alert:Ue,Badge:Xe,Blur:ze,CardList:We,Chat:Ge,Copy:Qe,EmojiClock:Ze,Folding:Je,Key:Ye,LinkBanner:et,LinkCard:tt,MusicScore:rt,Pic:nt,Poetry:ot,ProseA:st,ProseCode:at,ProsePre:it,ProseTable:ct,Quote:ut,Tab:lt,Timeline:pt,Tip:mt,VideoEmbed:dt,globalComponents:ee,localComponents:te},Symbol.toStringTag,{value:"Module"})),Ct={__name:"ContentRenderer",props:{value:{type:Object,required:!0},excerpt:{type:Boolean,default:!1},tag:{type:String,default:"div"},components:{type:Object,default:()=>({})},data:{type:Object,default:()=>({})},prose:{type:Boolean,default:void 0},class:{type:[String,Object],default:void 0},unwrap:{type:[Boolean,String],default:!1}},setup(e){const r=["render","ssrRender","__ssrInlineRender"],t=e,n=!1,o=E(()=>{let s=t.value.body||t.value;return t.excerpt&&t.value.excerpt&&(s=t.value.excerpt),s.type==="minimal"||s.type==="minimark"?Pe({value:s.value}):s}),i=E(()=>!o.value?.children?.length),g=E(()=>{const{body:s,excerpt:u,...m}=t.value;return{...m,...t.data}}),d=Object.fromEntries(["p","a","blockquote","code","pre","code","em","h1","h2","h3","h4","h5","h6","hr","img","ul","ol","li","strong","table","thead","tbody","td","th","tr","script"].map(s=>[s,`prose-${s}`])),{mdc:_}=ie().public||{},a=E(()=>({..._?.components?.prose&&t.prose!==!1?d:{},..._?.components?.map||{},...F(t.data?.mdc?.components||{}),...t.components})),c=E(()=>o.value?l(o.value,{tags:a.value}):{});function y(s){let u=s;if(typeof s=="string"){if(C.includes(s))return s;if(ee.includes(P(s))?u=q(s,!1):te.includes(P(s))&&(u=A(()=>h(()=>Promise.resolve().then(()=>ft),void 0,import.meta.url).then(b=>{const T=b[P(s)];return T?T():void 0}))),typeof u=="string")return u}if(!u)return u;const m=u;return"__asyncLoader"in m?m:"setup"in m?A(()=>Promise.resolve(m)):m}function l(s,u){if(!s)return;const m=Array.from(new Set(f(s,u))),v={};for(const[b,T]of m)if(!v[b]){if(typeof T=="object"&&r.some(re=>Object.hasOwnProperty.call(T,re))){v[b]=T;continue}v[b]=y(T)}return v}function f(s,u){const m=s.tag;if(s.type==="text"||m==="binding"||s.type==="comment")return[];const v=p(s,u.tags),b=[];s.type!=="root"&&!C.includes(v)&&b.push([m,v]);for(const T of s.children||[])b.push(...f(T,u));return b}function p(s,u){const m=s.tag;return!m||typeof s.props?.__ignoreMap<"u"?m:u[m]||u[P(m)]||u[H(s.tag)]||m}return(s,u)=>i.value?ue(s.$slots,"empty",{key:1,body:o.value,data:g.value,dataContentId:M(n)?e.value.id:void 0}):(K(),ce(Ke,{key:0,body:o.value,data:g.value,class:le(t.class),tag:t.tag,prose:t.prose,unwrap:t.unwrap,components:c.value,"data-content-id":M(n)?e.value.id:void 0},null,8,["body","data","class","tag","prose","unwrap","components","data-content-id"]))}},_t=A(()=>h(()=>import("./Xe8oAWP7.js"),__vite__mapDeps([47,1,2,48]),import.meta.url).then(e=>e.default||e.default||e)),gt={class:"z-comment"},ht={class:"text-creative"},yt={id:"artalk"},vt={class:"loading-box"},bt=N({__name:"Comment",setup(e){const r=pe(),t=me(),n=de(),o=ge.getInstance(),i=fe();function g(){return new Promise((l,f)=>{if(typeof window<"u"&&window.katex){l(window.katex);return}const p=document.querySelector('script[src*="katex"]');if(p){p.addEventListener("load",()=>l(window.katex)),p.addEventListener("error",f);return}const s=document.createElement("script");s.src="https://lib.baomitu.com/KaTeX/0.16.9/katex.min.js",s.onload=()=>l(window.katex),s.onerror=f,document.head.appendChild(s)})}async function d(){try{await g(),document.querySelectorAll("#artalk .atk-content:not(.math-processed)").forEach(f=>{f.classList.add("math-processed");let p=f.innerHTML;const s=p;p=p.replace(/\$\$([^$]+)\$\$/g,(u,m)=>{try{return`<span class="math-display">${window.katex.renderToString(m.trim(),{displayMode:!0})}</span>`}catch(v){return console.warn("KaTeX display render error:",v),u}}),p=p.replace(/\$([^$\n]+)\$/g,(u,m)=>{if(u.includes('<span class="math-'))return u;try{return`<span class="math-inline">${window.katex.renderToString(m.trim(),{displayMode:!1})}</span>`}catch(v){return console.warn("KaTeX inline render error:",v),u}}),p=p.replace(/```math\s*([\s\S]*?)```/g,(u,m)=>{try{return`<div class="math-block">${window.katex.renderToString(m.trim(),{displayMode:!0})}</div>`}catch(v){return console.warn("KaTeX math block render error:",v),u}}),p!==s&&(f.innerHTML=p)})}catch(l){console.error("Failed to load KaTeX:",l),setTimeout(()=>d(),1e3)}}function _(){document.querySelectorAll("#artalk .atk-content img").forEach(f=>{const p=f;p.style.cursor!=="zoom-in"&&(p.style.cursor="zoom-in",p.addEventListener("click",()=>{const{open:s}=i.use(()=>R(_t,{el:p}));s()}))})}let a=null;function c(){const l=document.getElementById("artalk");l&&(a&&a.disconnect(),a=new MutationObserver(f=>{let p=!1,s=!1;f.forEach(u=>{u.type==="childList"&&u.addedNodes.length>0&&u.addedNodes.forEach(m=>{if(m.nodeType===Node.ELEMENT_NODE){const v=m;(v.tagName==="IMG"||v.querySelector("img"))&&(p=!0),(v.classList?.contains("atk-content")||v.querySelector(".atk-content"))&&(s=!0)}})}),p&&setTimeout(()=>_(),100),s&&setTimeout(()=>d(),500)}),a.observe(l,{childList:!0,subtree:!0}))}async function y(){try{await o.init({el:"#artalk",pageKey:t.path,pageTitle:document.title.replace(` | ${r.title}`,""),server:r.artalk?.server,site:r.artalk?.site,emoticons:"/assets/Owo-Artalk.json",darkMode:n.value==="dark"}),await k(()=>{setTimeout(()=>{_(),setTimeout(()=>d(),1e3),c()},500)})}catch(l){console.error("评论系统初始化失败:",l)}}return _e(()=>{k(()=>{setTimeout(y,100)})}),D(()=>t.path,()=>{k(()=>{setTimeout(y,100)})}),D(()=>n.value,l=>{o.setDarkMode(l==="dark")}),he(()=>{a&&(a.disconnect(),a=null)}),(l,f)=>{const p=ve;return K(),ye("section",gt,[I("h3",ht,[B(p,{name:"i-hugeicons:comment-01",class:"comment-tip"}),f[0]||(f[0]=$("评论 ",-1))]),I("div",yt,[I("p",vt,[B(p,{name:"line-md:loading-twotone-loop",class:"loadig-img"}),f[1]||(f[1]=$("评论加载中... ",-1))])])])}}}),At=Object.assign(be(bt,[["__scopeId","data-v-45f0b573"]]),{__name:"PostComment"});export{_t as L,Ct as _,At as a};
