import{_ as A,c as W,e as V}from"./CQvtSiZB.js";import{J as w,Q as o,aN as a,b5 as e,aR as v,bp as N,aQ as S,b8 as c,a_ as M,b7 as O,b4 as x,K as _,aZ as j,r as g,x as b,aM as I,aT as P,aU as L,aV as z,ah as B,N as R}from"./BxKQXmcp.js";import{s as E,a as Q,f as U,u as H}from"./BZH4-wxM.js";import J from"./B4EivYri.js";import{_ as K}from"./vI8saG--.js";const Z={key:0,class:"steam-profile"},q={class:"profile-header"},X={class:"profile-info"},Y={class:"username-row"},ee={class:"username"},se={class:"status-badge-group"},te={key:0,class:"status-playing"},ae={key:1,class:"status-playing"},oe=["href"],ne={key:1,class:"steam-profile-empty"},le=w({__name:"SteamProfile",props:{user:{},metadata:{default:null}},setup(s){const r=t=>E[t]||"#90a0a6",i=t=>Q[t]||t;return(t,m)=>{const u=N;return s.user?(a(),o("div",Z,[e("div",q,[v(u,{src:s.user.avatar.large,alt:s.user.username,class:"avatar",loading:"lazy"},null,8,["src","alt"]),e("div",X,[e("div",Y,[e("h2",ee,c(s.user.username),1),e("div",se,[e("div",{class:"status-badge",style:M({"--status-color":r(s.user.status)})},[m[0]||(m[0]=e("span",{class:"status-dot"},null,-1)),O(" "+c(i(s.user.status)),1)],4)])]),s.user.currentGame?(a(),o("p",te," 正在玩 "+c(s.user.currentGame.name),1)):s.user.status==="offline"?(a(),o("p",ae," 用户当前离线 ")):S("",!0),e("a",{href:s.user.profileUrl,target:"_blank",class:"profile-link"}," 访问 Steam 个人资料 → ",8,oe)])])])):(a(),o("div",ne,[...m[1]||(m[1]=[e("p",null,"无法加载 Steam 数据",-1)])]))}}}),ie=Object.assign(x(le,[["__scopeId","data-v-23c4b0f2"]]),{__name:"SteamProfile"}),ce={class:"stats-overview"},re={class:"stat-card"},me={class:"stat-info"},de={class:"stat-value"},ue={class:"stat-card"},_e={class:"stat-info"},ve={class:"stat-value"},pe={key:0,class:"stat-card"},ge={class:"stat-info"},he={class:"stat-value"},ye=w({__name:"SteamStatsOverview",props:{games:{},user:{}},setup(s){return(r,i)=>{const t=A;return a(),o("div",ce,[e("div",re,[v(t,{name:"ph:game-controller-bold",size:"28",class:"stat-icon"}),e("div",me,[i[0]||(i[0]=e("div",{class:"stat-label"},"游戏总数量",-1)),e("div",de,c(s.games?.totalCount??0),1)])]),e("div",ue,[v(t,{name:"ph:hourglass-bold",size:"28",class:"stat-icon"}),e("div",_e,[i[1]||(i[1]=e("div",{class:"stat-label"},"总游玩时长",-1)),e("div",ve,c(s.user?.playtimeStats?.totalForever??0)+" 小时",1)])]),s.user?.playtimeStats?.totalTwoWeeks?(a(),o("div",pe,[v(t,{name:"ph:calendar-bold",size:"28",class:"stat-icon"}),e("div",ge,[i[2]||(i[2]=e("div",{class:"stat-label"},"两周内时长",-1)),e("div",he,c(_(U)(s.user.playtimeStats.totalTwoWeeks)),1)])])):S("",!0)])}}}),fe=Object.assign(x(ye,[["__scopeId","data-v-978277b1"]]),{__name:"SteamStatsOverview"}),$e=["title"],be={class:"game-header"},ke={class:"game-content"},Se={class:"game-name"},we={class:"game-meta"},xe={class:"meta-item"},Ge={class:"value"},Te={key:0,class:"meta-item"},Ie={class:"value"},Me={key:1,class:"meta-item"},Ce={class:"value"},Pe={key:0,class:"achievements-section"},Le={class:"achievements-header"},ze={class:"value"},De={class:"progress-bar"},Ae=w({__name:"GameCard",props:{game:{}},setup(s){const r=i=>{window.open(`https://store.steampowered.com/app/${i}`,"_blank")};return(i,t)=>{const m=N;return a(),o("div",{class:"game-card",title:`点击查看 ${s.game.name} 的 Steam 页面`,onClick:t[0]||(t[0]=u=>r(s.game.appid))},[e("div",be,[v(m,{src:s.game.images.headerImage,alt:s.game.name,class:"header-image",loading:"lazy"},null,8,["src","alt"]),t[1]||(t[1]=e("div",{class:"game-overlay"},null,-1))]),e("div",ke,[e("h3",Se,c(s.game.name),1),e("div",we,[e("div",xe,[t[2]||(t[2]=e("span",{class:"label"},"总时长:",-1)),e("span",Ge,c(s.game.playtimeForever)+"h",1)]),s.game.playtimeTwoWeeks!==void 0?(a(),o("div",Te,[t[3]||(t[3]=e("span",{class:"label"},"两周内时长:",-1)),e("span",Ie,c(s.game.playtimeTwoWeeks)+"h",1)])):S("",!0),s.game.price?(a(),o("div",Me,[t[4]||(t[4]=e("span",{class:"label"},"价格:",-1)),e("span",Ce,c(s.game.price.displayPrice),1)])):S("",!0)]),s.game.achievements?(a(),o("div",Pe,[e("div",Le,[t[5]||(t[5]=e("span",{class:"label"},"成就:",-1)),e("span",ze,c(s.game.achievements.unlocked)+"/"+c(s.game.achievements.total),1)]),e("div",De,[e("div",{class:j(["progress-fill",{"progress-complete":s.game.achievements.percentage===100}]),style:M({width:`${s.game.achievements.percentage}%`})},null,6)])])):S("",!0)])],8,$e)}}}),Ne=Object.assign(x(Ae,[["__scopeId","data-v-2de5899d"]]),{__name:"GameCard"}),Oe={class:"tab-content"},Fe={key:0},We={class:"games-list"},Ve={key:0,class:"load-more-container"},je={key:1,class:"all-loaded-tip"},Be={key:1,class:"empty-state"},Re={class:"tab-content"},Ee={key:0},Qe={class:"games-list"},Ue={key:0,class:"load-more-container"},He={key:1,class:"all-loaded-tip"},Je={key:1,class:"empty-state"},T=5,Ke=w({__name:"SteamGamesTabs",props:{games:{},gameLimit:{}},setup(s){const r=s,i=g(T),t=g(T),m=b(()=>{const l=r.games?.allGames;return l?l.map(n=>({...n,playtimeForever:typeof n.playtimeForever=="number"?Math.round(n.playtimeForever):0,playtimeTwoWeeks:n.playtimeTwoWeeks?Math.round(n.playtimeTwoWeeks):0})):[]}),u=b(()=>m.value),h=b(()=>(r.games?.recentGames||[]).slice(0,i.value)),k=b(()=>u.value.slice(0,t.value)),G=b(()=>{const l=r.games?.recentGames?.length||0;return i.value<l}),d=b(()=>t.value<u.value.length),C=()=>{i.value+=T},f=()=>{t.value+=T};return(l,n)=>{const $=Ne,p=J;return a(),I(p,{tabs:["最近游戏","游戏库"],center:""},{tab1:P(()=>[e("div",Oe,[h.value&&h.value.length>0?(a(),o("div",Fe,[e("div",We,[(a(!0),o(L,null,z(h.value,y=>(a(),I($,{key:y.appid,game:y,class:"games-list-item"},null,8,["game"]))),128))]),G.value?(a(),o("div",Ve,[e("button",{class:"load-more-btn",onClick:C}," 继续装填 ")])):(a(),o("div",je,[...n[0]||(n[0]=[e("p",null,"最近游戏已全部加载",-1)])]))])):(a(),o("div",Be,[...n[1]||(n[1]=[e("p",null,"暂无最近游戏数据",-1)])]))])]),tab2:P(()=>[e("div",Re,[u.value.length>0?(a(),o("div",Ee,[e("div",Qe,[(a(!0),o(L,null,z(k.value,y=>(a(),I($,{key:y.appid,game:y,class:"games-list-item"},null,8,["game"]))),128))]),d.value?(a(),o("div",Ue,[e("button",{class:"load-more-btn",onClick:f}," 继续装填 ")])):(a(),o("div",He,[e("p",null,[n[2]||(n[2]=O("最多显示按总时长排序的前 ",-1)),e("strong",null,c(r.gameLimit??20)+" 个游戏",1)])]))])):(a(),o("div",Je,[...n[3]||(n[3]=[e("p",null,"暂无游戏数据",-1)])]))])]),_:1})}}}),Ze=Object.assign(x(Ke,[["__scopeId","data-v-c69dd817"]]),{__name:"SteamGamesTabs"}),qe=globalThis.setInterval,Xe={class:"steam-page"},Ye={key:0,class:"loading-state"},es={class:"loading-container"},ss={class:"progress-bar-container"},ts={class:"progress-bar"},as={class:"progress-info"},os={class:"progress-text"},ns={key:1,class:"error-state"},ls={key:2,class:"steam-content"},D=20,is=w({__name:"steam",setup(s){const r=W(),i=V();B({title:"Steam",meta:[{name:"description",content:`${r.author.name} 的 Steam 个人资料，查看完整的游戏库、游戏时长、成就等信息。`},{property:"og:type",content:"profile"},{name:"keywords",content:"Steam,游戏库,游戏时长,成就"}]}),i.setAside(["blog-tech","comm-group"]);const{fetchSteamData:t}=H(),m=g(!0),u=g(!1),h=g(null),k=g(null),G=g(null),d=g(0);return R(async()=>{try{d.value=5,await new Promise(n=>setTimeout(n,300)),d.value=15;const f=qe(()=>{if(d.value<85){const n=Math.random()*8+2;d.value=Math.round(Math.min(d.value+n,85))}},400),l=await t(D);if(clearInterval(f),d.value=90,l.success&&l.data){const n=l.data,$=l.allMetadata;await Promise.all([(async()=>{h.value=n.user??null,await new Promise(p=>setTimeout(p,100))})(),(async()=>{k.value=n.games??null,await new Promise(p=>setTimeout(p,100))})(),(async()=>{G.value=$??null,await new Promise(p=>setTimeout(p,80))})()]),d.value=100}else console.warn("Steam API returned unsuccessful response or missing data"),u.value=!0}catch(f){console.error("Failed to fetch Steam data:",f),u.value=!0}finally{m.value=!1}}),(f,l)=>{const n=A,$=ie,p=fe,y=Ze,F=K;return a(),o("div",Xe,[_(m)?(a(),o("div",Ye,[e("div",es,[l[1]||(l[1]=e("p",{class:"loading-text"},"加载 Steam 数据中...",-1)),e("div",ss,[e("div",ts,[e("div",{class:"progress-fill",style:M({width:`${_(d)}%`})},null,4)]),e("div",as,[l[0]||(l[0]=e("p",{class:"loading-detail"},"正在获取用户信息、游戏库和成就数据...",-1)),e("p",os,c(Math.round(_(d)))+"%",1)])])])])):_(u)?(a(),o("div",ns,[v(n,{name:"ph:warning-bold",size:"36"}),l[2]||(l[2]=e("p",null,"无法加载 Steam 数据",-1)),l[3]||(l[3]=e("p",{class:"error-detail"},"请检查 API 是否可用",-1))])):(a(),o("div",ls,[v($,{user:_(h),metadata:_(G)},null,8,["user","metadata"]),v(p,{games:_(k),user:_(h)},null,8,["games","user"]),v(y,{games:_(k),"game-limit":D},null,8,["games"])])),v(F)])}}}),_s=x(is,[["__scopeId","data-v-c0573b21"]]);export{_s as default};
