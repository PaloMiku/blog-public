import{J as b,r as _,o as k,S as C,x as w,Q as i,aQ as p,K as s,aN as m,b5 as a,aR as G,br as $,b8 as c,a_ as x,aZ as N,b4 as B}from"./D6ajeznB.js";import{f as E}from"./btzuvjFo.js";import"./D-deoX8n.js";const S=["title"],z={class:"game-header"},D={class:"game-content"},I={class:"game-name"},V={class:"game-meta"},j={class:"meta-item"},F={class:"value"},M={key:0,class:"meta-item"},P={class:"value"},Q={key:1,class:"meta-item"},T={class:"value"},W={key:0,class:"achievements-section"},J={class:"achievements-header"},K={class:"value"},L={class:"progress-bar"},O={key:1,class:"game-card game-card-error"},R={key:2,class:"game-card game-card-loading"},U=b({__name:"GameCard",props:{game:{default:void 0},appid:{default:void 0}},setup(f){const u=f,h=`${E.steam?.apiBase}/steam-game`,v=new Map,d=_(!1),l=_(!1),g=_(null);let n=null;k(()=>u.appid,async o=>{if(o&&!u.game){if(v.has(o)){g.value=v.get(o)??null,d.value=!1,l.value=!1;return}d.value=!0,l.value=!1,n&&n.abort(),n=new AbortController;try{const e=await fetch(`${h}?appid=${o}`,{signal:n.signal});if(e.ok){const r=await e.json();r.success&&r.data?.game?(g.value=r.data.game,v.set(o,r.data.game)):l.value=!0}else l.value=!0}catch(e){e instanceof Error&&e.name!=="AbortError"&&(console.error("[GameCard] Fetch error:",e),l.value=!0)}finally{d.value=!1}}},{immediate:!0}),C(()=>{n&&n.abort()});const t=w(()=>u.game||g.value);function y(o){window.open(`https://store.steampowered.com/app/${o}`,"_blank")}return(o,e)=>{const r=$;return!s(d)&&s(t)?(m(),i("div",{key:0,class:"game-card",title:`点击查看 ${s(t).name} 的 Steam 页面`,onClick:e[0]||(e[0]=Z=>y(s(t).appid))},[a("div",z,[G(r,{src:s(t).images.headerImage,alt:s(t).name,class:"header-image",loading:"lazy"},null,8,["src","alt"]),e[1]||(e[1]=a("div",{class:"game-overlay"},null,-1))]),a("div",D,[a("h3",I,c(s(t).name),1),a("div",V,[a("div",j,[e[2]||(e[2]=a("span",{class:"label"},"总时长:",-1)),a("span",F,c(s(t).playtimeForever)+"h",1)]),s(t).playtimeTwoWeeks!==void 0?(m(),i("div",M,[e[3]||(e[3]=a("span",{class:"label"},"两周内时长:",-1)),a("span",P,c(s(t).playtimeTwoWeeks)+"h",1)])):p("",!0),s(t).price?(m(),i("div",Q,[e[4]||(e[4]=a("span",{class:"label"},"价格:",-1)),a("span",T,c(s(t).price.displayPrice),1)])):p("",!0)]),s(t).achievements?(m(),i("div",W,[a("div",J,[e[5]||(e[5]=a("span",{class:"label"},"成就:",-1)),a("span",K,c(s(t).achievements.unlocked)+"/"+c(s(t).achievements.total),1)]),a("div",L,[a("div",{class:N(["progress-fill",{"progress-complete":s(t).achievements.percentage===100}]),style:x({width:`${s(t).achievements.percentage}%`})},null,6)])])):p("",!0)])],8,S)):s(l)?(m(),i("div",O,[...e[6]||(e[6]=[a("div",{class:"error-content"},[a("p",null,"游戏加载失败"),a("small",null,"请检查游戏 ID 是否正确")],-1)])])):s(d)?(m(),i("div",R,[...e[7]||(e[7]=[a("div",{class:"loading-skeleton"},null,-1)])])):p("",!0)}}}),X=Object.assign(B(U,[["__scopeId","data-v-c2364304"]]),{__name:"GameCard"});export{X as default};
