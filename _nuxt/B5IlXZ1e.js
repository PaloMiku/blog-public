import{ar as w,as as R,at as x,au as G,av as Q,V as i,an as W,N as _}from"#entry";function D(o){return w()?(R(o),!0):!1}typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const p=new WeakMap;function O(o,c,m={}){const{mode:g="replace",route:f=x(),router:n=G(),transform:t}=m;let u=e=>e,l=e=>e;typeof t=="function"?u=t:t&&(t.get&&(u=t.get),t.set&&(l=t.set)),p.has(n)||p.set(n,new Map);const a=p.get(n);let r=f.query[o];D(()=>{r=void 0});let y;const h=Q((e,q)=>(y=q,{get(){return e(),u(r!==void 0?r:i(c))},set(s){s=l(s),r!==s&&(r=s===i(c)?void 0:s,a.set(o,s===i(c)?void 0:s),q(),W(()=>{if(a.size===0)return;const S=Object.fromEntries(a.entries());a.clear();const{params:d,query:b,hash:k}=f;n[i(g)]({params:d,query:{...b,...S},hash:k})}))}}));return _(()=>f.query[o],e=>{r!==u(e)&&(r=e,y())},{flush:"sync"}),h}export{O as u};
