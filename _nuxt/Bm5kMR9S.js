import{d as z,r as _,k as o,h as n,j as e,l as v,t as r,u as a,i as u,q as E,n as R,p as V,y as M,z as F,X as U,B as Z,C as K,E as Q,c as C,N as X,o as Y,G as J,w as L,Y as ee,K as te,Z as se,F as N,v as A,f as B}from"#entry";import{f as ae,s as ne,a as oe,u as le}from"./p0smk1q9.js";import ie from"./D4-wDhCI.js";import{_ as ce}from"./CKxHp0Vn.js";const re={key:0,class:"steam-profile"},de={class:"cache-header"},me={key:0,class:"cache-hint"},ue=["disabled","title"],ve={class:"profile-header"},ge={class:"profile-info"},_e={class:"username-row"},pe={class:"username"},he={key:0,class:"status-message"},fe=["href"],ye={key:0,class:"current-game-card"},be={class:"current-game-title"},ke={class:"current-game-content"},$e={class:"game-name"},Se={key:1,class:"steam-profile-skeleton"},Ge={key:2,class:"steam-profile-empty"},Ce=z({__name:"SteamProfile",props:{user:{},loading:{type:Boolean,default:!1},metadata:{default:null}},emits:["refresh"],setup(t,{emit:b}){const k=b,l=_(!1),$=async()=>{l.value=!0,k("refresh"),await new Promise(i=>setTimeout(i,500)),l.value=!1},f=i=>ne[i]||"#90a0a6",y=i=>oe[i]||i;return(i,c)=>{const S=E,m=R;return t.user?(n(),o("div",re,[e("div",de,[t.metadata?.user?(n(),o("div",me," 更新于 "+r(a(ae)(t.metadata.user?.cachedAt||"")),1)):v("",!0),e("button",{class:"refresh-btn",disabled:a(l),title:a(l)?"刷新中...":"刷新数据",onClick:$},[u(S,{name:a(l)?"ph:spinner-bold":"ph:arrow-clockwise-bold",size:"16"},null,8,["name"])],8,ue)]),e("div",ve,[u(m,{src:t.user.avatar.large,alt:t.user.username,class:"avatar",loading:"lazy"},null,8,["src","alt"]),e("div",ge,[e("div",_e,[e("h2",pe,r(t.user.username),1),e("div",{class:"status-badge",style:V({"--status-color":f(t.user.status)})},[c[0]||(c[0]=e("span",{class:"status-dot"},null,-1)),M(" "+r(y(t.user.status)),1)],4)]),t.user.statusMessage?(n(),o("p",he,r(t.user.statusMessage),1)):v("",!0),e("a",{href:t.user.profileUrl,target:"_blank",class:"profile-link"}," 访问 Steam 个人资料 → ",8,fe)])]),t.user.currentGame?(n(),o("div",ye,[e("div",be,[u(S,{name:"ph:play-bold",size:"16"}),c[1]||(c[1]=M(" 正在玩 ",-1))]),e("div",ke,[e("span",$e,r(t.user.currentGame.name),1)])])):v("",!0)])):t.loading?(n(),o("div",Se,[...c[2]||(c[2]=[e("div",{class:"skeleton-avatar"},null,-1),e("div",{class:"skeleton-info"},[e("div",{class:"skeleton-text"}),e("div",{class:"skeleton-text short"})],-1)])])):(n(),o("div",Ge,[...c[3]||(c[3]=[e("p",null,"无法加载 Steam 数据",-1)])]))}}}),we=Object.assign(F(Ce,[["__scopeId","data-v-95141d4c"]]),{__name:"SteamProfile"}),xe=["title"],Pe={class:"game-header"},ze={class:"game-content"},Fe={class:"game-name"},Te={class:"game-meta"},De={class:"meta-item"},Ie={class:"value"},Me={key:0,class:"meta-item"},Le={class:"value"},Ne={key:1,class:"meta-item"},Ae={class:"value"},Be={key:2,class:"meta-item"},Ee={class:"value"},Re={key:3,class:"meta-item"},Ve={class:"value"},We={key:0,class:"achievements-progress"},je={class:"progress-bar"},qe={class:"progress-text"},He={key:1,class:"game-description"},Oe=z({__name:"GameCard",props:{game:{}},setup(t){const b=k=>{window.open(`https://steamcommunity.com/app/${k}`,"_blank")};return(k,l)=>{const $=R;return n(),o("div",{class:"game-card",title:`点击查看 ${t.game.name} 的 Steam 页面`,onClick:l[0]||(l[0]=f=>b(t.game.appid))},[e("div",Pe,[u($,{src:t.game.images.headerImage,alt:t.game.name,class:"header-image",loading:"lazy"},null,8,["src","alt"]),l[1]||(l[1]=e("div",{class:"game-overlay"},null,-1))]),e("div",ze,[e("h3",Fe,r(t.game.name),1),e("div",Te,[e("div",De,[l[2]||(l[2]=e("span",{class:"label"},"总时长:",-1)),e("span",Ie,r(t.game.playtimeForever)+" 小时",1)]),t.game.playtimeTwoWeeks!==void 0?(n(),o("div",Me,[l[3]||(l[3]=e("span",{class:"label"},"最近两周:",-1)),e("span",Le,r(t.game.playtimeTwoWeeks)+" 小时",1)])):v("",!0),t.game.achievements?(n(),o("div",Ne,[l[4]||(l[4]=e("span",{class:"label"},"成就:",-1)),e("span",Ae,r(t.game.achievements.unlocked)+"/"+r(t.game.achievements.total),1)])):v("",!0),t.game.releaseDate?(n(),o("div",Be,[l[5]||(l[5]=e("span",{class:"label"},"发布:",-1)),e("span",Ee,r(t.game.releaseDate),1)])):v("",!0),t.game.price?(n(),o("div",Re,[l[6]||(l[6]=e("span",{class:"label"},"价格:",-1)),e("span",Ve,r(t.game.price.displayPrice),1)])):v("",!0)]),t.game.achievements?(n(),o("div",We,[e("div",je,[e("div",{class:U(["progress-fill",{"progress-complete":t.game.achievements.percentage===100}]),style:V({width:`${t.game.achievements.percentage}%`})},null,6)]),e("span",qe,"成就进度: "+r(t.game.achievements.percentage)+"%",1)])):v("",!0),t.game.shortDescription?(n(),o("p",He,r(t.game.shortDescription),1)):v("",!0),l[7]||(l[7]=e("div",{class:"game-footer"},[e("span",{class:"steam-link"}," 在 Steam 中查看 → ")],-1))])],8,xe)}}}),Ue=Object.assign(F(Oe,[["__scopeId","data-v-5213b5ec"]]),{__name:"GameCard"}),Ze={class:"steam-page"},Ke={class:"mobile-only"},Qe={key:0,class:"loading-state"},Xe={key:1,class:"error-state"},Ye={key:2,class:"steam-content"},Je={class:"profile-section"},et={class:"stats-overview"},tt={class:"stat-card"},st={class:"stat-info"},at={class:"stat-value"},nt={class:"stat-card"},ot={class:"stat-info"},lt={class:"stat-value"},it={key:0,class:"stat-card"},ct={class:"stat-info"},rt={class:"stat-value"},dt={class:"tab-content"},mt={key:0,class:"games-grid"},ut={key:1,class:"empty-state"},vt={class:"tab-content"},gt={class:"games-toolbar"},_t={class:"game-count"},pt={key:0,class:"games-grid"},ht={key:1,class:"empty-state"},ft={key:0},yt={key:1},bt={key:2,class:"pagination-control"},kt=["disabled"],$t=["disabled"],St={class:"page-info"},Gt=["disabled"],Ct=["disabled"],P=12,wt=z({__name:"steam",setup(t){const b=Z();K().setAside(["blog-tech","comm-group"]),Q({title:"Steam",meta:[{name:"description",content:`${b.author.name} 的 Steam 个人资料，查看完整的游戏库、游戏时长、成就等信息。`},{property:"og:type",content:"profile"},{name:"keywords",content:"Steam,游戏库,游戏时长,成就"}]});const{fetchSteamData:l,formatPlaytime:$}=le(),f=_(!0),y=_(!1),i=_(null),c=_(null),S=_(null),m=_(1),p=_(""),w=C(()=>{if(!c.value?.allGames)return[];let d=[...c.value.allGames];if(p.value.trim()){const s=p.value.toLowerCase();d=d.filter(h=>h.name.toLowerCase().includes(s))}return d.sort((s,h)=>h.playtimeForever-s.playtimeForever)}),G=C(()=>Math.ceil(w.value.length/P)),W=C(()=>{const d=(m.value-1)*P,s=d+P;return w.value.slice(d,s)});X(p,()=>{m.value=1});const j=C(()=>i.value?.playtimeStats?.totalForever?i.value.playtimeStats.totalForever:c.value?.allGames?c.value.allGames.reduce((d,s)=>d+s.playtimeForever,0):0);C(()=>{if(!i.value?.currentGame||!c.value?.recentGames)return null;const d=c.value.recentGames.find(s=>s.appid===i.value.currentGame.appid);return d&&i.value.currentGame?{...i.value.currentGame,images:d.images}:i.value.currentGame});const T=async()=>{f.value=!0,y.value=!1,await D()},D=async()=>{try{const d=await l();if(d.success&&d.data){if(i.value=d.data.user,c.value=d.data.games,S.value=d.allMetadata,i.value?.currentGame&&c.value?.recentGames){const s=c.value.recentGames.find(h=>h.appid===i.value.currentGame.appid);s&&(i.value.currentGame={...i.value.currentGame,images:s.images})}}else y.value=!0}catch(d){console.error("Failed to fetch Steam data:",d),y.value=!0}finally{f.value=!1}};return Y(D),(d,s)=>{const h=J,x=E,q=we,I=Ue,H=ie,O=ce;return n(),o("div",Ze,[e("div",Ke,[u(h,{to:"/",suffix:"Steam"})]),a(f)?(n(),o("div",Qe,[...s[5]||(s[5]=[e("div",{class:"spinner"},null,-1),e("p",null,"加载 Steam 数据中...",-1)])])):a(y)?(n(),o("div",Xe,[u(x,{name:"ph:warning-bold",size:"48"}),s[6]||(s[6]=e("p",null,"无法加载 Steam 数据",-1)),s[7]||(s[7]=e("p",{class:"error-detail"},"请检查 API 是否可用或稍后重试",-1)),e("button",{onClick:T}," 重试 ")])):a(i)&&a(c)?(n(),o("div",Ye,[e("div",Je,[u(q,{user:a(i),metadata:a(S),onRefresh:T},null,8,["user","metadata"])]),e("div",et,[e("div",tt,[u(x,{name:"ph:game-controller-bold",size:"28",class:"stat-icon"}),e("div",st,[s[8]||(s[8]=e("div",{class:"stat-label"},"游戏总数",-1)),e("div",at,r(a(c).totalCount),1)])]),e("div",nt,[u(x,{name:"ph:hourglass-bold",size:"28",class:"stat-icon"}),e("div",ot,[s[9]||(s[9]=e("div",{class:"stat-label"},"总游玩时长",-1)),e("div",lt,r(a(j))+" 小时",1)])]),a(i)?.playtimeStats?.totalTwoWeeks?(n(),o("div",it,[u(x,{name:"ph:calendar-bold",size:"28",class:"stat-icon"}),e("div",ct,[s[10]||(s[10]=e("div",{class:"stat-label"},"最近两周内时长",-1)),e("div",rt,r(a($)(a(i).playtimeStats.totalTwoWeeks)),1)])])):v("",!0)]),u(H,{tabs:["最近游戏","游戏库"],center:""},{tab1:L(()=>[e("div",dt,[a(c).recentGames.length>0?(n(),o("div",mt,[(n(!0),o(N,null,A(a(c).recentGames,g=>(n(),B(I,{key:g.appid,game:g},null,8,["game"]))),128))])):(n(),o("div",ut,[...s[11]||(s[11]=[e("p",null,"暂无最近游戏数据",-1)])]))])]),tab2:L(()=>[e("div",vt,[e("div",gt,[ee(e("input",{"onUpdate:modelValue":s[0]||(s[0]=g=>te(p)?p.value=g:null),type:"text",placeholder:"搜索游戏...",class:"search-input"},null,512),[[se,a(p)]]),e("div",_t,r(a(w).length)+" / "+r(a(c).totalCount),1)]),a(w).length>0?(n(),o("div",pt,[(n(!0),o(N,null,A(a(W),g=>(n(),B(I,{key:g.appid,game:g},null,8,["game"]))),128))])):(n(),o("div",ht,[a(p)?(n(),o("p",ft," 没有找到匹配的游戏 ")):(n(),o("p",yt," 暂无游戏数据 "))])),a(G)>1?(n(),o("div",bt,[e("button",{disabled:a(m)===1,onClick:s[1]||(s[1]=g=>m.value=1),class:"page-btn"}," 首页 ",8,kt),e("button",{disabled:a(m)===1,onClick:s[2]||(s[2]=g=>m.value--),class:"page-btn"}," 上一页 ",8,$t),e("div",St," 第 "+r(a(m))+" / "+r(a(G))+" 页 ",1),e("button",{disabled:a(m)===a(G),onClick:s[3]||(s[3]=g=>m.value++),class:"page-btn"}," 下一页 ",8,Gt),e("button",{disabled:a(m)===a(G),onClick:s[4]||(s[4]=g=>m.value=a(G)),class:"page-btn"}," 末页 ",8,Ct)])):v("",!0)])]),_:1})])):v("",!0),u(O)])}}}),Tt=F(wt,[["__scopeId","data-v-45b633ca"]]);export{Tt as default};
