import{d as I,r as _,k as o,h as n,j as e,l as v,t as c,u as a,i as u,q as E,n as R,p as V,y as L,f as z,z as F,X as U,B as Z,C as K,E as Q,c as C,N as X,o as Y,G as J,w as N,Y as ee,K as te,Z as se,F as A,v as B}from"#entry";import{f as ae,s as ne,a as oe,u as le}from"./p0smk1q9.js";import ie from"./D4-wDhCI.js";import{_ as re}from"./CKxHp0Vn.js";const ce={key:0,class:"steam-profile"},de={class:"cache-header"},me={key:0,class:"cache-hint"},ue=["disabled","title"],ve={class:"profile-header"},ge={class:"profile-info"},_e={class:"username-row"},he={class:"username"},pe={key:0,class:"status-message"},fe=["href"],ye={key:0,class:"current-game-card"},be={class:"current-game-container"},ke={key:1,class:"current-game-image-placeholder"},$e={class:"current-game-overlay"},Ge={class:"current-game-title"},Se={class:"current-game-name"},Ce={key:1,class:"steam-profile-skeleton"},we={key:2,class:"steam-profile-empty"},xe=I({__name:"SteamProfile",props:{user:{},loading:{type:Boolean,default:!1},metadata:{default:null}},emits:["refresh"],setup(t,{emit:b}){const k=b,l=_(!1),$=async()=>{l.value=!0,k("refresh"),await new Promise(i=>setTimeout(i,500)),l.value=!1},f=i=>ne[i]||"#90a0a6",y=i=>oe[i]||i;return(i,r)=>{const G=E,m=R;return t.user?(n(),o("div",ce,[e("div",de,[t.metadata?.user?(n(),o("div",me," 更新于 "+c(a(ae)(t.metadata.user?.cachedAt||"")),1)):v("",!0),e("button",{class:"refresh-btn",disabled:a(l),title:a(l)?"刷新中...":"刷新数据",onClick:$},[u(G,{name:a(l)?"ph:spinner-bold":"ph:arrow-clockwise-bold",size:"16"},null,8,["name"])],8,ue)]),e("div",ve,[u(m,{src:t.user.avatar.large,alt:t.user.username,class:"avatar",loading:"lazy"},null,8,["src","alt"]),e("div",ge,[e("div",_e,[e("h2",he,c(t.user.username),1),e("div",{class:"status-badge",style:V({"--status-color":f(t.user.status)})},[r[0]||(r[0]=e("span",{class:"status-dot"},null,-1)),L(" "+c(y(t.user.status)),1)],4)]),t.user.statusMessage?(n(),o("p",pe,c(t.user.statusMessage),1)):v("",!0),e("a",{href:t.user.profileUrl,target:"_blank",class:"profile-link"}," 访问 Steam 个人资料 → ",8,fe)])]),t.user.currentGame?(n(),o("div",ye,[e("div",be,[t.user.currentGame.images?.headerImage?(n(),z(m,{key:0,src:t.user.currentGame.images.headerImage,alt:t.user.currentGame.name,class:"current-game-image",loading:"lazy"},null,8,["src","alt"])):(n(),o("div",ke)),e("div",$e,[e("div",Ge,[u(G,{name:"ph:play-bold",size:"16"}),r[1]||(r[1]=L(" 正在玩 ",-1))]),e("h3",Se,c(t.user.currentGame.name),1)])])])):v("",!0)])):t.loading?(n(),o("div",Ce,[...r[2]||(r[2]=[e("div",{class:"skeleton-avatar"},null,-1),e("div",{class:"skeleton-info"},[e("div",{class:"skeleton-text"}),e("div",{class:"skeleton-text short"})],-1)])])):(n(),o("div",we,[...r[3]||(r[3]=[e("p",null,"无法加载 Steam 数据",-1)])]))}}}),Pe=Object.assign(F(xe,[["__scopeId","data-v-3ab0df01"]]),{__name:"SteamProfile"}),ze=["title"],Ie={class:"game-header"},Fe={class:"game-content"},Te={class:"game-name"},De={class:"game-meta"},Me={class:"meta-item"},Le={class:"value"},Ne={key:0,class:"meta-item"},Ae={class:"value"},Be={key:1,class:"meta-item"},Ee={class:"value"},Re={key:2,class:"meta-item"},Ve={class:"value"},We={key:3,class:"meta-item"},je={class:"value"},qe={key:0,class:"achievements-progress"},He={class:"progress-bar"},Oe={class:"progress-text"},Ue={key:1,class:"game-description"},Ze=I({__name:"GameCard",props:{game:{}},setup(t){const b=k=>{window.open(`https://steamcommunity.com/app/${k}`,"_blank")};return(k,l)=>{const $=R;return n(),o("div",{class:"game-card",title:`点击查看 ${t.game.name} 的 Steam 页面`,onClick:l[0]||(l[0]=f=>b(t.game.appid))},[e("div",Ie,[u($,{src:t.game.images.headerImage,alt:t.game.name,class:"header-image",loading:"lazy"},null,8,["src","alt"]),l[1]||(l[1]=e("div",{class:"game-overlay"},null,-1))]),e("div",Fe,[e("h3",Te,c(t.game.name),1),e("div",De,[e("div",Me,[l[2]||(l[2]=e("span",{class:"label"},"总时长:",-1)),e("span",Le,c(t.game.playtimeForever)+" 小时",1)]),t.game.playtimeTwoWeeks!==void 0?(n(),o("div",Ne,[l[3]||(l[3]=e("span",{class:"label"},"最近两周:",-1)),e("span",Ae,c(t.game.playtimeTwoWeeks)+" 小时",1)])):v("",!0),t.game.achievements?(n(),o("div",Be,[l[4]||(l[4]=e("span",{class:"label"},"成就:",-1)),e("span",Ee,c(t.game.achievements.unlocked)+"/"+c(t.game.achievements.total),1)])):v("",!0),t.game.releaseDate?(n(),o("div",Re,[l[5]||(l[5]=e("span",{class:"label"},"发布:",-1)),e("span",Ve,c(t.game.releaseDate),1)])):v("",!0),t.game.price?(n(),o("div",We,[l[6]||(l[6]=e("span",{class:"label"},"价格:",-1)),e("span",je,c(t.game.price.displayPrice),1)])):v("",!0)]),t.game.achievements?(n(),o("div",qe,[e("div",He,[e("div",{class:U(["progress-fill",{"progress-complete":t.game.achievements.percentage===100}]),style:V({width:`${t.game.achievements.percentage}%`})},null,6)]),e("span",Oe,c(t.game.achievements.percentage)+"% 完成",1)])):v("",!0),t.game.shortDescription?(n(),o("p",Ue,c(t.game.shortDescription),1)):v("",!0),l[7]||(l[7]=e("div",{class:"game-footer"},[e("span",{class:"steam-link"}," 在 Steam 中查看 → ")],-1))])],8,ze)}}}),Ke=Object.assign(F(Ze,[["__scopeId","data-v-bc8d7c9e"]]),{__name:"GameCard"}),Qe={class:"steam-page"},Xe={class:"mobile-only"},Ye={key:0,class:"loading-state"},Je={key:1,class:"error-state"},et={key:2,class:"steam-content"},tt={class:"profile-section"},st={class:"stats-overview"},at={class:"stat-card"},nt={class:"stat-info"},ot={class:"stat-value"},lt={class:"stat-card"},it={class:"stat-info"},rt={class:"stat-value"},ct={key:0,class:"stat-card"},dt={class:"stat-info"},mt={class:"stat-value"},ut={class:"tab-content"},vt={key:0,class:"games-grid"},gt={key:1,class:"empty-state"},_t={class:"tab-content"},ht={class:"games-toolbar"},pt={class:"game-count"},ft={key:0,class:"games-grid"},yt={key:1,class:"empty-state"},bt={key:0},kt={key:1},$t={key:2,class:"pagination-control"},Gt=["disabled"],St=["disabled"],Ct={class:"page-info"},wt=["disabled"],xt=["disabled"],P=12,Pt=I({__name:"steam",setup(t){const b=Z();K().setAside(["blog-tech","comm-group"]),Q({title:"Steam",meta:[{name:"description",content:`${b.author.name} 的 Steam 个人资料，查看游戏库、游戏时长、成就等信息。`},{property:"og:type",content:"profile"}]});const{fetchSteamData:l,formatPlaytime:$}=le(),f=_(!0),y=_(!1),i=_(null),r=_(null),G=_(null),m=_(1),h=_(""),w=C(()=>{if(!r.value?.allGames)return[];let d=[...r.value.allGames];if(h.value.trim()){const s=h.value.toLowerCase();d=d.filter(p=>p.name.toLowerCase().includes(s))}return d.sort((s,p)=>p.playtimeForever-s.playtimeForever)}),S=C(()=>Math.ceil(w.value.length/P)),W=C(()=>{const d=(m.value-1)*P,s=d+P;return w.value.slice(d,s)});X(h,()=>{m.value=1});const j=C(()=>i.value?.playtimeStats?.totalForever?i.value.playtimeStats.totalForever:r.value?.allGames?r.value.allGames.reduce((d,s)=>d+s.playtimeForever,0):0);C(()=>{if(!i.value?.currentGame||!r.value?.recentGames)return null;const d=r.value.recentGames.find(s=>s.appid===i.value.currentGame.appid);return d&&i.value.currentGame?{...i.value.currentGame,images:d.images}:i.value.currentGame});const T=async()=>{f.value=!0,y.value=!1,await D()},D=async()=>{try{const d=await l();if(d.success&&d.data){if(i.value=d.data.user,r.value=d.data.games,G.value=d.allMetadata,i.value?.currentGame&&r.value?.recentGames){const s=r.value.recentGames.find(p=>p.appid===i.value.currentGame.appid);s&&(i.value.currentGame={...i.value.currentGame,images:s.images})}}else y.value=!0}catch(d){console.error("Failed to fetch Steam data:",d),y.value=!0}finally{f.value=!1}};return Y(D),(d,s)=>{const p=J,x=E,q=Pe,M=Ke,H=ie,O=re;return n(),o("div",Qe,[e("div",Xe,[u(p,{to:"/",suffix:"Steam"})]),a(f)?(n(),o("div",Ye,[...s[5]||(s[5]=[e("div",{class:"spinner"},null,-1),e("p",null,"加载 Steam 数据中...",-1)])])):a(y)?(n(),o("div",Je,[u(x,{name:"ph:warning-bold",size:"48"}),s[6]||(s[6]=e("p",null,"无法加载 Steam 数据",-1)),s[7]||(s[7]=e("p",{class:"error-detail"},"请检查 API 是否可用或稍后重试",-1)),e("button",{onClick:T}," 重试 ")])):a(i)&&a(r)?(n(),o("div",et,[e("div",tt,[u(q,{user:a(i),metadata:a(G),onRefresh:T},null,8,["user","metadata"])]),e("div",st,[e("div",at,[u(x,{name:"ph:game-controller-bold",size:"28",class:"stat-icon"}),e("div",nt,[s[8]||(s[8]=e("div",{class:"stat-label"},"游戏总数",-1)),e("div",ot,c(a(r).totalCount),1)])]),e("div",lt,[u(x,{name:"ph:hourglass-bold",size:"28",class:"stat-icon"}),e("div",it,[s[9]||(s[9]=e("div",{class:"stat-label"},"总游玩时长",-1)),e("div",rt,c(a(j))+" 小时",1)])]),a(i)?.playtimeStats?.totalTwoWeeks?(n(),o("div",ct,[u(x,{name:"ph:calendar-bold",size:"28",class:"stat-icon"}),e("div",dt,[s[10]||(s[10]=e("div",{class:"stat-label"},"最近两周内时长",-1)),e("div",mt,c(a($)(a(i).playtimeStats.totalTwoWeeks)),1)])])):v("",!0)]),u(H,{tabs:["最近游戏","游戏库"],center:""},{tab1:N(()=>[e("div",ut,[a(r).recentGames.length>0?(n(),o("div",vt,[(n(!0),o(A,null,B(a(r).recentGames,g=>(n(),z(M,{key:g.appid,game:g},null,8,["game"]))),128))])):(n(),o("div",gt,[...s[11]||(s[11]=[e("p",null,"暂无最近游戏数据",-1)])]))])]),tab2:N(()=>[e("div",_t,[e("div",ht,[ee(e("input",{"onUpdate:modelValue":s[0]||(s[0]=g=>te(h)?h.value=g:null),type:"text",placeholder:"搜索游戏...",class:"search-input"},null,512),[[se,a(h)]]),e("div",pt,c(a(w).length)+" / "+c(a(r).totalCount),1)]),a(w).length>0?(n(),o("div",ft,[(n(!0),o(A,null,B(a(W),g=>(n(),z(M,{key:g.appid,game:g},null,8,["game"]))),128))])):(n(),o("div",yt,[a(h)?(n(),o("p",bt," 没有找到匹配的游戏 ")):(n(),o("p",kt," 暂无游戏数据 "))])),a(S)>1?(n(),o("div",$t,[e("button",{disabled:a(m)===1,onClick:s[1]||(s[1]=g=>m.value=1),class:"page-btn"}," 首页 ",8,Gt),e("button",{disabled:a(m)===1,onClick:s[2]||(s[2]=g=>m.value--),class:"page-btn"}," 上一页 ",8,St),e("div",Ct," 第 "+c(a(m))+" / "+c(a(S))+" 页 ",1),e("button",{disabled:a(m)===a(S),onClick:s[3]||(s[3]=g=>m.value++),class:"page-btn"}," 下一页 ",8,wt),e("button",{disabled:a(m)===a(S),onClick:s[4]||(s[4]=g=>m.value=a(S)),class:"page-btn"}," 末页 ",8,xt)])):v("",!0)])]),_:1})])):v("",!0),u(O)])}}}),Dt=F(Pt,[["__scopeId","data-v-acb53e0e"]]);export{Dt as default};
