import{d as $,u as x,e as m,o as D,J as M,k as o,K as z,j as n,l as a,q as l,n as u,_ as E,F as v,y as k,m as B,z as p,C as N}from"#entry";import{_ as S}from"./BSH8avIx.js";const b={key:0,class:"echo-loading"},F={key:1,class:"echo-error"},V={key:2,class:"echo-empty"},j={key:3,class:"echo-list"},I=["href","title"],W={class:"echo-content"},q={class:"echo-text"},A={key:0,class:"echo-tags"},H={class:"echo-time"},J=$({__name:"EchoTrend",setup(K){const y=x(),d=m([]),f=m(!1),h=m(!1),w=async()=>{f.value=!0;try{const{echo:s}=y,e=await $fetch(`${s.apiBase}${s.apiEndpoint}?page=1&pageSize=3`);if(e?.data?.items){const i=e.data.items;d.value=i.filter(r=>!r.private).sort((r,t)=>new Date(t.created_at).getTime()-new Date(r.created_at).getTime()).slice(0,3)}}catch(s){console.error("Failed to fetch echos:",s),h.value=!0}finally{f.value=!1}},C=s=>{const e=new Date(s),r=new Date().getTime()-e.getTime(),t=Math.floor(r/1e3),c=Math.floor(t/60),_=Math.floor(c/60),g=Math.floor(_/24);return t<60?"刚刚":c<60?`${c}分钟前`:_<24?`${_}小时前`:g<7?`${g}天前`:e.toLocaleDateString("zh-CN")},T=(s,e=60)=>s?s.length>e?`${s.slice(0,e)}...`:s:"[无内容]";return D(()=>{w()}),(s,e)=>{const i=E,r=S;return o(),M(r,{card:"",title:"最新动态"},{default:z(()=>[l(f)?(o(),n("div",b,[u(i,{name:"eos-icons:loading",size:"16",class:"spin"}),e[0]||(e[0]=a("span",null,"加载中...",-1))])):l(h)?(o(),n("div",F,[u(i,{name:"mdi:alert-circle",size:"16"}),e[1]||(e[1]=a("span",null,"加载失败",-1))])):l(d).length===0?(o(),n("div",V,[u(i,{name:"mdi:inbox",size:"16"}),e[2]||(e[2]=a("span",null,"暂无动态",-1))])):(o(),n("div",j,[(o(!0),n(v,null,k(l(d),t=>(o(),n("a",{key:t.id,href:`https://memo.sotkg.com/echo/${t.id}`,target:"_blank",rel:"noopener noreferrer",class:"echo-item",title:t.content},[a("div",W,[a("div",q,p(T(t.content)),1),t.tags&&t.tags.length>0?(o(),n("div",A,[(o(!0),n(v,null,k(t.tags.slice(0,1),c=>(o(),n("span",{key:c.id,class:"echo-tag"}," #"+p(c.name),1))),128))])):B("",!0)]),a("div",H,p(C(t.created_at)),1)],8,I))),128))])),e[3]||(e[3]=a("div",{class:"echo-footer"},[a("a",{href:"/echo",class:"echo-link"},"查看更多 →")],-1))]),_:1})}}}),Z=Object.assign(N(J,[["__scopeId","data-v-128c0fee"]]),{__name:"WidgetEchoTrend"});export{Z as default};
