import{G as x,L as G,r as f,ah as w,ag as $,z,d as r,f as u,Q as a,e as c,h as s,g as m,Y as B,t as d,O as E,aT as N,_ as D}from"./C11rpuVG.js";const I=["title"],P={class:"game-header"},S={class:"game-content"},T={class:"game-name"},V={class:"game-meta"},j={class:"meta-item"},F={class:"value"},L={key:0,class:"meta-item"},M={class:"value"},O={key:1,class:"meta-item"},W={class:"value"},Q={key:0,class:"achievements-section"},U={class:"achievements-header"},Y={class:"value"},Z={key:1,class:"game-card game-card-error"},q={key:2,class:"game-card game-card-loading"},A=x({__name:"GameCard",props:{game:{default:void 0},appid:{default:void 0}},setup(b){const v=b,y=`${G.steam?.apiBase}/steam-game`,g=new Map,p=f(!1),n=f(!1),h=f(null);let l=null;w(()=>v.appid,async o=>{if(o&&!v.game){if(g.has(o)){h.value=g.get(o)??null,p.value=!1,n.value=!1;return}p.value=!0,n.value=!1,l&&l.abort(),l=new AbortController;try{const e=await fetch(`${y}?appid=${o}`,{signal:l.signal});if(e.ok){const i=await e.json();i.success&&i.data?.game?(h.value=i.data.game,g.set(o,i.data.game)):n.value=!0}else n.value=!0}catch(e){e instanceof Error&&e.name!=="AbortError"&&(console.error("[GameCard] Fetch error:",e),n.value=!0)}finally{p.value=!1}}},{immediate:!0}),$(()=>{l&&l.abort()});const t=z(()=>v.game||h.value);function k(o){window.open(`https://store.steampowered.com/app/${o}`,"_blank")}return(o,e)=>{const i=B,_=E,C=N;return!a(p)&&a(t)?(c(),r("div",{key:0,class:"game-card",title:`点击查看 ${a(t).name} 的 Steam 页面`,onClick:e[0]||(e[0]=H=>k(a(t).appid))},[s("div",P,[m(i,{src:a(t).images.headerImage,alt:a(t).name,class:"header-image",loading:"lazy"},null,8,["src","alt"]),e[1]||(e[1]=s("div",{class:"game-overlay"},null,-1))]),s("div",S,[s("h3",T,d(a(t).name),1),s("div",V,[s("div",j,[m(_,{name:"ph:hourglass-bold",size:"16",class:"meta-icon"}),e[2]||(e[2]=s("span",{class:"label"},"总时长:",-1)),s("span",F,d(a(t).playtimeForever)+"h",1)]),a(t).playtimeTwoWeeks!==void 0?(c(),r("div",L,[m(_,{name:"ph:calendar-bold",size:"16",class:"meta-icon"}),e[3]||(e[3]=s("span",{class:"label"},"两周内时长:",-1)),s("span",M,d(a(t).playtimeTwoWeeks)+"h",1)])):u("",!0),a(t).price?(c(),r("div",O,[m(_,{name:"ph:tag-bold",size:"16",class:"meta-icon"}),e[4]||(e[4]=s("span",{class:"label"},"价格:",-1)),s("span",W,d(a(t).price.displayPrice),1)])):u("",!0)]),a(t).achievements?(c(),r("div",Q,[s("div",U,[m(_,{name:"ph:medal-bold",size:"16",class:"achievement-icon"}),e[5]||(e[5]=s("span",{class:"label"},"成就:",-1)),s("span",Y,d(a(t).achievements.unlocked)+"/"+d(a(t).achievements.total),1)]),m(C,{percent:a(t).achievements.percentage,"show-time":!1,height:"3px","bar-color":a(t).achievements.percentage===100?"#4ade80":void 0},null,8,["percent","bar-color"])])):u("",!0)])],8,I)):a(n)?(c(),r("div",Z,[...e[6]||(e[6]=[s("div",{class:"error-content"},[s("p",null,"游戏加载失败"),s("small",null,"请检查游戏 ID 是否正确")],-1)])])):a(p)?(c(),r("div",q,[...e[7]||(e[7]=[s("div",{class:"loading-skeleton"},null,-1)])])):u("",!0)}}}),K=Object.assign(D(A,[["__scopeId","data-v-5bb3dbda"]]),{__name:"GameCard"});export{K as default};
