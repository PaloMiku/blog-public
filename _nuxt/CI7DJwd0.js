import{r as C,b4 as y,af as S,b5 as E,b6 as w,ah as g,z as B,av as z,aw as F,ax as I,Q as T,e as m,w as f,g as h,L as u,h as _,d as b,F as V,P as A,n as D,f as N,t as P,ao as W,J as H,_ as R}from"./KynZkEWD.js";import $ from"./CVBzoXo7.js";const q=({delay:t},o)=>{let e,s=!0;const n=(...a)=>{s?(clearTimeout(e),e=setTimeout(()=>{s&&o(...a),e=void 0},t)):o(...a)};return n.isPending=()=>e!==void 0,n.cancel=()=>{s=!1},n.flush=(...a)=>o(...a),n},O=({interval:t},o)=>{let e=!0,s;const n=(...a)=>{e&&(o(...a),e=!1,s=setTimeout(()=>{e=!0,s=void 0},t))};return n.isThrottled=()=>s!==void 0,n},j=t=>O({interval:20},t),J=t=>q({delay:20},t);function L(t){const o=j(t),e=J(t);return()=>{o(),e()}}function M(t){const o=C(null),e=(d,l=[])=>(d.forEach(c=>{const r=document.getElementById(c.id);r&&l.push({id:c.id,offsetTop:r.offsetTop}),c.children&&e(c.children,l)}),l),s=y(()=>g(t),()=>e(g(t)).reverse()),n=()=>{const d=Number.parseFloat(getComputedStyle(document.documentElement).getPropertyValue("scroll-margin-top")),l=window.scrollY+(d||64),c=s.value.find(v=>v.offsetTop<=l);o.value=c?.id||null;const r=document.querySelector("#z-aside"),p=document.querySelector(`#z-aside a[href="#${o.value}"]`);r?.scroll({top:p?.offsetTop||0})};S("scroll",L(()=>n()),{passive:!0});const{height:a}=E(document?.body);return w(a,s.trigger),{activeTocItem:o}}const Q={href:"#main-content","aria-label":"返回开头"},U={href:"#artalk","aria-label":"评论区"},Y=["href","title"],G={key:1,class:"no-toc"},K=B({__name:"Toc",setup(t){const[o,e]=z(),s=F(),{toc:n}=I(s),{activeTocItem:a}=M(()=>n.value?.links??[]);function d(l,c){return l.id===c?!0:l.children?.some(r=>d(r,c))??!1}return(l,c)=>{const r=H,p=W,v=$;return m(),T(v,null,{title:f(()=>[c[0]||(c[0]=_("span",{class:"title"},"文章目录",-1)),_("a",Q,[h(r,{name:"ph:arrow-circle-up-bold"})]),_("a",U,[h(r,{name:"ph:chat-circle-text-bold"})])]),default:f(()=>[h(u(o),null,{default:f(({tocItem:k})=>[_("ol",null,[(m(!0),b(V,null,A(k,(i,x)=>(m(),b("li",{key:x,class:D({"has-active":d(i,u(a)),active:i.id===u(a)})},[_("a",{href:`#${i?.id}`,title:i.text},P(i.text),9,Y),i.children?(m(),T(u(e),{key:0,"toc-item":i.children},null,8,["toc-item"])):N("",!0)],2))),128))])]),_:1}),h(p,null,{default:f(()=>[u(n)?.links.length?(m(),T(u(e),{key:0,"toc-item":u(n).links},null,8,["toc-item"])):(m(),b("p",G," 暂无目录信息 "))]),_:1})]),_:1})}}}),ee=Object.assign(R(K,[["__scopeId","data-v-9432b98c"]]),{__name:"WidgetToc"});export{ee as default};
