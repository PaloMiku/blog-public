import{G,d as o,e as s,h as t,f as z,t as p,U as A,S as D,_ as x,g as v,O,Q as c,r as _,z as S,W as P,w as T,F as C,V as I,y as W,H as V,J as B,o as N}from"./fsc30HAO.js";import{s as j,a as E,f as R,u as H}from"./C7CCsEjg.js";import U from"./tDjrFTcC.js";import J from"./qEcN8kak.js";import{_ as Q}from"./Dnr9kA4u.js";import{s as q}from"./DNqp3_hf.js";const K={key:0,class:"steam-profile"},X={class:"profile-header"},Y=["src","alt"],Z={class:"profile-info"},tt={class:"username-row"},et={class:"username"},st={class:"status-badge-group"},at={key:0,class:"status-playing"},ot={key:1,class:"status-playing"},nt=["href"],lt={key:1,class:"steam-profile-empty"},it=G({__name:"SteamProfile",props:{user:{},metadata:{default:null}},setup(n){function m(l){return j[l]||"#90a0a6"}function i(l){return E[l]||l}return(l,u)=>n.user?(s(),o("div",K,[t("div",X,[t("img",{src:n.user.avatar.large,alt:n.user.username,class:"avatar",loading:"lazy"},null,8,Y),t("div",Z,[t("div",tt,[t("h2",et,p(n.user.username),1),t("div",st,[t("div",{class:"status-badge",style:A({"--status-color":m(n.user.status)})},[u[0]||(u[0]=t("span",{class:"status-dot"},null,-1)),D(" "+p(i(n.user.status)),1)],4)])]),n.user.currentGame?(s(),o("p",at," 正在玩 "+p(n.user.currentGame.name),1)):n.user.status==="offline"?(s(),o("p",ot," 用户当前离线 ")):z("",!0),t("a",{href:n.user.profileUrl,target:"_blank",class:"profile-link"}," 访问 Steam 个人资料 → ",8,nt)])])])):(s(),o("div",lt,[...u[1]||(u[1]=[t("p",null,"无法加载 Steam 数据",-1)])]))}}),rt=Object.assign(x(it,[["__scopeId","data-v-bfb64c8a"]]),{__name:"SteamProfile"}),ct={class:"stats-overview"},mt={class:"stat-item"},ut={class:"stat-info"},dt={class:"stat-value"},_t={class:"stat-item"},vt={class:"stat-info"},pt={class:"stat-value"},gt={key:0,class:"stat-item"},ft={class:"stat-info"},yt={class:"stat-value"},ht=G({__name:"SteamStatsOverview",props:{games:{},user:{}},setup(n){return(m,i)=>{const l=O;return s(),o("div",ct,[t("div",mt,[v(l,{name:"ph:game-controller-bold",size:"28",class:"stat-icon"}),t("div",ut,[i[0]||(i[0]=t("div",{class:"stat-label"}," 游戏总数量 ",-1)),t("div",dt,p(n.games?.totalCount??0),1)])]),t("div",_t,[v(l,{name:"ph:hourglass-bold",size:"28",class:"stat-icon"}),t("div",vt,[i[1]||(i[1]=t("div",{class:"stat-label"}," 总游玩时长 ",-1)),t("div",pt,p(n.user?.playtimeStats?.totalForever??0)+" 小时 ",1)])]),n.user?.playtimeStats?.totalTwoWeeks?(s(),o("div",gt,[v(l,{name:"ph:calendar-bold",size:"28",class:"stat-icon"}),t("div",ft,[i[2]||(i[2]=t("div",{class:"stat-label"}," 两周内时长 ",-1)),t("div",yt,p(c(R)(n.user.playtimeStats.totalTwoWeeks)),1)])])):z("",!0)])}}}),$t=Object.assign(x(ht,[["__scopeId","data-v-816e78e4"]]),{__name:"SteamStatsOverview"}),St={class:"tab-content"},bt={key:0},kt={class:"games-list"},wt={key:0,class:"load-more-container"},Gt={key:1,class:"all-loaded-tip"},xt={key:1,class:"empty-state"},Mt={class:"tab-content"},Pt={key:0},Tt={class:"games-list"},Ct={key:0,class:"load-more-container"},It={key:1,class:"all-loaded-tip"},Lt={key:1,class:"empty-state"},w=5,zt=G({__name:"SteamGamesTabs",props:{games:{},gameLimit:{}},setup(n){const m=n,i=_(w),l=_(w),u=S(()=>{const a=m.games?.allGames;return a?a.map(e=>({...e,playtimeForever:typeof e.playtimeForever=="number"?Math.round(e.playtimeForever):0,playtimeTwoWeeks:e.playtimeTwoWeeks?Math.round(e.playtimeTwoWeeks):0})):[]}),g=S(()=>u.value),f=S(()=>(m.games?.recentGames||[]).slice(0,i.value)),b=S(()=>g.value.slice(0,l.value)),k=S(()=>{const a=m.games?.recentGames?.length||0;return i.value<a}),r=S(()=>l.value<g.value.length);function M(){i.value+=w}function h(){l.value+=w}return(a,e)=>{const $=U,d=J;return s(),P(d,{tabs:["最近游戏","游戏库"],center:""},{tab1:T(()=>[t("div",St,[f.value&&f.value.length>0?(s(),o("div",bt,[t("div",kt,[(s(!0),o(C,null,I(f.value,y=>(s(),P($,{key:y.appid,game:y,class:"games-list-item"},null,8,["game"]))),128))]),k.value?(s(),o("div",wt,[t("button",{class:"load-more-btn",onClick:M}," 继续装填 ")])):(s(),o("div",Gt,[...e[0]||(e[0]=[t("p",null,"最近游戏已全部加载",-1)])]))])):(s(),o("div",xt,[...e[1]||(e[1]=[t("p",null,"暂无最近游戏数据",-1)])]))])]),tab2:T(()=>[t("div",Mt,[g.value.length>0?(s(),o("div",Pt,[t("div",Tt,[(s(!0),o(C,null,I(b.value,y=>(s(),P($,{key:y.appid,game:y,class:"games-list-item"},null,8,["game"]))),128))]),r.value?(s(),o("div",Ct,[t("button",{class:"load-more-btn",onClick:h}," 继续装填 ")])):(s(),o("div",It,[t("p",null,[e[2]||(e[2]=D("最多显示按总时长排序的前 ",-1)),t("strong",null,p(m.gameLimit??20)+" 个游戏",1)])]))])):(s(),o("div",Lt,[...e[3]||(e[3]=[t("p",null,"暂无游戏数据",-1)])]))])]),_:1})}}}),At=Object.assign(x(zt,[["__scopeId","data-v-d4b3318c"]]),{__name:"SteamGamesTabs"}),Dt={class:"steam-page"},Ot={key:0,class:"loading-state"},Ft={class:"loading-container"},Wt={class:"progress-bar-container"},Vt={class:"progress-bar"},Bt={class:"progress-info"},Nt={class:"progress-text"},jt={key:1,class:"error-state"},Et={key:2,class:"steam-content"},L=20,Rt=G({__name:"steam",setup(n){const m=W(),i=V();B({title:"Steam",meta:[{name:"description",content:`${m.author.name} 的 Steam 个人资料，查看完整的游戏库、游戏时长、成就等信息。`},{property:"og:type",content:"profile"},{name:"keywords",content:"Steam,游戏库,游戏时长,成就"}]}),i.setAside(["blog-tech","comm-group"]);const{fetchSteamData:l}=H(),u=_(!0),g=_(!1),f=_(null),b=_(null),k=_(null),r=_(0);async function M(){try{r.value=5,await new Promise(e=>setTimeout(e,300)),r.value=15;const h=q(()=>{if(r.value<85){const e=Math.random()*8+2;r.value=Math.round(Math.min(r.value+e,85))}},400),a=await l(L);if(clearInterval(h),r.value=90,a.success&&a.data){const e=a.data,$=a.allMetadata;await Promise.all([(async()=>{f.value=e.user??null,await new Promise(d=>setTimeout(d,100))})(),(async()=>{b.value=e.games??null,await new Promise(d=>setTimeout(d,100))})(),(async()=>{k.value=$??null,await new Promise(d=>setTimeout(d,80))})()]),r.value=100}else console.warn("Steam API returned unsuccessful response or missing data"),g.value=!0}catch(h){console.error("Failed to fetch Steam data:",h),g.value=!0}finally{u.value=!1}}return N(M),(h,a)=>{const e=O,$=rt,d=$t,y=At,F=Q;return s(),o("div",Dt,[c(u)?(s(),o("div",Ot,[t("div",Ft,[a[1]||(a[1]=t("p",{class:"loading-text"}," 加载 Steam 数据中... ",-1)),t("div",Wt,[t("div",Vt,[t("div",{class:"progress-fill",style:A({width:`${c(r)}%`})},null,4)]),t("div",Bt,[a[0]||(a[0]=t("p",{class:"loading-detail"}," 正在获取用户信息、游戏库和成就数据... ",-1)),t("p",Nt,p(Math.round(c(r)))+"% ",1)])])])])):c(g)?(s(),o("div",jt,[v(e,{name:"ph:warning-bold",size:"36"}),a[2]||(a[2]=t("p",null,"无法加载 Steam 数据",-1)),a[3]||(a[3]=t("p",{class:"error-detail"}," 请检查 API 是否可用 ",-1))])):(s(),o("div",Et,[v($,{user:c(f),metadata:c(k)},null,8,["user","metadata"]),v(d,{games:c(b),user:c(f)},null,8,["games","user"]),v(y,{games:c(b),"game-limit":L},null,8,["games"])])),v(F)])}}}),Xt=x(Rt,[["__scopeId","data-v-0637c7f5"]]);export{Xt as default};
