import{d as x,u as D,e as m,o as M,J as z,k as o,K as E,j as n,l as a,q as l,n as u,_ as b,F as v,y as k,m as y,z as h,C as B}from"#entry";import{_ as N}from"./BSH8avIx.js";const S={key:0,class:"echo-loading"},F={key:1,class:"echo-error"},V={key:2,class:"echo-empty"},j={key:3,class:"echo-list"},I=["href","title"],W={class:"echo-header"},q={class:"echo-content"},A={class:"echo-text"},H={key:0,class:"echo-tags"},J={class:"echo-time"},K={key:0,class:"echo-thumbnail"},L=["src","alt"],O=x({__name:"EchoTrend",setup(Z){const w=D(),d=m([]),_=m(!1),p=m(!1),C=async()=>{_.value=!0;try{const{echo:s}=w,e=await $fetch(`${s.apiBase}${s.apiEndpoint}?page=1&pageSize=3`);if(e?.data?.items){const r=e.data.items;d.value=r.filter(i=>!i.private).sort((i,t)=>new Date(t.created_at).getTime()-new Date(i.created_at).getTime()).slice(0,3)}}catch(s){console.error("Failed to fetch echos:",s),p.value=!0}finally{_.value=!1}},T=s=>{const e=new Date(s),i=new Date().getTime()-e.getTime(),t=Math.floor(i/1e3),c=Math.floor(t/60),f=Math.floor(c/60),g=Math.floor(f/24);return t<60?"刚刚":c<60?`${c}分钟前`:f<24?`${f}小时前`:g<7?`${g}天前`:e.toLocaleDateString("zh-CN")},$=(s,e=60)=>s?s.length>e?`${s.slice(0,e)}...`:s:"[无内容]";return M(()=>{C()}),(s,e)=>{const r=b,i=N;return o(),z(i,{card:"",title:"最新动态"},{default:E(()=>[l(_)?(o(),n("div",S,[u(r,{name:"eos-icons:loading",size:"16",class:"spin"}),e[0]||(e[0]=a("span",null,"加载中...",-1))])):l(p)?(o(),n("div",F,[u(r,{name:"mdi:alert-circle",size:"16"}),e[1]||(e[1]=a("span",null,"加载失败",-1))])):l(d).length===0?(o(),n("div",V,[u(r,{name:"mdi:inbox",size:"16"}),e[2]||(e[2]=a("span",null,"暂无动态",-1))])):(o(),n("div",j,[(o(!0),n(v,null,k(l(d),t=>(o(),n("a",{key:t.id,href:`https://memo.sotkg.com/echo/${t.id}`,target:"_blank",rel:"noopener noreferrer",class:"echo-item",title:t.content},[a("div",W,[a("div",q,[a("div",A,h($(t.content,40)),1),t.tags&&t.tags.length>0?(o(),n("div",H,[(o(!0),n(v,null,k(t.tags.slice(0,1),c=>(o(),n("span",{key:c.id,class:"echo-tag"}," #"+h(c.name),1))),128))])):y("",!0)]),a("div",J,h(T(t.created_at)),1)]),t.images?.[0]?(o(),n("div",K,[a("img",{src:t.images[0].image_url,alt:t.content},null,8,L)])):y("",!0)],8,I))),128))])),e[3]||(e[3]=a("div",{class:"echo-footer"},[a("a",{href:"/echo",class:"echo-link"},"查看更多 →")],-1))]),_:1})}}}),Q=Object.assign(B(O,[["__scopeId","data-v-aa9393ab"]]),{__name:"WidgetEchoTrend"});export{Q as default};
