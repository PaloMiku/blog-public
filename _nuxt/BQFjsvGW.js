import{d as T,k as l,h as s,j as e,i as F,n as W,l as u,t as i,p as z,Y as E,aw as S,z as M,r as p,c as _,N as I,o as R,f as y,w as x,F as f,a0 as j,ay as L,v as C}from"#entry";import{u as O}from"./0Iju0TH6.js";import{_ as U}from"./B-Q7bu-f.js";import q from"./CoXVAd0R.js";import"./0pYs9o80.js";const Q=["title"],Y={class:"game-header"},Z={class:"game-content"},H={class:"game-name"},J={class:"game-meta"},K={class:"meta-item"},X={class:"value"},ee={key:0,class:"meta-item"},ae={class:"value"},te={key:1,class:"meta-item"},se={class:"value"},ne={key:2,class:"meta-item"},oe={class:"value"},le={key:3,class:"meta-item"},ie={class:"value"},me={key:0,class:"achievements-progress"},ce={class:"progress-bar"},re={class:"progress-text"},de={key:1,class:"game-description"},ue={class:"game-footer"},ge=["href"],ve=T({__name:"GameCard",props:{game:{}},setup(a){const m=c=>{window.open(`https://store.steampowered.com/app/${c}`,"_blank")};return(c,t)=>{const g=W;return s(),l("div",{class:"game-card",title:`点击查看 ${a.game.name} 的 Steam 页面`,onClick:t[2]||(t[2]=d=>m(a.game.appid))},[e("div",Y,[F(g,{src:a.game.images.headerImage,alt:a.game.name,class:"header-image",loading:"lazy"},null,8,["src","alt"]),t[3]||(t[3]=e("div",{class:"game-overlay"},null,-1))]),e("div",Z,[e("h3",H,i(a.game.name),1),e("div",J,[e("div",K,[t[4]||(t[4]=e("span",{class:"label"},"总时长:",-1)),e("span",X,i(a.game.playtimeForever)+" 小时",1)]),a.game.playtimeTwoWeeks!==void 0?(s(),l("div",ee,[t[5]||(t[5]=e("span",{class:"label"},"最近两周:",-1)),e("span",ae,i(a.game.playtimeTwoWeeks)+" 小时",1)])):u("",!0),a.game.achievements?(s(),l("div",te,[t[6]||(t[6]=e("span",{class:"label"},"成就:",-1)),e("span",se,i(a.game.achievements.unlocked)+"/"+i(a.game.achievements.total),1)])):u("",!0),a.game.releaseDate?(s(),l("div",ne,[t[7]||(t[7]=e("span",{class:"label"},"发布:",-1)),e("span",oe,i(a.game.releaseDate),1)])):u("",!0),a.game.price?(s(),l("div",le,[t[8]||(t[8]=e("span",{class:"label"},"价格:",-1)),e("span",ie,i(a.game.price.displayPrice),1)])):u("",!0)]),a.game.achievements?(s(),l("div",me,[e("div",ce,[e("div",{class:E(["progress-fill",{"progress-complete":a.game.achievements.percentage===100}]),style:z({width:`${a.game.achievements.percentage}%`})},null,6)]),e("span",re,"成就进度: "+i(a.game.achievements.percentage)+"%",1)])):u("",!0),a.game.shortDescription?(s(),l("p",de,i(a.game.shortDescription),1)):u("",!0),e("div",ue,[e("a",{class:"steam-link",href:`https://store.steampowered.com/app/${a.game.appid}`,target:"_blank",rel:"noopener noreferrer",onClick:t[0]||(t[0]=S(()=>{},["stop"])),onMousedown:t[1]||(t[1]=S(()=>{},["stop"]))}," 在 Steam 中查看 → ",40,ge)])])],8,Q)}}}),pe=Object.assign(M(ve,[["__scopeId","data-v-f40df456"]]),{__name:"GameCard"}),he={class:"tab-content"},_e={key:0},ye={key:1,class:"games-grid"},fe={key:2,class:"empty-state"},ke={class:"tab-content"},we={key:0},be={class:"games-toolbar"},$e={class:"game-count"},Ge={key:0,class:"games-grid"},Se={key:1,class:"empty-state"},xe={key:0},Ce={key:1},Te={key:2,class:"pagination-control"},k=12,Fe=T({__name:"SteamGamesTabs",props:{games:{},initialSearch:{},loading:{type:Boolean}},setup(a){const m=a,c=p(m.initialSearch||""),t=p(1),g=p(m.games?.recentGames??[]),d=p(m.games?.allGames??null),w=p(!1),b=_(()=>{if(d.value)return d.value;const n=m.games?.allGames;return n?n.map(o=>({...o,playtimeForever:Math.round(o.playtimeForever/60),playtimeTwoWeeks:o.playtimeTwoWeeks?Math.round(o.playtimeTwoWeeks/60):0})):[]}),h=_(()=>{if(!b.value)return[];let n=[...b.value];if(c.value.trim()){const o=c.value.toLowerCase();n=n.filter(v=>v.name.toLowerCase().includes(o))}return n.sort((o,v)=>v.playtimeForever-o.playtimeForever)}),$=_(()=>Math.ceil(h.value.length/k)),P=_(()=>{const n=(t.value-1)*k;return h.value.slice(n,n+k)});I(c,()=>{t.value=1,w.value||(w.value=!0,G())});const{getRecentGames:V,getAllGamesSorted:D}=O(),A=async()=>{try{const n=await V();n&&(g.value=n)}catch(n){console.error("Failed to fetch recent games",n)}},G=async()=>{if(!d.value)try{const n=await D();d.value=n}catch(n){console.error("Failed to fetch all games",n)}};return R(()=>{A(),setTimeout(()=>{d.value||G()},2e3)}),(n,o)=>{const v=pe,B=U,N=q;return s(),y(N,{tabs:["最近游戏","游戏库"],center:""},{tab1:x(()=>[e("div",he,[m.loading?(s(),l("div",_e,[...o[2]||(o[2]=[e("div",{class:"loading-state"},[e("div",{class:"spinner"}),e("p",null,"正在加载最近游戏...")],-1)])])):g.value&&g.value.length>0?(s(),l("div",ye,[(s(!0),l(f,null,C(g.value,r=>(s(),y(v,{key:r.appid,game:r},null,8,["game"]))),128))])):(s(),l("div",fe,[...o[3]||(o[3]=[e("p",null,"暂无最近游戏数据",-1)])]))])]),tab2:x(()=>[e("div",ke,[m.loading?(s(),l("div",we,[...o[4]||(o[4]=[e("div",{class:"loading-state"},[e("div",{class:"spinner"}),e("p",null,"正在加载游戏库...")],-1)])])):(s(),l(f,{key:1},[e("div",be,[j(e("input",{"onUpdate:modelValue":o[0]||(o[0]=r=>c.value=r),type:"text",placeholder:"搜索游戏...",class:"search-input"},null,512),[[L,c.value]]),e("div",$e,i(h.value.length)+" / "+i(m.games?.totalCount??d.value?.length??0),1)]),h.value.length>0?(s(),l("div",Ge,[(s(!0),l(f,null,C(P.value,r=>(s(),y(v,{key:r.appid,game:r},null,8,["game"]))),128))])):(s(),l("div",Se,[c.value?(s(),l("p",xe,"没有找到匹配的游戏")):(s(),l("p",Ce,"暂无游戏数据"))])),$.value>1?(s(),l("div",Te,[F(B,{modelValue:t.value,"onUpdate:modelValue":o[1]||(o[1]=r=>t.value=r),class:"pagination","total-pages":$.value},null,8,["modelValue","total-pages"])])):u("",!0)],64))])]),_:1})}}}),Be=Object.assign(M(Fe,[["__scopeId","data-v-e6b94823"]]),{__name:"SteamGamesTabs"});export{Be as default};
