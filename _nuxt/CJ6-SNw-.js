import{z as C,E as w,r as h,ad as G,ac as x,G as z,d as i,f as p,L as e,e as c,h as s,t as l,g as _,J as B,n as f,aV as E,_ as $}from"./DtPR8I_S.js";const F=["title"],N={class:"game-header"},V=["src","alt"],P={class:"game-content"},S={class:"content-top"},j={class:"game-name"},D={class:"game-stats"},L={class:"stat-row"},M={class:"stat-group time-group"},T={class:"time-text"},W={class:"stat-value"},I={key:0,class:"recent-badge"},J={key:0,class:"divider"},O={class:"price-value"},U={class:"achievements-info"},q={class:"achievements-label"},A={class:"achievements-count"},H={class:"achievements-percentage"},K={key:1,class:"game-card game-card-error"},Q={class:"error-content"},R={key:2,class:"game-card game-card-loading"},X=C({__name:"GameCard",props:{game:{default:void 0},appid:{default:void 0}},setup(y){const u=y,b=`${w.steam?.apiBase}/steam-game`,v=new Map,m=h(!1),r=h(!1),g=h(null);let d=null;G(()=>u.appid,async o=>{if(o&&!u.game){if(v.has(o)){g.value=v.get(o)??null,m.value=!1,r.value=!1;return}m.value=!0,r.value=!1,d&&d.abort(),d=new AbortController;try{const t=await fetch(`${b}?appid=${o}`,{signal:d.signal});if(t.ok){const n=await t.json();n.success&&n.data?.game?(g.value=n.data.game,v.set(o,n.data.game)):r.value=!0}else r.value=!0}catch(t){t instanceof Error&&t.name!=="AbortError"&&(console.error("[GameCard] Fetch error:",t),r.value=!0)}finally{m.value=!1}}},{immediate:!0}),x(()=>{d&&d.abort()});const a=z(()=>u.game||g.value);function k(o){window.open(`https://store.steampowered.com/app/${o}`,"_blank")}return(o,t)=>{const n=B;return!e(m)&&e(a)?(c(),i("div",{key:0,class:"game-card",title:`点击查看 ${e(a).name} 的 Steam 页面`,onClick:t[0]||(t[0]=Y=>k(e(a).appid))},[s("div",N,[s("img",{src:e(a).images.headerImage,alt:e(a).name,class:"header-image",loading:"lazy"},null,8,V),t[1]||(t[1]=s("div",{class:"game-overlay"},null,-1))]),s("div",P,[s("div",S,[s("h3",j,l(e(a).name),1),s("div",D,[s("div",L,[s("div",M,[_(n,{name:"ph:hourglass-bold",size:"15",class:"stat-icon"}),s("div",T,[t[2]||(t[2]=s("span",{class:"stat-label"},"总时数",-1)),s("span",W,l(e(a).playtimeForever)+"h",1)]),e(a).playtimeTwoWeeks?(c(),i("span",I," 最近 "+l(e(a).playtimeTwoWeeks)+"h ",1)):p("",!0)]),e(a).price?(c(),i("div",{key:0,class:f(["stat-group price-group",{"is-owned":e(a).playtimeForever>0}])},[e(a).playtimeForever>0?(c(),i("span",J,"|")):p("",!0),s("span",O,l(e(a).price.displayPrice),1)],2)):p("",!0)])])]),e(a).achievements?(c(),i("div",{key:0,class:f(["achievements-section",{complete:e(a).achievements.percentage===100}])},[s("div",U,[s("div",q,[_(n,{name:"ph:medal-fill",size:"14",class:"achievements-icon"}),s("span",A,l(e(a).achievements.unlocked)+" / "+l(e(a).achievements.total),1)]),s("span",H,l(e(a).achievements.percentage)+"%",1)]),_(E,{percent:e(a).achievements.percentage,"show-time":!1,height:"6px","bar-color":e(a).achievements.percentage===100?"#10b981":""},null,8,["percent","bar-color"])],2)):p("",!0)])],8,F)):e(r)?(c(),i("div",K,[s("div",Q,[_(n,{name:"ph:warning-circle",size:"24",class:"error-icon"}),t[3]||(t[3]=s("p",null,"无法加载游戏信息",-1))])])):e(m)?(c(),i("div",R,[...t[4]||(t[4]=[s("div",{class:"loading-skeleton"},null,-1)])])):p("",!0)}}}),ee=Object.assign($(X,[["__scopeId","data-v-4db90beb"]]),{__name:"GameCard"});export{ee as default};
