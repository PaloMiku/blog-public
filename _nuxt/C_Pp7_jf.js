import{_ as A,c as F,d as W}from"./BnYSvJ4w.js";import{J as x,Q as o,aO as s,b6 as t,aS as p,ba as V,aR as D,b9 as g,a$ as O,b8 as z,b5 as G,K as c,r as v,x as $,aN as P,aU as T,aV as I,aW as C,ah as B,N as R}from"./uFNG57UN.js";import{s as j,a as E,f as U,u as H}from"./BniCGKxB.js";import J from"./QVARHdVb.js";import K from"./lM-UvMKO.js";import{_ as Q}from"./sm4O23KO.js";import{s as q}from"./B8zEiI0H.js";import"./D-deoX8n.js";const X={key:0,class:"steam-profile"},Y={class:"profile-header"},Z={class:"profile-info"},tt={class:"username-row"},et={class:"username"},st={class:"status-badge-group"},at={key:0,class:"status-playing"},ot={key:1,class:"status-playing"},nt=["href"],lt={key:1,class:"steam-profile-empty"},rt=x({__name:"SteamProfile",props:{user:{},metadata:{default:null}},setup(n){function m(l){return j[l]||"#90a0a6"}function r(l){return E[l]||l}return(l,u)=>{const d=V;return n.user?(s(),o("div",X,[t("div",Y,[p(d,{src:n.user.avatar.large,alt:n.user.username,class:"avatar",loading:"lazy"},null,8,["src","alt"]),t("div",Z,[t("div",tt,[t("h2",et,g(n.user.username),1),t("div",st,[t("div",{class:"status-badge",style:O({"--status-color":m(n.user.status)})},[u[0]||(u[0]=t("span",{class:"status-dot"},null,-1)),z(" "+g(r(n.user.status)),1)],4)])]),n.user.currentGame?(s(),o("p",at," 正在玩 "+g(n.user.currentGame.name),1)):n.user.status==="offline"?(s(),o("p",ot," 用户当前离线 ")):D("",!0),t("a",{href:n.user.profileUrl,target:"_blank",class:"profile-link"}," 访问 Steam 个人资料 → ",8,nt)])])])):(s(),o("div",lt,[...u[1]||(u[1]=[t("p",null,"无法加载 Steam 数据",-1)])]))}}}),it=Object.assign(G(rt,[["__scopeId","data-v-6c2e27df"]]),{__name:"SteamProfile"}),ct={class:"stats-overview"},mt={class:"stat-card"},ut={class:"stat-info"},dt={class:"stat-value"},_t={class:"stat-card"},pt={class:"stat-info"},vt={class:"stat-value"},gt={key:0,class:"stat-card"},ft={class:"stat-info"},yt={class:"stat-value"},ht=x({__name:"SteamStatsOverview",props:{games:{},user:{}},setup(n){return(m,r)=>{const l=A;return s(),o("div",ct,[t("div",mt,[p(l,{name:"ph:game-controller-bold",size:"28",class:"stat-icon"}),t("div",ut,[r[0]||(r[0]=t("div",{class:"stat-label"}," 游戏总数量 ",-1)),t("div",dt,g(n.games?.totalCount??0),1)])]),t("div",_t,[p(l,{name:"ph:hourglass-bold",size:"28",class:"stat-icon"}),t("div",pt,[r[1]||(r[1]=t("div",{class:"stat-label"}," 总游玩时长 ",-1)),t("div",vt,g(n.user?.playtimeStats?.totalForever??0)+" 小时 ",1)])]),n.user?.playtimeStats?.totalTwoWeeks?(s(),o("div",gt,[p(l,{name:"ph:calendar-bold",size:"28",class:"stat-icon"}),t("div",ft,[r[2]||(r[2]=t("div",{class:"stat-label"}," 两周内时长 ",-1)),t("div",yt,g(c(U)(n.user.playtimeStats.totalTwoWeeks)),1)])])):D("",!0)])}}}),bt=Object.assign(G(ht,[["__scopeId","data-v-7825a812"]]),{__name:"SteamStatsOverview"}),$t={class:"tab-content"},St={key:0},kt={class:"games-list"},wt={key:0,class:"load-more-container"},xt={key:1,class:"all-loaded-tip"},Gt={key:1,class:"empty-state"},Mt={class:"tab-content"},Pt={key:0},Tt={class:"games-list"},It={key:0,class:"load-more-container"},Ct={key:1,class:"all-loaded-tip"},Lt={key:1,class:"empty-state"},w=5,At=x({__name:"SteamGamesTabs",props:{games:{},gameLimit:{}},setup(n){const m=n,r=v(w),l=v(w),u=$(()=>{const a=m.games?.allGames;return a?a.map(e=>({...e,playtimeForever:typeof e.playtimeForever=="number"?Math.round(e.playtimeForever):0,playtimeTwoWeeks:e.playtimeTwoWeeks?Math.round(e.playtimeTwoWeeks):0})):[]}),d=$(()=>u.value),f=$(()=>(m.games?.recentGames||[]).slice(0,r.value)),S=$(()=>d.value.slice(0,l.value)),k=$(()=>{const a=m.games?.recentGames?.length||0;return r.value<a}),i=$(()=>l.value<d.value.length);function M(){r.value+=w}function h(){l.value+=w}return(a,e)=>{const b=J,_=K;return s(),P(_,{tabs:["最近游戏","游戏库"],center:""},{tab1:T(()=>[t("div",$t,[f.value&&f.value.length>0?(s(),o("div",St,[t("div",kt,[(s(!0),o(I,null,C(f.value,y=>(s(),P(b,{key:y.appid,game:y,class:"games-list-item"},null,8,["game"]))),128))]),k.value?(s(),o("div",wt,[t("button",{class:"load-more-btn",onClick:M}," 继续装填 ")])):(s(),o("div",xt,[...e[0]||(e[0]=[t("p",null,"最近游戏已全部加载",-1)])]))])):(s(),o("div",Gt,[...e[1]||(e[1]=[t("p",null,"暂无最近游戏数据",-1)])]))])]),tab2:T(()=>[t("div",Mt,[d.value.length>0?(s(),o("div",Pt,[t("div",Tt,[(s(!0),o(I,null,C(S.value,y=>(s(),P(b,{key:y.appid,game:y,class:"games-list-item"},null,8,["game"]))),128))]),i.value?(s(),o("div",It,[t("button",{class:"load-more-btn",onClick:h}," 继续装填 ")])):(s(),o("div",Ct,[t("p",null,[e[2]||(e[2]=z("最多显示按总时长排序的前 ",-1)),t("strong",null,g(m.gameLimit??20)+" 个游戏",1)])]))])):(s(),o("div",Lt,[...e[3]||(e[3]=[t("p",null,"暂无游戏数据",-1)])]))])]),_:1})}}}),Dt=Object.assign(G(At,[["__scopeId","data-v-558f2edf"]]),{__name:"SteamGamesTabs"}),Ot={class:"steam-page"},zt={key:0,class:"loading-state"},Nt={class:"loading-container"},Ft={class:"progress-bar-container"},Wt={class:"progress-bar"},Vt={class:"progress-info"},Bt={class:"progress-text"},Rt={key:1,class:"error-state"},jt={key:2,class:"steam-content"},L=20,Et=x({__name:"steam",setup(n){const m=F(),r=W();B({title:"Steam",meta:[{name:"description",content:`${m.author.name} 的 Steam 个人资料，查看完整的游戏库、游戏时长、成就等信息。`},{property:"og:type",content:"profile"},{name:"keywords",content:"Steam,游戏库,游戏时长,成就"}]}),r.setAside(["blog-tech","comm-group"]);const{fetchSteamData:l}=H(),u=v(!0),d=v(!1),f=v(null),S=v(null),k=v(null),i=v(0);async function M(){try{i.value=5,await new Promise(e=>setTimeout(e,300)),i.value=15;const h=q(()=>{if(i.value<85){const e=Math.random()*8+2;i.value=Math.round(Math.min(i.value+e,85))}},400),a=await l(L);if(clearInterval(h),i.value=90,a.success&&a.data){const e=a.data,b=a.allMetadata;await Promise.all([(async()=>{f.value=e.user??null,await new Promise(_=>setTimeout(_,100))})(),(async()=>{S.value=e.games??null,await new Promise(_=>setTimeout(_,100))})(),(async()=>{k.value=b??null,await new Promise(_=>setTimeout(_,80))})()]),i.value=100}else console.warn("Steam API returned unsuccessful response or missing data"),d.value=!0}catch(h){console.error("Failed to fetch Steam data:",h),d.value=!0}finally{u.value=!1}}return R(M),(h,a)=>{const e=A,b=it,_=bt,y=Dt,N=Q;return s(),o("div",Ot,[c(u)?(s(),o("div",zt,[t("div",Nt,[a[1]||(a[1]=t("p",{class:"loading-text"}," 加载 Steam 数据中... ",-1)),t("div",Ft,[t("div",Wt,[t("div",{class:"progress-fill",style:O({width:`${c(i)}%`})},null,4)]),t("div",Vt,[a[0]||(a[0]=t("p",{class:"loading-detail"}," 正在获取用户信息、游戏库和成就数据... ",-1)),t("p",Bt,g(Math.round(c(i)))+"% ",1)])])])])):c(d)?(s(),o("div",Rt,[p(e,{name:"ph:warning-bold",size:"36"}),a[2]||(a[2]=t("p",null,"无法加载 Steam 数据",-1)),a[3]||(a[3]=t("p",{class:"error-detail"}," 请检查 API 是否可用 ",-1))])):(s(),o("div",jt,[p(b,{user:c(f),metadata:c(k)},null,8,["user","metadata"]),p(_,{games:c(S),user:c(f)},null,8,["games","user"]),p(y,{games:c(S),"game-limit":L},null,8,["games"])])),p(N)])}}}),Zt=G(Et,[["__scopeId","data-v-589cbc98"]]);export{Zt as default};
