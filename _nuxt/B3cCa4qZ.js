import{_ as A,c as F,d as V}from"./BgorD-eb.js";import{J as x,Q as o,aN as e,b5 as t,aR as p,br as W,aQ as D,b8 as f,a_ as z,b7 as N,b4 as G,K as c,r as v,x as $,aM as P,aT as T,aU as I,aV as C,ah as B,N as R}from"./D6ajeznB.js";import{s as j,a as E,f as Q,u as U}from"./qbAQerJH.js";import H from"./C9tTQaDq.js";import J from"./-ladT5h5.js";import{_ as K}from"./Dp4-ccJA.js";import{s as q}from"./BDJpcfJx.js";import"./D-deoX8n.js";const X={key:0,class:"steam-profile"},Y={class:"profile-header"},Z={class:"profile-info"},tt={class:"username-row"},st={class:"username"},et={class:"status-badge-group"},at={key:0,class:"status-playing"},ot={key:1,class:"status-playing"},nt=["href"],lt={key:1,class:"steam-profile-empty"},rt=x({__name:"SteamProfile",props:{user:{},metadata:{default:null}},setup(n){function m(l){return j[l]||"#90a0a6"}function r(l){return E[l]||l}return(l,u)=>{const d=W;return n.user?(e(),o("div",X,[t("div",Y,[p(d,{src:n.user.avatar.large,alt:n.user.username,class:"avatar",loading:"lazy"},null,8,["src","alt"]),t("div",Z,[t("div",tt,[t("h2",st,f(n.user.username),1),t("div",et,[t("div",{class:"status-badge",style:z({"--status-color":m(n.user.status)})},[u[0]||(u[0]=t("span",{class:"status-dot"},null,-1)),N(" "+f(r(n.user.status)),1)],4)])]),n.user.currentGame?(e(),o("p",at," 正在玩 "+f(n.user.currentGame.name),1)):n.user.status==="offline"?(e(),o("p",ot," 用户当前离线 ")):D("",!0),t("a",{href:n.user.profileUrl,target:"_blank",class:"profile-link"}," 访问 Steam 个人资料 → ",8,nt)])])])):(e(),o("div",lt,[...u[1]||(u[1]=[t("p",null,"无法加载 Steam 数据",-1)])]))}}}),it=Object.assign(G(rt,[["__scopeId","data-v-6c2e27df"]]),{__name:"SteamProfile"}),ct={class:"stats-overview"},mt={class:"stat-card"},ut={class:"stat-info"},dt={class:"stat-value"},_t={class:"stat-card"},pt={class:"stat-info"},vt={class:"stat-value"},ft={key:0,class:"stat-card"},gt={class:"stat-info"},yt={class:"stat-value"},ht=x({__name:"SteamStatsOverview",props:{games:{},user:{}},setup(n){return(m,r)=>{const l=A;return e(),o("div",ct,[t("div",mt,[p(l,{name:"ph:game-controller-bold",size:"28",class:"stat-icon"}),t("div",ut,[r[0]||(r[0]=t("div",{class:"stat-label"}," 游戏总数量 ",-1)),t("div",dt,f(n.games?.totalCount??0),1)])]),t("div",_t,[p(l,{name:"ph:hourglass-bold",size:"28",class:"stat-icon"}),t("div",pt,[r[1]||(r[1]=t("div",{class:"stat-label"}," 总游玩时长 ",-1)),t("div",vt,f(n.user?.playtimeStats?.totalForever??0)+" 小时 ",1)])]),n.user?.playtimeStats?.totalTwoWeeks?(e(),o("div",ft,[p(l,{name:"ph:calendar-bold",size:"28",class:"stat-icon"}),t("div",gt,[r[2]||(r[2]=t("div",{class:"stat-label"}," 两周内时长 ",-1)),t("div",yt,f(c(Q)(n.user.playtimeStats.totalTwoWeeks)),1)])])):D("",!0)])}}}),bt=Object.assign(G(ht,[["__scopeId","data-v-7825a812"]]),{__name:"SteamStatsOverview"}),$t={class:"tab-content"},St={key:0},kt={class:"games-list"},wt={key:0,class:"load-more-container"},xt={key:1,class:"all-loaded-tip"},Gt={key:1,class:"empty-state"},Mt={class:"tab-content"},Pt={key:0},Tt={class:"games-list"},It={key:0,class:"load-more-container"},Ct={key:1,class:"all-loaded-tip"},Lt={key:1,class:"empty-state"},w=5,At=x({__name:"SteamGamesTabs",props:{games:{},gameLimit:{}},setup(n){const m=n,r=v(w),l=v(w),u=$(()=>{const a=m.games?.allGames;return a?a.map(s=>({...s,playtimeForever:typeof s.playtimeForever=="number"?Math.round(s.playtimeForever):0,playtimeTwoWeeks:s.playtimeTwoWeeks?Math.round(s.playtimeTwoWeeks):0})):[]}),d=$(()=>u.value),g=$(()=>(m.games?.recentGames||[]).slice(0,r.value)),S=$(()=>d.value.slice(0,l.value)),k=$(()=>{const a=m.games?.recentGames?.length||0;return r.value<a}),i=$(()=>l.value<d.value.length);function M(){r.value+=w}function h(){l.value+=w}return(a,s)=>{const b=H,_=J;return e(),P(_,{tabs:["最近游戏","游戏库"],center:""},{tab1:T(()=>[t("div",$t,[g.value&&g.value.length>0?(e(),o("div",St,[t("div",kt,[(e(!0),o(I,null,C(g.value,y=>(e(),P(b,{key:y.appid,game:y,class:"games-list-item"},null,8,["game"]))),128))]),k.value?(e(),o("div",wt,[t("button",{class:"load-more-btn",onClick:M}," 继续装填 ")])):(e(),o("div",xt,[...s[0]||(s[0]=[t("p",null,"最近游戏已全部加载",-1)])]))])):(e(),o("div",Gt,[...s[1]||(s[1]=[t("p",null,"暂无最近游戏数据",-1)])]))])]),tab2:T(()=>[t("div",Mt,[d.value.length>0?(e(),o("div",Pt,[t("div",Tt,[(e(!0),o(I,null,C(S.value,y=>(e(),P(b,{key:y.appid,game:y,class:"games-list-item"},null,8,["game"]))),128))]),i.value?(e(),o("div",It,[t("button",{class:"load-more-btn",onClick:h}," 继续装填 ")])):(e(),o("div",Ct,[t("p",null,[s[2]||(s[2]=N("最多显示按总时长排序的前 ",-1)),t("strong",null,f(m.gameLimit??20)+" 个游戏",1)])]))])):(e(),o("div",Lt,[...s[3]||(s[3]=[t("p",null,"暂无游戏数据",-1)])]))])]),_:1})}}}),Dt=Object.assign(G(At,[["__scopeId","data-v-558f2edf"]]),{__name:"SteamGamesTabs"}),zt={class:"steam-page"},Nt={key:0,class:"loading-state"},Ot={class:"loading-container"},Ft={class:"progress-bar-container"},Vt={class:"progress-bar"},Wt={class:"progress-info"},Bt={class:"progress-text"},Rt={key:1,class:"error-state"},jt={key:2,class:"steam-content"},L=20,Et=x({__name:"steam",setup(n){const m=F(),r=V();B({title:"Steam",meta:[{name:"description",content:`${m.author.name} 的 Steam 个人资料，查看完整的游戏库、游戏时长、成就等信息。`},{property:"og:type",content:"profile"},{name:"keywords",content:"Steam,游戏库,游戏时长,成就"}]}),r.setAside(["blog-tech","comm-group"]);const{fetchSteamData:l}=U(),u=v(!0),d=v(!1),g=v(null),S=v(null),k=v(null),i=v(0);async function M(){try{i.value=5,await new Promise(s=>setTimeout(s,300)),i.value=15;const h=q(()=>{if(i.value<85){const s=Math.random()*8+2;i.value=Math.round(Math.min(i.value+s,85))}},400),a=await l(L);if(clearInterval(h),i.value=90,a.success&&a.data){const s=a.data,b=a.allMetadata;await Promise.all([(async()=>{g.value=s.user??null,await new Promise(_=>setTimeout(_,100))})(),(async()=>{S.value=s.games??null,await new Promise(_=>setTimeout(_,100))})(),(async()=>{k.value=b??null,await new Promise(_=>setTimeout(_,80))})()]),i.value=100}else console.warn("Steam API returned unsuccessful response or missing data"),d.value=!0}catch(h){console.error("Failed to fetch Steam data:",h),d.value=!0}finally{u.value=!1}}return R(M),(h,a)=>{const s=A,b=it,_=bt,y=Dt,O=K;return e(),o("div",zt,[c(u)?(e(),o("div",Nt,[t("div",Ot,[a[1]||(a[1]=t("p",{class:"loading-text"}," 加载 Steam 数据中... ",-1)),t("div",Ft,[t("div",Vt,[t("div",{class:"progress-fill",style:z({width:`${c(i)}%`})},null,4)]),t("div",Wt,[a[0]||(a[0]=t("p",{class:"loading-detail"}," 正在获取用户信息、游戏库和成就数据... ",-1)),t("p",Bt,f(Math.round(c(i)))+"% ",1)])])])])):c(d)?(e(),o("div",Rt,[p(s,{name:"ph:warning-bold",size:"36"}),a[2]||(a[2]=t("p",null,"无法加载 Steam 数据",-1)),a[3]||(a[3]=t("p",{class:"error-detail"}," 请检查 API 是否可用 ",-1))])):(e(),o("div",jt,[p(b,{user:c(g),metadata:c(k)},null,8,["user","metadata"]),p(_,{games:c(S),user:c(g)},null,8,["games","user"]),p(y,{games:c(S),"game-limit":L},null,8,["games"])])),p(O)])}}}),Zt=G(Et,[["__scopeId","data-v-589cbc98"]]);export{Zt as default};
