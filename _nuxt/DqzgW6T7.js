import{G as x,d as o,e as s,h as t,g as v,Y as W,f as z,t as f,U as A,S as D,_ as G,O,Q as c,r as p,z as S,W as P,w as T,F as I,V as C,y as N,H as V,J as B,o as j}from"./DvZ9QNCs.js";import{s as E,a as R,f as H,u as U}from"./DoxhBb-P.js";import J from"./Vt3MBVxI.js";import Q from"./C0NZ4WQS.js";import{_ as Y}from"./4WeW0vwD.js";import{s as q}from"./DZG4dDq9.js";const K={key:0,class:"steam-profile"},X={class:"profile-header"},Z={class:"profile-info"},tt={class:"username-row"},et={class:"username"},st={class:"status-badge-group"},at={key:0,class:"status-playing"},ot={key:1,class:"status-playing"},nt=["href"],lt={key:1,class:"steam-profile-empty"},it=x({__name:"SteamProfile",props:{user:{},metadata:{default:null}},setup(n){function m(l){return E[l]||"#90a0a6"}function i(l){return R[l]||l}return(l,u)=>{const d=W;return n.user?(s(),o("div",K,[t("div",X,[v(d,{src:n.user.avatar.large,alt:n.user.username,class:"avatar",loading:"lazy"},null,8,["src","alt"]),t("div",Z,[t("div",tt,[t("h2",et,f(n.user.username),1),t("div",st,[t("div",{class:"status-badge",style:A({"--status-color":m(n.user.status)})},[u[0]||(u[0]=t("span",{class:"status-dot"},null,-1)),D(" "+f(i(n.user.status)),1)],4)])]),n.user.currentGame?(s(),o("p",at," 正在玩 "+f(n.user.currentGame.name),1)):n.user.status==="offline"?(s(),o("p",ot," 用户当前离线 ")):z("",!0),t("a",{href:n.user.profileUrl,target:"_blank",class:"profile-link"}," 访问 Steam 个人资料 → ",8,nt)])])])):(s(),o("div",lt,[...u[1]||(u[1]=[t("p",null,"无法加载 Steam 数据",-1)])]))}}}),rt=Object.assign(G(it,[["__scopeId","data-v-6c2e27df"]]),{__name:"SteamProfile"}),ct={class:"stats-overview"},mt={class:"stat-item"},ut={class:"stat-info"},dt={class:"stat-value"},_t={class:"stat-item"},vt={class:"stat-info"},pt={class:"stat-value"},ft={key:0,class:"stat-item"},gt={class:"stat-info"},yt={class:"stat-value"},ht=x({__name:"SteamStatsOverview",props:{games:{},user:{}},setup(n){return(m,i)=>{const l=O;return s(),o("div",ct,[t("div",mt,[v(l,{name:"ph:game-controller-bold",size:"28",class:"stat-icon"}),t("div",ut,[i[0]||(i[0]=t("div",{class:"stat-label"}," 游戏总数量 ",-1)),t("div",dt,f(n.games?.totalCount??0),1)])]),t("div",_t,[v(l,{name:"ph:hourglass-bold",size:"28",class:"stat-icon"}),t("div",vt,[i[1]||(i[1]=t("div",{class:"stat-label"}," 总游玩时长 ",-1)),t("div",pt,f(n.user?.playtimeStats?.totalForever??0)+" 小时 ",1)])]),n.user?.playtimeStats?.totalTwoWeeks?(s(),o("div",ft,[v(l,{name:"ph:calendar-bold",size:"28",class:"stat-icon"}),t("div",gt,[i[2]||(i[2]=t("div",{class:"stat-label"}," 两周内时长 ",-1)),t("div",yt,f(c(H)(n.user.playtimeStats.totalTwoWeeks)),1)])])):z("",!0)])}}}),$t=Object.assign(G(ht,[["__scopeId","data-v-816e78e4"]]),{__name:"SteamStatsOverview"}),St={class:"tab-content"},bt={key:0},kt={class:"games-list"},wt={key:0,class:"load-more-container"},xt={key:1,class:"all-loaded-tip"},Gt={key:1,class:"empty-state"},Mt={class:"tab-content"},Pt={key:0},Tt={class:"games-list"},It={key:0,class:"load-more-container"},Ct={key:1,class:"all-loaded-tip"},Lt={key:1,class:"empty-state"},w=5,zt=x({__name:"SteamGamesTabs",props:{games:{},gameLimit:{}},setup(n){const m=n,i=p(w),l=p(w),u=S(()=>{const a=m.games?.allGames;return a?a.map(e=>({...e,playtimeForever:typeof e.playtimeForever=="number"?Math.round(e.playtimeForever):0,playtimeTwoWeeks:e.playtimeTwoWeeks?Math.round(e.playtimeTwoWeeks):0})):[]}),d=S(()=>u.value),g=S(()=>(m.games?.recentGames||[]).slice(0,i.value)),b=S(()=>d.value.slice(0,l.value)),k=S(()=>{const a=m.games?.recentGames?.length||0;return i.value<a}),r=S(()=>l.value<d.value.length);function M(){i.value+=w}function h(){l.value+=w}return(a,e)=>{const $=J,_=Q;return s(),P(_,{tabs:["最近游戏","游戏库"],center:""},{tab1:T(()=>[t("div",St,[g.value&&g.value.length>0?(s(),o("div",bt,[t("div",kt,[(s(!0),o(I,null,C(g.value,y=>(s(),P($,{key:y.appid,game:y,class:"games-list-item"},null,8,["game"]))),128))]),k.value?(s(),o("div",wt,[t("button",{class:"load-more-btn",onClick:M}," 继续装填 ")])):(s(),o("div",xt,[...e[0]||(e[0]=[t("p",null,"最近游戏已全部加载",-1)])]))])):(s(),o("div",Gt,[...e[1]||(e[1]=[t("p",null,"暂无最近游戏数据",-1)])]))])]),tab2:T(()=>[t("div",Mt,[d.value.length>0?(s(),o("div",Pt,[t("div",Tt,[(s(!0),o(I,null,C(b.value,y=>(s(),P($,{key:y.appid,game:y,class:"games-list-item"},null,8,["game"]))),128))]),r.value?(s(),o("div",It,[t("button",{class:"load-more-btn",onClick:h}," 继续装填 ")])):(s(),o("div",Ct,[t("p",null,[e[2]||(e[2]=D("最多显示按总时长排序的前 ",-1)),t("strong",null,f(m.gameLimit??20)+" 个游戏",1)])]))])):(s(),o("div",Lt,[...e[3]||(e[3]=[t("p",null,"暂无游戏数据",-1)])]))])]),_:1})}}}),At=Object.assign(G(zt,[["__scopeId","data-v-558f2edf"]]),{__name:"SteamGamesTabs"}),Dt={class:"steam-page"},Ot={key:0,class:"loading-state"},Ft={class:"loading-container"},Wt={class:"progress-bar-container"},Nt={class:"progress-bar"},Vt={class:"progress-info"},Bt={class:"progress-text"},jt={key:1,class:"error-state"},Et={key:2,class:"steam-content"},L=20,Rt=x({__name:"steam",setup(n){const m=N(),i=V();B({title:"Steam",meta:[{name:"description",content:`${m.author.name} 的 Steam 个人资料，查看完整的游戏库、游戏时长、成就等信息。`},{property:"og:type",content:"profile"},{name:"keywords",content:"Steam,游戏库,游戏时长,成就"}]}),i.setAside(["blog-tech","comm-group"]);const{fetchSteamData:l}=U(),u=p(!0),d=p(!1),g=p(null),b=p(null),k=p(null),r=p(0);async function M(){try{r.value=5,await new Promise(e=>setTimeout(e,300)),r.value=15;const h=q(()=>{if(r.value<85){const e=Math.random()*8+2;r.value=Math.round(Math.min(r.value+e,85))}},400),a=await l(L);if(clearInterval(h),r.value=90,a.success&&a.data){const e=a.data,$=a.allMetadata;await Promise.all([(async()=>{g.value=e.user??null,await new Promise(_=>setTimeout(_,100))})(),(async()=>{b.value=e.games??null,await new Promise(_=>setTimeout(_,100))})(),(async()=>{k.value=$??null,await new Promise(_=>setTimeout(_,80))})()]),r.value=100}else console.warn("Steam API returned unsuccessful response or missing data"),d.value=!0}catch(h){console.error("Failed to fetch Steam data:",h),d.value=!0}finally{u.value=!1}}return j(M),(h,a)=>{const e=O,$=rt,_=$t,y=At,F=Y;return s(),o("div",Dt,[c(u)?(s(),o("div",Ot,[t("div",Ft,[a[1]||(a[1]=t("p",{class:"loading-text"}," 加载 Steam 数据中... ",-1)),t("div",Wt,[t("div",Nt,[t("div",{class:"progress-fill",style:A({width:`${c(r)}%`})},null,4)]),t("div",Vt,[a[0]||(a[0]=t("p",{class:"loading-detail"}," 正在获取用户信息、游戏库和成就数据... ",-1)),t("p",Bt,f(Math.round(c(r)))+"% ",1)])])])])):c(d)?(s(),o("div",jt,[v(e,{name:"ph:warning-bold",size:"36"}),a[2]||(a[2]=t("p",null,"无法加载 Steam 数据",-1)),a[3]||(a[3]=t("p",{class:"error-detail"}," 请检查 API 是否可用 ",-1))])):(s(),o("div",Et,[v($,{user:c(g),metadata:c(k)},null,8,["user","metadata"]),v(_,{games:c(b),user:c(g)},null,8,["games","user"]),v(y,{games:c(b),"game-limit":L},null,8,["games"])])),v(F)])}}}),Kt=G(Rt,[["__scopeId","data-v-0637c7f5"]]);export{Kt as default};
