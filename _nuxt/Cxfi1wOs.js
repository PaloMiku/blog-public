import{y as C,a2 as x,r as g,U as $,am as w,z as G,d as i,f as u,J as s,e as c,h as a,g as f,a6 as B,t as m,a$ as E,_ as N}from"./DYRC53uO.js";const D=["title"],P={class:"game-header"},S={class:"game-content"},V={class:"game-name"},j={class:"game-meta"},z={class:"meta-item"},F={class:"value"},I={key:0,class:"meta-item"},M={class:"value"},T={key:1,class:"meta-item"},U={class:"value"},W={key:0,class:"achievements-section"},J={class:"achievements-header"},L={class:"value"},O={key:1,class:"game-card game-card-error"},Z={key:2,class:"game-card game-card-loading"},q=C({__name:"GameCard",props:{game:{default:void 0},appid:{default:void 0}},setup(h){const _=h,y=`${x.steam?.apiBase}/steam-game`,p=new Map,d=g(!1),n=g(!1),v=g(null);let l=null;$(()=>_.appid,async o=>{if(o&&!_.game){if(p.has(o)){v.value=p.get(o)??null,d.value=!1,n.value=!1;return}d.value=!0,n.value=!1,l&&l.abort(),l=new AbortController;try{const e=await fetch(`${y}?appid=${o}`,{signal:l.signal});if(e.ok){const r=await e.json();r.success&&r.data?.game?(v.value=r.data.game,p.set(o,r.data.game)):n.value=!0}else n.value=!0}catch(e){e instanceof Error&&e.name!=="AbortError"&&(console.error("[GameCard] Fetch error:",e),n.value=!0)}finally{d.value=!1}}},{immediate:!0}),w(()=>{l&&l.abort()});const t=G(()=>_.game||v.value);function k(o){window.open(`https://store.steampowered.com/app/${o}`,"_blank")}return(o,e)=>{const r=B,b=E;return!s(d)&&s(t)?(c(),i("div",{key:0,class:"game-card",title:`点击查看 ${s(t).name} 的 Steam 页面`,onClick:e[0]||(e[0]=A=>k(s(t).appid))},[a("div",P,[f(r,{src:s(t).images.headerImage,alt:s(t).name,class:"header-image",loading:"lazy"},null,8,["src","alt"]),e[1]||(e[1]=a("div",{class:"game-overlay"},null,-1))]),a("div",S,[a("h3",V,m(s(t).name),1),a("div",j,[a("div",z,[e[2]||(e[2]=a("span",{class:"label"},"总时长:",-1)),a("span",F,m(s(t).playtimeForever)+"h",1)]),s(t).playtimeTwoWeeks!==void 0?(c(),i("div",I,[e[3]||(e[3]=a("span",{class:"label"},"两周内时长:",-1)),a("span",M,m(s(t).playtimeTwoWeeks)+"h",1)])):u("",!0),s(t).price?(c(),i("div",T,[e[4]||(e[4]=a("span",{class:"label"},"价格:",-1)),a("span",U,m(s(t).price.displayPrice),1)])):u("",!0)]),s(t).achievements?(c(),i("div",W,[a("div",J,[e[5]||(e[5]=a("span",{class:"label"},"成就:",-1)),a("span",L,m(s(t).achievements.unlocked)+"/"+m(s(t).achievements.total),1)]),f(b,{percent:s(t).achievements.percentage,"show-time":!1,height:"3px"},null,8,["percent"])])):u("",!0)])],8,D)):s(n)?(c(),i("div",O,[...e[6]||(e[6]=[a("div",{class:"error-content"},[a("p",null,"游戏加载失败"),a("small",null,"请检查游戏 ID 是否正确")],-1)])])):s(d)?(c(),i("div",Z,[...e[7]||(e[7]=[a("div",{class:"loading-skeleton"},null,-1)])])):u("",!0)}}}),K=Object.assign(N(q,[["__scopeId","data-v-1cf9836e"]]),{__name:"GameCard"});export{K as default};
