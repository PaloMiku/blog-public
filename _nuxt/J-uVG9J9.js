import{d as T,k as o,h as s,j as e,i as F,n as B,l as d,t as l,p as E,Y as I,aw as $,z as P,r as p,c as _,N as R,o as j,f as y,w as S,a0 as L,ay as O,F as x,v as C}from"#entry";import{u as U}from"./DCfs0kZU.js";import{_ as W}from"./B-Q7bu-f.js";import q from"./CoXVAd0R.js";import"./0pYs9o80.js";const Q=["title"],Y={class:"game-header"},Z={class:"game-content"},H={class:"game-name"},J={class:"game-meta"},K={class:"meta-item"},X={class:"value"},ee={key:0,class:"meta-item"},ae={class:"value"},te={key:1,class:"meta-item"},se={class:"value"},ne={key:2,class:"meta-item"},oe={class:"value"},le={key:3,class:"meta-item"},ie={class:"value"},me={key:0,class:"achievements-progress"},ce={class:"progress-bar"},re={class:"progress-text"},de={key:1,class:"game-description"},ue={class:"game-footer"},ge=["href"],ve=T({__name:"GameCard",props:{game:{}},setup(a){const r=m=>{window.open(`https://store.steampowered.com/app/${m}`,"_blank")};return(m,t)=>{const u=B;return s(),o("div",{class:"game-card",title:`点击查看 ${a.game.name} 的 Steam 页面`,onClick:t[2]||(t[2]=g=>r(a.game.appid))},[e("div",Y,[F(u,{src:a.game.images.headerImage,alt:a.game.name,class:"header-image",loading:"lazy"},null,8,["src","alt"]),t[3]||(t[3]=e("div",{class:"game-overlay"},null,-1))]),e("div",Z,[e("h3",H,l(a.game.name),1),e("div",J,[e("div",K,[t[4]||(t[4]=e("span",{class:"label"},"总时长:",-1)),e("span",X,l(a.game.playtimeForever)+" 小时",1)]),a.game.playtimeTwoWeeks!==void 0?(s(),o("div",ee,[t[5]||(t[5]=e("span",{class:"label"},"最近两周:",-1)),e("span",ae,l(a.game.playtimeTwoWeeks)+" 小时",1)])):d("",!0),a.game.achievements?(s(),o("div",te,[t[6]||(t[6]=e("span",{class:"label"},"成就:",-1)),e("span",se,l(a.game.achievements.unlocked)+"/"+l(a.game.achievements.total),1)])):d("",!0),a.game.releaseDate?(s(),o("div",ne,[t[7]||(t[7]=e("span",{class:"label"},"发布:",-1)),e("span",oe,l(a.game.releaseDate),1)])):d("",!0),a.game.price?(s(),o("div",le,[t[8]||(t[8]=e("span",{class:"label"},"价格:",-1)),e("span",ie,l(a.game.price.displayPrice),1)])):d("",!0)]),a.game.achievements?(s(),o("div",me,[e("div",ce,[e("div",{class:I(["progress-fill",{"progress-complete":a.game.achievements.percentage===100}]),style:E({width:`${a.game.achievements.percentage}%`})},null,6)]),e("span",re,"成就进度: "+l(a.game.achievements.percentage)+"%",1)])):d("",!0),a.game.shortDescription?(s(),o("p",de,l(a.game.shortDescription),1)):d("",!0),e("div",ue,[e("a",{class:"steam-link",href:`https://store.steampowered.com/app/${a.game.appid}`,target:"_blank",rel:"noopener noreferrer",onClick:t[0]||(t[0]=$(()=>{},["stop"])),onMousedown:t[1]||(t[1]=$(()=>{},["stop"]))}," 在 Steam 中查看 → ",40,ge)])])],8,Q)}}}),pe=Object.assign(P(ve,[["__scopeId","data-v-f40df456"]]),{__name:"GameCard"}),he={class:"tab-content"},_e={key:0,class:"games-grid"},ye={key:1,class:"empty-state"},fe={class:"tab-content"},ke={class:"games-toolbar"},be={class:"game-count"},we={key:0,class:"games-grid"},Ge={key:1,class:"empty-state"},$e={key:0},Se={key:1},xe={key:2,class:"pagination-control"},f=12,Ce=T({__name:"SteamGamesTabs",props:{games:{},initialSearch:{}},setup(a){const r=a,m=p(r.initialSearch||""),t=p(1),u=p(r.games?.recentGames??[]),g=p(r.games?.allGames??null),k=p(!1),b=_(()=>g.value??r.games?.allGames??[]),h=_(()=>{if(!b.value)return[];let n=[...b.value];if(m.value.trim()){const i=m.value.toLowerCase();n=n.filter(v=>v.name.toLowerCase().includes(i))}return n.sort((i,v)=>v.playtimeForever-i.playtimeForever)}),w=_(()=>Math.ceil(h.value.length/f)),V=_(()=>{const n=(t.value-1)*f;return h.value.slice(n,n+f)});R(m,()=>{t.value=1,k.value||(k.value=!0,G())});const{getRecentGames:D,getAllGamesSorted:M}=U(),A=async()=>{try{const n=await D();n&&(u.value=n)}catch(n){console.error("Failed to fetch recent games",n)}},G=async()=>{if(!g.value)try{const n=await M();g.value=n}catch(n){console.error("Failed to fetch all games",n)}};return j(()=>{A(),setTimeout(()=>{g.value||G()},2e3)}),(n,i)=>{const v=pe,N=W,z=q;return s(),y(z,{tabs:["最近游戏","游戏库"],center:""},{tab1:S(()=>[e("div",he,[u.value&&u.value.length>0?(s(),o("div",_e,[(s(!0),o(x,null,C(u.value,c=>(s(),y(v,{key:c.appid,game:c},null,8,["game"]))),128))])):(s(),o("div",ye,[...i[2]||(i[2]=[e("p",null,"暂无最近游戏数据",-1)])]))])]),tab2:S(()=>[e("div",fe,[e("div",ke,[L(e("input",{"onUpdate:modelValue":i[0]||(i[0]=c=>m.value=c),type:"text",placeholder:"搜索游戏...",class:"search-input"},null,512),[[O,m.value]]),e("div",be,l(h.value.length)+" / "+l(r.games?.totalCount??g.value?.length??0),1)]),h.value.length>0?(s(),o("div",we,[(s(!0),o(x,null,C(V.value,c=>(s(),y(v,{key:c.appid,game:c},null,8,["game"]))),128))])):(s(),o("div",Ge,[m.value?(s(),o("p",$e,"没有找到匹配的游戏")):(s(),o("p",Se,"暂无游戏数据"))])),w.value>1?(s(),o("div",xe,[F(N,{modelValue:t.value,"onUpdate:modelValue":i[1]||(i[1]=c=>t.value=c),class:"pagination","total-pages":w.value},null,8,["modelValue","total-pages"])])):d("",!0)])]),_:1})}}}),Me=Object.assign(P(Ce,[["__scopeId","data-v-1303d99e"]]),{__name:"SteamGamesTabs"});export{Me as default};
