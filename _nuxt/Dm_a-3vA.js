import{d as C,u as w,e as f,o as M,J as S,k as n,K as $,j as o,l as a,q as l,n as d,_ as z,F as y,y as k,m as h,z as p,C as D}from"#entry";import{_ as H}from"./BSH8avIx.js";const G={key:0,class:"echo-loading"},U={key:1,class:"echo-error"},N={key:2,class:"echo-empty"},W={key:3,class:"echo-list"},F=["href","title"],J={class:"echo-header"},L={class:"echo-content"},O={class:"echo-text"},V={class:"echo-meta"},j={key:0,class:"echo-tags"},K=["title"],P={class:"echo-time"},R={key:0,class:"echo-thumbnail"},q=["src","alt"],A=C({__name:"EchoTrend",setup(Z){const x=w(),_=f([]),u=f(!1),g=f(!1),T=async()=>{u.value=!0;try{const{echo:s}=x,t=await $fetch(`${s.apiBase}${s.apiEndpoint}?page=1&pageSize=3`);if(t?.data?.items){const i=t.data.items;_.value=i.filter(c=>!c.private).sort((c,e)=>new Date(e.created_at).getTime()-new Date(c.created_at).getTime()).slice(0,3)}}catch(s){console.error("Failed to fetch echos:",s),g.value=!0}finally{u.value=!1}},b=s=>{const t=new Date(s),c=new Date().getTime()-t.getTime(),e=Math.floor(c/1e3),r=Math.floor(e/60),m=Math.floor(r/60),v=Math.floor(m/24);return e<60?"刚刚":r<60?`${r}分钟前`:m<24?`${m}小时前`:v<7?`${v}天前`:t.toLocaleDateString("zh-CN")},E=(s,t=60)=>s?s.length>t?`${s.slice(0,t)}...`:s:"[无内容]",I=s=>{switch(s){case"GITHUBPROJ":case"GITHUB":return{icon:"mdi:github",color:"var(--c-text-2)"};case"MUSIC":return{icon:"mdi:music",color:"var(--c-primary)"};case"WEBSITE":return{icon:"mdi:globe",color:"var(--c-text-2)"};default:return{icon:"mdi:link",color:"var(--c-text-2)"}}},B=s=>({GITHUBPROJ:"GitHub 项目",GITHUB:"GitHub",MUSIC:"音乐",WEBSITE:"网站",LINK:"链接"})[s||""]||s||"";return M(()=>{T()}),(s,t)=>{const i=z,c=H;return n(),S(c,{card:"",title:"最新动态"},{default:$(()=>[l(u)?(n(),o("div",G,[d(i,{name:"eos-icons:loading",size:"16",class:"spin"}),t[0]||(t[0]=a("span",null,"加载中...",-1))])):l(g)?(n(),o("div",U,[d(i,{name:"mdi:alert-circle",size:"16"}),t[1]||(t[1]=a("span",null,"加载失败",-1))])):l(_).length===0?(n(),o("div",N,[d(i,{name:"mdi:inbox",size:"16"}),t[2]||(t[2]=a("span",null,"暂无动态",-1))])):(n(),o("div",W,[(n(!0),o(y,null,k(l(_),e=>(n(),o("a",{key:e.id,href:`https://memo.sotkg.com/echo/${e.id}`,target:"_blank",rel:"noopener noreferrer",class:"echo-item",title:e.content},[a("div",J,[a("div",L,[a("div",O,p(E(e.content,40)),1),a("div",V,[e.tags&&e.tags.length>0?(n(),o("div",j,[(n(!0),o(y,null,k(e.tags.slice(0,1),r=>(n(),o("span",{key:r.id,class:"echo-tag"}," #"+p(r.name),1))),128))])):h("",!0),e.extension_type?(n(),o("span",{key:1,class:"echo-extension-badge",title:B(e.extension_type)},[d(i,{name:I(e.extension_type).icon,size:"14"},null,8,["name"])],8,K)):h("",!0)])]),a("div",P,p(b(e.created_at)),1)]),e.images?.[0]?(n(),o("div",R,[a("img",{src:e.images[0].image_url,alt:e.content},null,8,q)])):h("",!0)],8,F))),128))])),t[3]||(t[3]=a("div",{class:"echo-footer"},[a("a",{href:"/echo",class:"echo-link"},"查看更多 →")],-1))]),_:1})}}}),Y=Object.assign(D(A,[["__scopeId","data-v-a19cf78f"]]),{__name:"WidgetEchoTrend"});export{Y as default};
