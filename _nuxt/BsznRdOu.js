import{d as P,r as _,k as n,h as a,j as e,l as u,t as m,u as l,i as d,q as R,n as E,p as U,y as Z,z,Q as K,R as M,B as J,C as X,E as Y,c as S,N as ee,o as te,G as se,w as V,S as ae,K as L,U as ne,F as N,v as A,f as B}from"#entry";import{f as oe,s as le,a as ie,u as re}from"./p0smk1q9.js";import{_ as ce}from"./DZepU1Ar.js";import me from"./DdOsxolW.js";import{_ as de}from"./D0LUoPa6.js";import"./B5IlXZ1e.js";const ue={key:0,class:"steam-profile"},ve={class:"cache-header"},_e={key:0,class:"cache-hint"},ge=["disabled","title"],pe={class:"profile-header"},he={class:"profile-info"},fe={class:"username-row"},ye={class:"username"},ke={class:"status-badge-group"},$e={key:0,class:"status-playing"},be={key:1,class:"status-playing"},Se=["href"],Ge={key:1,class:"steam-profile-skeleton"},we={key:2,class:"steam-profile-empty"},xe=P({__name:"SteamProfile",props:{user:{},loading:{type:Boolean,default:!1},metadata:{default:null}},emits:["refresh"],setup(t,{emit:k}){const $=k,o=_(!1),b=async()=>{o.value=!0,$("refresh"),await new Promise(i=>setTimeout(i,500)),o.value=!1},f=i=>le[i]||"#90a0a6",y=i=>ie[i]||i;return(i,r)=>{const G=R,g=E;return t.user?(a(),n("div",ue,[e("div",ve,[t.metadata?.user?(a(),n("div",_e," 更新于 "+m(l(oe)(t.metadata.user?.cachedAt||"")),1)):u("",!0),e("button",{class:"refresh-btn",disabled:l(o),title:l(o)?"刷新中...":"刷新数据",onClick:b},[d(G,{name:l(o)?"ph:spinner-bold":"ph:arrow-clockwise-bold",size:"16"},null,8,["name"])],8,ge)]),e("div",pe,[d(g,{src:t.user.avatar.large,alt:t.user.username,class:"avatar",loading:"lazy"},null,8,["src","alt"]),e("div",he,[e("div",fe,[e("h2",ye,m(t.user.username),1),e("div",ke,[e("div",{class:"status-badge",style:U({"--status-color":f(t.user.status)})},[r[0]||(r[0]=e("span",{class:"status-dot"},null,-1)),Z(" "+m(y(t.user.status)),1)],4)])]),t.user.currentGame?(a(),n("p",$e," 正在玩 "+m(t.user.currentGame.name),1)):t.user.status==="offline"?(a(),n("p",be," 用户当前离线 ")):u("",!0),e("a",{href:t.user.profileUrl,target:"_blank",class:"profile-link"}," 访问 Steam 个人资料 → ",8,Se)])])])):t.loading?(a(),n("div",Ge,[...r[1]||(r[1]=[e("div",{class:"skeleton-avatar"},null,-1),e("div",{class:"skeleton-info"},[e("div",{class:"skeleton-text"}),e("div",{class:"skeleton-text short"})],-1)])])):(a(),n("div",we,[...r[2]||(r[2]=[e("p",null,"无法加载 Steam 数据",-1)])]))}}}),Ce=Object.assign(z(xe,[["__scopeId","data-v-a463f02d"]]),{__name:"SteamProfile"}),Pe=["title"],ze={class:"game-header"},Fe={class:"game-content"},Te={class:"game-name"},De={class:"game-meta"},Ie={class:"meta-item"},Me={class:"value"},Ve={key:0,class:"meta-item"},Le={class:"value"},Ne={key:1,class:"meta-item"},Ae={class:"value"},Be={key:2,class:"meta-item"},Re={class:"value"},Ee={key:3,class:"meta-item"},Ue={class:"value"},We={key:0,class:"achievements-progress"},je={class:"progress-bar"},qe={class:"progress-text"},He={key:1,class:"game-description"},Oe={class:"game-footer"},Qe=["href"],Ze=P({__name:"GameCard",props:{game:{}},setup(t){const k=$=>{window.open(`https://store.steampowered.com/app/${$}`,"_blank")};return($,o)=>{const b=E;return a(),n("div",{class:"game-card",title:`点击查看 ${t.game.name} 的 Steam 页面`,onClick:o[2]||(o[2]=f=>k(t.game.appid))},[e("div",ze,[d(b,{src:t.game.images.headerImage,alt:t.game.name,class:"header-image",loading:"lazy"},null,8,["src","alt"]),o[3]||(o[3]=e("div",{class:"game-overlay"},null,-1))]),e("div",Fe,[e("h3",Te,m(t.game.name),1),e("div",De,[e("div",Ie,[o[4]||(o[4]=e("span",{class:"label"},"总时长:",-1)),e("span",Me,m(t.game.playtimeForever)+" 小时",1)]),t.game.playtimeTwoWeeks!==void 0?(a(),n("div",Ve,[o[5]||(o[5]=e("span",{class:"label"},"最近两周:",-1)),e("span",Le,m(t.game.playtimeTwoWeeks)+" 小时",1)])):u("",!0),t.game.achievements?(a(),n("div",Ne,[o[6]||(o[6]=e("span",{class:"label"},"成就:",-1)),e("span",Ae,m(t.game.achievements.unlocked)+"/"+m(t.game.achievements.total),1)])):u("",!0),t.game.releaseDate?(a(),n("div",Be,[o[7]||(o[7]=e("span",{class:"label"},"发布:",-1)),e("span",Re,m(t.game.releaseDate),1)])):u("",!0),t.game.price?(a(),n("div",Ee,[o[8]||(o[8]=e("span",{class:"label"},"价格:",-1)),e("span",Ue,m(t.game.price.displayPrice),1)])):u("",!0)]),t.game.achievements?(a(),n("div",We,[e("div",je,[e("div",{class:K(["progress-fill",{"progress-complete":t.game.achievements.percentage===100}]),style:U({width:`${t.game.achievements.percentage}%`})},null,6)]),e("span",qe,"成就进度: "+m(t.game.achievements.percentage)+"%",1)])):u("",!0),t.game.shortDescription?(a(),n("p",He,m(t.game.shortDescription),1)):u("",!0),e("div",Oe,[e("a",{class:"steam-link",href:`https://store.steampowered.com/app/${t.game.appid}`,target:"_blank",rel:"noopener noreferrer",onClick:o[0]||(o[0]=M(()=>{},["stop"])),onMousedown:o[1]||(o[1]=M(()=>{},["stop"]))}," 在 Steam 中查看 → ",40,Qe)])])],8,Pe)}}}),Ke=Object.assign(z(Ze,[["__scopeId","data-v-f40df456"]]),{__name:"GameCard"}),Je={class:"steam-page"},Xe={class:"mobile-only"},Ye={key:0,class:"loading-state"},et={key:1,class:"error-state"},tt={key:2,class:"steam-content"},st={class:"profile-section"},at={class:"stats-overview"},nt={class:"stat-card"},ot={class:"stat-info"},lt={class:"stat-value"},it={class:"stat-card"},rt={class:"stat-info"},ct={class:"stat-value"},mt={key:0,class:"stat-card"},dt={class:"stat-info"},ut={class:"stat-value"},vt={class:"tab-content"},_t={key:0,class:"games-grid"},gt={key:1,class:"empty-state"},pt={class:"tab-content"},ht={class:"games-toolbar"},ft={class:"game-count"},yt={key:0,class:"games-grid"},kt={key:1,class:"empty-state"},$t={key:0},bt={key:1},St={key:2,class:"pagination-control"},C=12,Gt=P({__name:"steam",setup(t){const k=J();X().setAside(["blog-tech","comm-group"]),Y({title:"Steam",meta:[{name:"description",content:`${k.author.name} 的 Steam 个人资料，查看完整的游戏库、游戏时长、成就等信息。`},{property:"og:type",content:"profile"},{name:"keywords",content:"Steam,游戏库,游戏时长,成就"}]});const{fetchSteamData:o,formatPlaytime:b}=re(),f=_(!0),y=_(!1),i=_(null),r=_(null),G=_(null),g=_(1),p=_(""),w=S(()=>{if(!r.value?.allGames)return[];let c=[...r.value.allGames];if(p.value.trim()){const s=p.value.toLowerCase();c=c.filter(h=>h.name.toLowerCase().includes(s))}return c.sort((s,h)=>h.playtimeForever-s.playtimeForever)}),F=S(()=>Math.ceil(w.value.length/C)),W=S(()=>{const c=(g.value-1)*C,s=c+C;return w.value.slice(c,s)});ee(p,()=>{g.value=1});const j=S(()=>i.value?.playtimeStats?.totalForever?i.value.playtimeStats.totalForever:r.value?.allGames?r.value.allGames.reduce((c,s)=>c+s.playtimeForever,0):0);S(()=>{if(!i.value?.currentGame||!r.value?.recentGames)return null;const c=r.value.recentGames.find(s=>s.appid===i.value.currentGame.appid);return c&&i.value.currentGame?{...i.value.currentGame,images:c.images}:i.value.currentGame});const T=async()=>{f.value=!0,y.value=!1,await D()},D=async()=>{try{const c=await o();if(c.success&&c.data){if(i.value=c.data.user,r.value=c.data.games,G.value=c.allMetadata,i.value?.currentGame&&r.value?.recentGames){const s=r.value.recentGames.find(h=>h.appid===i.value.currentGame.appid);s&&(i.value.currentGame={...i.value.currentGame,images:s.images})}}else y.value=!0}catch(c){console.error("Failed to fetch Steam data:",c),y.value=!0}finally{f.value=!1}};return te(D),(c,s)=>{const h=se,x=R,q=Ce,I=Ke,H=ce,O=me,Q=de;return a(),n("div",Je,[e("div",Xe,[d(h,{to:"/",suffix:"Steam"})]),l(f)?(a(),n("div",Ye,[...s[2]||(s[2]=[e("div",{class:"spinner"},null,-1),e("p",null,"加载 Steam 数据中...",-1)])])):l(y)?(a(),n("div",et,[d(x,{name:"ph:warning-bold",size:"48"}),s[3]||(s[3]=e("p",null,"无法加载 Steam 数据",-1)),s[4]||(s[4]=e("p",{class:"error-detail"},"请检查 API 是否可用或稍后重试",-1)),e("button",{onClick:T}," 重试 ")])):l(i)&&l(r)?(a(),n("div",tt,[e("div",st,[d(q,{user:l(i),metadata:l(G),onRefresh:T},null,8,["user","metadata"])]),e("div",at,[e("div",nt,[d(x,{name:"ph:game-controller-bold",size:"28",class:"stat-icon"}),e("div",ot,[s[5]||(s[5]=e("div",{class:"stat-label"},"游戏总数",-1)),e("div",lt,m(l(r).totalCount),1)])]),e("div",it,[d(x,{name:"ph:hourglass-bold",size:"28",class:"stat-icon"}),e("div",rt,[s[6]||(s[6]=e("div",{class:"stat-label"},"总游玩时长",-1)),e("div",ct,m(l(j))+" 小时",1)])]),l(i)?.playtimeStats?.totalTwoWeeks?(a(),n("div",mt,[d(x,{name:"ph:calendar-bold",size:"28",class:"stat-icon"}),e("div",dt,[s[7]||(s[7]=e("div",{class:"stat-label"},"最近两周内时长",-1)),e("div",ut,m(l(b)(l(i).playtimeStats.totalTwoWeeks)),1)])])):u("",!0)]),d(O,{tabs:["最近游戏","游戏库"],center:""},{tab1:V(()=>[e("div",vt,[l(r).recentGames.length>0?(a(),n("div",_t,[(a(!0),n(N,null,A(l(r).recentGames,v=>(a(),B(I,{key:v.appid,game:v},null,8,["game"]))),128))])):(a(),n("div",gt,[...s[8]||(s[8]=[e("p",null,"暂无最近游戏数据",-1)])]))])]),tab2:V(()=>[e("div",pt,[e("div",ht,[ae(e("input",{"onUpdate:modelValue":s[0]||(s[0]=v=>L(p)?p.value=v:null),type:"text",placeholder:"搜索游戏...",class:"search-input"},null,512),[[ne,l(p)]]),e("div",ft,m(l(w).length)+" / "+m(l(r).totalCount),1)]),l(w).length>0?(a(),n("div",yt,[(a(!0),n(N,null,A(l(W),v=>(a(),B(I,{key:v.appid,game:v},null,8,["game"]))),128))])):(a(),n("div",kt,[l(p)?(a(),n("p",$t," 没有找到匹配的游戏 ")):(a(),n("p",bt," 暂无游戏数据 "))])),l(F)>1?(a(),n("div",St,[d(H,{modelValue:l(g),"onUpdate:modelValue":s[1]||(s[1]=v=>L(g)?g.value=v:null),class:"pagination","total-pages":l(F)},null,8,["modelValue","total-pages"])])):u("",!0)])]),_:1})])):u("",!0),d(Q)])}}}),Tt=z(Gt,[["__scopeId","data-v-396c1701"]]);export{Tt as default};
