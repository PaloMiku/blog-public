import{_ as N,c as A,d as V}from"./CMZTz04O.js";import{J as k,Q as n,aN as a,b5 as e,aR as u,br as O,aQ as b,b8 as c,a_ as G,b7 as D,b4 as S,K as d,aZ as j,r as p,k as w,aM as I,aT as P,aU as C,aV as M,ah as B,N as E}from"./CDBNL-Sb.js";import{s as Q,a as R,f as U,u as H}from"./DROo_aGF.js";import J from"./CwKGqXNE.js";import{_ as K}from"./4AiC-1An.js";const Z={key:0,class:"steam-profile"},q={class:"profile-header"},X={class:"profile-info"},Y={class:"username-row"},ee={class:"username"},se={class:"status-badge-group"},te={key:0,class:"status-playing"},ae={key:1,class:"status-playing"},oe=["href"],ne={key:1,class:"steam-profile-empty"},le=k({__name:"SteamProfile",props:{user:{},metadata:{default:null}},setup(s){const m=t=>Q[t]||"#90a0a6",i=t=>R[t]||t;return(t,r)=>{const _=O;return s.user?(a(),n("div",Z,[e("div",q,[u(_,{src:s.user.avatar.large,alt:s.user.username,class:"avatar",loading:"lazy"},null,8,["src","alt"]),e("div",X,[e("div",Y,[e("h2",ee,c(s.user.username),1),e("div",se,[e("div",{class:"status-badge",style:G({"--status-color":m(s.user.status)})},[r[0]||(r[0]=e("span",{class:"status-dot"},null,-1)),D(" "+c(i(s.user.status)),1)],4)])]),s.user.currentGame?(a(),n("p",te," 正在玩 "+c(s.user.currentGame.name),1)):s.user.status==="offline"?(a(),n("p",ae," 用户当前离线 ")):b("",!0),e("a",{href:s.user.profileUrl,target:"_blank",class:"profile-link"}," 访问 Steam 个人资料 → ",8,oe)])])])):(a(),n("div",ne,[...r[1]||(r[1]=[e("p",null,"无法加载 Steam 数据",-1)])]))}}}),ie=Object.assign(S(le,[["__scopeId","data-v-4f319339"]]),{__name:"SteamProfile"}),ce={class:"stats-overview"},re={class:"stat-card"},me={class:"stat-info"},de={class:"stat-value"},ue={class:"stat-card"},_e={class:"stat-info"},ve={class:"stat-value"},ge={key:0,class:"stat-card"},pe={class:"stat-info"},he={class:"stat-value"},ye=k({__name:"SteamStatsOverview",props:{games:{},user:{}},setup(s){return(m,i)=>{const t=N;return a(),n("div",ce,[e("div",re,[u(t,{name:"ph:game-controller-bold",size:"28",class:"stat-icon"}),e("div",me,[i[0]||(i[0]=e("div",{class:"stat-label"},"游戏总数",-1)),e("div",de,c(s.games?.totalCount??0),1)])]),e("div",ue,[u(t,{name:"ph:hourglass-bold",size:"28",class:"stat-icon"}),e("div",_e,[i[1]||(i[1]=e("div",{class:"stat-label"},"总游玩时长",-1)),e("div",ve,c(s.user?.playtimeStats?.totalForever??0)+" 小时",1)])]),s.user?.playtimeStats?.totalTwoWeeks?(a(),n("div",ge,[u(t,{name:"ph:calendar-bold",size:"28",class:"stat-icon"}),e("div",pe,[i[2]||(i[2]=e("div",{class:"stat-label"},"最近两周内时长",-1)),e("div",he,c(d(U)(s.user.playtimeStats.totalTwoWeeks)),1)])])):b("",!0)])}}}),fe=Object.assign(S(ye,[["__scopeId","data-v-8ea6cba8"]]),{__name:"SteamStatsOverview"}),$e=["title"],be={class:"game-header"},ke={class:"game-content"},Se={class:"game-name"},we={class:"game-meta"},xe={class:"meta-item"},Te={class:"value"},Ie={key:0,class:"meta-item"},Ge={class:"value"},Pe={key:1,class:"meta-item"},Ce={class:"value"},Me={key:0,class:"achievements-section"},ze={class:"achievements-header"},Le={class:"value"},Ne={class:"progress-bar"},Oe=k({__name:"GameCard",props:{game:{}},setup(s){const m=i=>{window.open(`https://store.steampowered.com/app/${i}`,"_blank")};return(i,t)=>{const r=O;return a(),n("div",{class:"game-card",title:`点击查看 ${s.game.name} 的 Steam 页面`,onClick:t[0]||(t[0]=_=>m(s.game.appid))},[e("div",be,[u(r,{src:s.game.images.headerImage,alt:s.game.name,class:"header-image",loading:"lazy"},null,8,["src","alt"]),t[1]||(t[1]=e("div",{class:"game-overlay"},null,-1))]),e("div",ke,[e("h3",Se,c(s.game.name),1),e("div",we,[e("div",xe,[t[2]||(t[2]=e("span",{class:"label"},"总时长:",-1)),e("span",Te,c(s.game.playtimeForever)+"h",1)]),s.game.playtimeTwoWeeks!==void 0?(a(),n("div",Ie,[t[3]||(t[3]=e("span",{class:"label"},"两周内时长:",-1)),e("span",Ge,c(s.game.playtimeTwoWeeks)+"h",1)])):b("",!0),s.game.price?(a(),n("div",Pe,[t[4]||(t[4]=e("span",{class:"label"},"价格:",-1)),e("span",Ce,c(s.game.price.displayPrice),1)])):b("",!0)]),s.game.achievements?(a(),n("div",Me,[e("div",ze,[t[5]||(t[5]=e("span",{class:"label"},"成就:",-1)),e("span",Le,c(s.game.achievements.unlocked)+"/"+c(s.game.achievements.total),1)]),e("div",Ne,[e("div",{class:j(["progress-fill",{"progress-complete":s.game.achievements.percentage===100}]),style:G({width:`${s.game.achievements.percentage}%`})},null,6)])])):b("",!0)])],8,$e)}}}),De=Object.assign(S(Oe,[["__scopeId","data-v-6e90055b"]]),{__name:"GameCard"}),Fe={class:"tab-content"},We={key:0},Ae={class:"games-list"},Ve={key:1,class:"empty-state"},je={class:"tab-content"},Be={key:0},Ee={class:"games-list"},Qe={key:0,class:"load-more-container"},Re={key:1,class:"all-loaded-tip"},Ue={key:1,class:"empty-state"},z=5,He=k({__name:"SteamGamesTabs",props:{games:{},gameLimit:{}},setup(s){const m=s,i=p(z),t=w(()=>{const h=m.games?.allGames;return h?h.map(o=>({...o,playtimeForever:typeof o.playtimeForever=="number"?Math.round(o.playtimeForever):0,playtimeTwoWeeks:o.playtimeTwoWeeks?Math.round(o.playtimeTwoWeeks):0})):[]}),r=w(()=>t.value),_=w(()=>r.value.slice(0,i.value)),f=w(()=>i.value<r.value.length),$=()=>{i.value+=z};return(h,o)=>{const x=De,y=J;return a(),I(y,{tabs:["最近游戏","游戏库"],center:""},{tab1:P(()=>[e("div",Fe,[m.games?.recentGames&&m.games.recentGames.length>0?(a(),n("div",We,[e("div",Ae,[(a(!0),n(C,null,M(m.games.recentGames,l=>(a(),I(x,{key:l.appid,game:l,class:"games-list-item"},null,8,["game"]))),128))])])):(a(),n("div",Ve,[...o[0]||(o[0]=[e("p",null,"暂无最近游戏数据",-1)])]))])]),tab2:P(()=>[e("div",je,[r.value.length>0?(a(),n("div",Be,[e("div",Ee,[(a(!0),n(C,null,M(_.value,l=>(a(),I(x,{key:l.appid,game:l,class:"games-list-item"},null,8,["game"]))),128))]),f.value?(a(),n("div",Qe,[e("button",{class:"load-more-btn",onClick:$}," 继续装填 ")])):(a(),n("div",Re,[e("p",null,[o[1]||(o[1]=D("最多显示按总时长排序的前 ",-1)),e("strong",null,c(m.gameLimit??20)+" 个游戏",1)])]))])):(a(),n("div",Ue,[...o[2]||(o[2]=[e("p",null,"暂无游戏数据",-1)])]))])]),_:1})}}}),Je=Object.assign(S(He,[["__scopeId","data-v-be78c41b"]]),{__name:"SteamGamesTabs"}),Ke=globalThis.setInterval,Ze={class:"steam-page"},qe={key:0,class:"loading-state"},Xe={class:"loading-container"},Ye={class:"progress-bar-container"},es={class:"progress-bar"},ss={class:"progress-info"},ts={class:"progress-text"},as={key:1,class:"error-state"},os={key:2,class:"steam-content"},L=20,ns=k({__name:"steam",setup(s){const m=A(),i=V();B({title:"Steam",meta:[{name:"description",content:`${m.author.name} 的 Steam 个人资料，查看完整的游戏库、游戏时长、成就等信息。`},{property:"og:type",content:"profile"},{name:"keywords",content:"Steam,游戏库,游戏时长,成就"}]}),i.setAside(["blog-tech","comm-group"]);const{fetchSteamData:t}=H(),r=p(!0),_=p(!1),f=p(null),$=p(null),h=p(null),o=p(0);return E(async()=>{try{o.value=5,await new Promise(v=>setTimeout(v,300)),o.value=15;const y=Ke(()=>{if(o.value<85){const v=Math.random()*8+2;o.value=Math.round(Math.min(o.value+v,85))}},400),l=await t(L);if(clearInterval(y),o.value=90,l.success&&l.data){const v=l.data,T=l.allMetadata;await Promise.all([(async()=>{f.value=v.user??null,await new Promise(g=>setTimeout(g,100))})(),(async()=>{$.value=v.games??null,await new Promise(g=>setTimeout(g,100))})(),(async()=>{h.value=T??null,await new Promise(g=>setTimeout(g,80))})()]),o.value=100}else console.warn("Steam API returned unsuccessful response or missing data"),_.value=!0}catch(y){console.error("Failed to fetch Steam data:",y),_.value=!0}finally{r.value=!1}}),(y,l)=>{const v=N,T=ie,g=fe,F=Je,W=K;return a(),n("div",Ze,[d(r)?(a(),n("div",qe,[e("div",Xe,[l[1]||(l[1]=e("p",{class:"loading-text"},"加载 Steam 数据中...",-1)),e("div",Ye,[e("div",es,[e("div",{class:"progress-fill",style:G({width:`${d(o)}%`})},null,4)]),e("div",ss,[l[0]||(l[0]=e("p",{class:"loading-detail"},"正在获取用户信息、游戏库和成就数据...",-1)),e("p",ts,c(Math.round(d(o)))+"%",1)])])])])):d(_)?(a(),n("div",as,[u(v,{name:"ph:warning-bold",size:"36"}),l[2]||(l[2]=e("p",null,"无法加载 Steam 数据",-1)),l[3]||(l[3]=e("p",{class:"error-detail"},"请检查 API 是否可用",-1))])):(a(),n("div",os,[u(T,{user:d(f),metadata:d(h)},null,8,["user","metadata"]),u(g,{games:d($),user:d(f)},null,8,["games","user"]),u(F,{games:d($),"game-limit":L},null,8,["games"])])),u(W)])}}}),ds=S(ns,[["__scopeId","data-v-b610f24a"]]);export{ds as default};
