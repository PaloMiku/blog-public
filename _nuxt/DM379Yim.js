import{d as T,k as o,h as n,j as e,i as F,n as z,l as u,t as i,p as B,Y as E,aw as $,z as M,r as p,c as _,N as I,o as R,f as y,w as S,a0 as j,ay as L,F as x,v as C}from"#entry";import{u as O}from"./0Iju0TH6.js";import{_ as U}from"./B-Q7bu-f.js";import q from"./CoXVAd0R.js";import"./0pYs9o80.js";const Q=["title"],Y={class:"game-header"},Z={class:"game-content"},H={class:"game-name"},J={class:"game-meta"},K={class:"meta-item"},X={class:"value"},ee={key:0,class:"meta-item"},ae={class:"value"},te={key:1,class:"meta-item"},se={class:"value"},ne={key:2,class:"meta-item"},oe={class:"value"},le={key:3,class:"meta-item"},ie={class:"value"},me={key:0,class:"achievements-progress"},ce={class:"progress-bar"},re={class:"progress-text"},de={key:1,class:"game-description"},ue={class:"game-footer"},ge=["href"],ve=T({__name:"GameCard",props:{game:{}},setup(a){const r=m=>{window.open(`https://store.steampowered.com/app/${m}`,"_blank")};return(m,t)=>{const g=z;return n(),o("div",{class:"game-card",title:`点击查看 ${a.game.name} 的 Steam 页面`,onClick:t[2]||(t[2]=d=>r(a.game.appid))},[e("div",Y,[F(g,{src:a.game.images.headerImage,alt:a.game.name,class:"header-image",loading:"lazy"},null,8,["src","alt"]),t[3]||(t[3]=e("div",{class:"game-overlay"},null,-1))]),e("div",Z,[e("h3",H,i(a.game.name),1),e("div",J,[e("div",K,[t[4]||(t[4]=e("span",{class:"label"},"总时长:",-1)),e("span",X,i(a.game.playtimeForever)+" 小时",1)]),a.game.playtimeTwoWeeks!==void 0?(n(),o("div",ee,[t[5]||(t[5]=e("span",{class:"label"},"最近两周:",-1)),e("span",ae,i(a.game.playtimeTwoWeeks)+" 小时",1)])):u("",!0),a.game.achievements?(n(),o("div",te,[t[6]||(t[6]=e("span",{class:"label"},"成就:",-1)),e("span",se,i(a.game.achievements.unlocked)+"/"+i(a.game.achievements.total),1)])):u("",!0),a.game.releaseDate?(n(),o("div",ne,[t[7]||(t[7]=e("span",{class:"label"},"发布:",-1)),e("span",oe,i(a.game.releaseDate),1)])):u("",!0),a.game.price?(n(),o("div",le,[t[8]||(t[8]=e("span",{class:"label"},"价格:",-1)),e("span",ie,i(a.game.price.displayPrice),1)])):u("",!0)]),a.game.achievements?(n(),o("div",me,[e("div",ce,[e("div",{class:E(["progress-fill",{"progress-complete":a.game.achievements.percentage===100}]),style:B({width:`${a.game.achievements.percentage}%`})},null,6)]),e("span",re,"成就进度: "+i(a.game.achievements.percentage)+"%",1)])):u("",!0),a.game.shortDescription?(n(),o("p",de,i(a.game.shortDescription),1)):u("",!0),e("div",ue,[e("a",{class:"steam-link",href:`https://store.steampowered.com/app/${a.game.appid}`,target:"_blank",rel:"noopener noreferrer",onClick:t[0]||(t[0]=$(()=>{},["stop"])),onMousedown:t[1]||(t[1]=$(()=>{},["stop"]))}," 在 Steam 中查看 → ",40,ge)])])],8,Q)}}}),pe=Object.assign(M(ve,[["__scopeId","data-v-f40df456"]]),{__name:"GameCard"}),he={class:"tab-content"},_e={key:0,class:"games-grid"},ye={key:1,class:"empty-state"},fe={class:"tab-content"},ke={class:"games-toolbar"},we={class:"game-count"},be={key:0,class:"games-grid"},Ge={key:1,class:"empty-state"},$e={key:0},Se={key:1},xe={key:2,class:"pagination-control"},f=12,Ce=T({__name:"SteamGamesTabs",props:{games:{},initialSearch:{}},setup(a){const r=a,m=p(r.initialSearch||""),t=p(1),g=p(r.games?.recentGames??[]),d=p(r.games?.allGames??null),k=p(!1),w=_(()=>{if(d.value)return d.value;const s=r.games?.allGames;return s?s.map(l=>({...l,playtimeForever:Math.round(l.playtimeForever/60),playtimeTwoWeeks:l.playtimeTwoWeeks?Math.round(l.playtimeTwoWeeks/60):0})):[]}),h=_(()=>{if(!w.value)return[];let s=[...w.value];if(m.value.trim()){const l=m.value.toLowerCase();s=s.filter(v=>v.name.toLowerCase().includes(l))}return s.sort((l,v)=>v.playtimeForever-l.playtimeForever)}),b=_(()=>Math.ceil(h.value.length/f)),P=_(()=>{const s=(t.value-1)*f;return h.value.slice(s,s+f)});I(m,()=>{t.value=1,k.value||(k.value=!0,G())});const{getRecentGames:V,getAllGamesSorted:D}=O(),A=async()=>{try{const s=await V();s&&(g.value=s)}catch(s){console.error("Failed to fetch recent games",s)}},G=async()=>{if(!d.value)try{const s=await D();d.value=s}catch(s){console.error("Failed to fetch all games",s)}};return R(()=>{A(),setTimeout(()=>{d.value||G()},2e3)}),(s,l)=>{const v=pe,N=U,W=q;return n(),y(W,{tabs:["最近游戏","游戏库"],center:""},{tab1:S(()=>[e("div",he,[g.value&&g.value.length>0?(n(),o("div",_e,[(n(!0),o(x,null,C(g.value,c=>(n(),y(v,{key:c.appid,game:c},null,8,["game"]))),128))])):(n(),o("div",ye,[...l[2]||(l[2]=[e("p",null,"暂无最近游戏数据",-1)])]))])]),tab2:S(()=>[e("div",fe,[e("div",ke,[j(e("input",{"onUpdate:modelValue":l[0]||(l[0]=c=>m.value=c),type:"text",placeholder:"搜索游戏...",class:"search-input"},null,512),[[L,m.value]]),e("div",we,i(h.value.length)+" / "+i(r.games?.totalCount??d.value?.length??0),1)]),h.value.length>0?(n(),o("div",be,[(n(!0),o(x,null,C(P.value,c=>(n(),y(v,{key:c.appid,game:c},null,8,["game"]))),128))])):(n(),o("div",Ge,[m.value?(n(),o("p",$e,"没有找到匹配的游戏")):(n(),o("p",Se,"暂无游戏数据"))])),b.value>1?(n(),o("div",xe,[F(N,{modelValue:t.value,"onUpdate:modelValue":l[1]||(l[1]=c=>t.value=c),class:"pagination","total-pages":b.value},null,8,["modelValue","total-pages"])])):u("",!0)])]),_:1})}}}),De=Object.assign(M(Ce,[["__scopeId","data-v-6e0825b6"]]),{__name:"SteamGamesTabs"});export{De as default};
