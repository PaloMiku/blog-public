[{"data":1,"prerenderedAt":890},["ShallowReactive",2],{"/2024/10/write-1panel-app":3,"surround-/2024/10/write-1panel-app":884},{"id":4,"title":5,"body":6,"categories":863,"date":865,"description":866,"draft":867,"extension":868,"image":869,"meta":870,"navigation":871,"path":872,"permalink":869,"readingTime":873,"recommend":869,"references":869,"seo":878,"sitemap":879,"stem":880,"tags":881,"type":869,"updated":869,"__hash__":883},"content/posts/2024/10/write-1panel-app.md","编写1Panel应用商店第三方程序",{"type":7,"value":8,"toc":821},"minimark",[9,13,17,20,23,26,29,32,35,38,41,45,61,64,67,77,81,92,95,102,108,111,114,117,120,123,126,129,132,288,292,295,298,305,341,345,348,351,358,360,363,366,369,372,375,378,384,390,393,401,407,410,416,419,429,433,448,451,457,460,463,469,472,476,479,482,489,492,495,579,585,588,594,639,643,650,653,659,662,744,747,750,753,756,759,770,776,779,782,785,788,808,812],[10,11,12],"h2",{"id":12},"前言",[14,15,16],"p",{},"1Panel 是我目前在使用的一个服务器管理面板，它的社区版开源且免费，整体面板设计简洁快速，不需要登录，在基本体验上似乎是比隔壁宝塔要强一些。",[14,18,19],{},"不过他被很多小白和部分用户不喜爱的原因是它的应用是通过 Docker 容器化进行部署的。",[14,21,22],{},"采用 Docker 部署的坏处是应用整体内存占用会略高一些，而且配置容器组网是劝退很多小白的原因，配置不好，应用连不上数据库，网站反代不对等等。",[14,24,25],{},"但是 Docker 容器化部署的好处也是不少的，比如没有构建应用这一步，就使得应用在拉取完毕镜像以后即刻就能启动，就跟二进制应用文件差不多的感觉，不需要等上很久，也不需要太多服务器性能用于构建，在部署 Node.js 应用时效果尤为显著。而且配置文件简单，只需要了解 Docker Compose 配置文件格式就能上手，整体体验对于大规模部署是很好的。",[14,27,28],{},"当然 1Panel 也是知道小白们可能玩不明白 Docker 的，所以它还有应用商店，里面都是预先写好的 Docker Compose 文件模板，点击安装就能够一键部署，并且都自动为你做好网络设置，同时你还可以设计自己的应用上传到服务器，也可以一键安装，这样就出现了 1Panel 官方应用商店和第三方应用商店的存储库，只需要拉取仓库到服务器就能畅享海量应用。",[14,30,31],{},"实际上 1Panel 应用的结构很简单，只需要几个文件，就能够设计好你想部署的应用，今天我也来简单讲一下如何设计这个应用。",[10,33,34],{"id":34},"注意",[14,36,37],{},"值得注意的事情是，1Panel 应用商店的本质其实就是一个个 Docker Compose 编排文件的图形体现，所以实际上需要你的应用有公共可访问的 Docker 镜像才能正常使用。",[10,39,40],{"id":40},"格式",[42,43,44],"h3",{"id":44},"初始化模板",[14,46,47,48,52,53,56,57,60],{},"从",[49,50,51],"code",{"code":51},"1panel 1.3","及以上版本开始，可以在安装了 1Panel 的服务器使用",[49,54,55],{"code":55},"1panel app init \u003C应用的key> \u003C应用的版本>","指令来快速初始化应用模板文件（注意不是 ",[49,58,59],{"code":59},"1pctl","命令）",[42,62,63],{"id":63},"文件夹格式",[14,65,66],{},"应用的文件夹格式大概是长下面这个样子：",[68,69,74],"pre",{"className":70,"code":72,"language":73},[71],"language-text","├──halo // 承载应用的文件夹，这里以halo为例\n    ├── logo.png // 应用的 logo\n    ├── data.yml // 应用声明文件\n    ├── README.md // 应用的 README 文件\n    ├── 2.2.0 // 应用版本 注意不要以 v 开头\n    │&nbsp;&nbsp; ├── data.yml // 应用的参数配置，下面有详细介绍\n    │&nbsp;&nbsp; ├── data // 挂载出来的目录\n    |   ├── scripts // 脚本目录 存放 init.sh upgrade.sh uninstall.sh\n    │&nbsp;&nbsp; └── docker-compose.yml // docker-compose 文件\n    └── 2.3.2\n        ├── data.yml\n        ├── data\n        └── docker-compose.yml\n","text",[49,75,72],{"__ignoreMap":76},"",[42,78,80],{"id":79},"应用-logo","应用 Logo",[14,82,83,84,87,88,91],{},"用于在应用概览和应用详情页面展示，应用的 Logo 为 png 格式，长宽比最好是",[49,85,86],{"code":86},"180 * 180 px","，把它放在应用的根目录下，例如",[49,89,90],{"code":90},"/halo/logo.png","，不要使用诸如 webp，jpg，svg 这样的格式。",[42,93,94],{"id":94},"应用声明文件",[14,96,97,98,101],{},"声明你的应用的基本信息，让 1Panel 知道你的应用的一些基本信息，比如叫什么名字，干什么用的等等，是位于应用根目录下的",[49,99,100],{"code":100},"data.yml","文件，格式差不多如下：",[68,103,106],{"className":104,"code":105,"language":73},[71],"# 下边这一部分推荐填写，虽然 1Panel 的应用商店官方 Wiki 没有声明它到底有何用\nname: Halo\ntags:\n  - 建站\ntitle: 强大易用的开源建站工具\ntype: 建站\ndescription: 强大易用的开源建站工具\n# 下边这一部分为应用声明信息部分，注意填写正确！\nadditionalProperties:  #固定参数\n    key: halo   #应用的 key，仅限英文，用于在 Linux 创建文件夹\n    name: Halo  #应用名称\n    tags:\n        - WebSite #应用标签，可以有多个，请参照标签列表\n    shortDescZh: 强大易用的开源建站工具 #应用中文描述，不要超过 30 个字\n    shortDescEn: Powerful and easy-to-use open source website builder #应用英文描述\n    type: website  #应用类型，区别于应用分类，只能有一个，请参照下方的类型列表\n    crossVersionUpdate: true  #是否可以跨大版本升级\n    limit: 0  #应用安装数量限制，0 代表无限制\n    website: https://halo.run/  #应用的官网地址\n    github: https://github.com/halo-dev/halo #应用 GitHub 的仓库地址\n    document: https://docs.halo.run/ #应用的文档地址\n",[49,107,105],{"__ignoreMap":76},[14,109,110],{},"我们对必填应用声明信息部分从上往下进行详细的介绍：",[42,112,113],{"id":113},"key",[14,115,116],{},"诸如 halo 这样的名字，它其实就是你应用文件夹的名字，注意此处一定要与应用文件夹的名字保持一致，不然会导致应用无法正常部署安装。",[42,118,119],{"id":119},"name",[14,121,122],{},"应用的名称部分，用于 1Panel 商店列表中展示和应用详情上方展示，填写好了能提高应用的辨认度。",[42,124,125],{"id":125},"tags",[14,127,128],{},"应用的标签，决定了应用在应用商店所属的分类，可以填写多个。",[14,130,131],{},"标签列表和其对应的分类如下：",[133,134,135,156],"table",{},[136,137,138],"thead",{},[139,140,141,145,148,150,152,154],"tr",{},[142,143,144],"th",{},"值",[142,146,147],{},"所属分类",[142,149,144],{},[142,151,147],{},[142,153,144],{},[142,155,147],{},[157,158,159,180,200,217,235,253,270],"tbody",{},[139,160,161,165,168,171,174,177],{},[162,163,164],"td",{},"WebSite",[162,166,167],{},"建站",[162,169,170],{},"Storage",[162,172,173],{},"云存储",[162,175,176],{},"Email",[162,178,179],{},"邮件服务",[139,181,182,185,188,191,194,197],{},[162,183,184],{},"Server",[162,186,187],{},"Web 服务器",[162,189,190],{},"AI",[162,192,193],{},"AI/大模型",[162,195,196],{},"Game",[162,198,199],{},"休闲游戏",[139,201,202,205,208,211,213,215],{},[162,203,204],{},"Runtime",[162,206,207],{},"运行环境",[162,209,210],{},"BI",[162,212,210],{},[162,214],{},[162,216],{},[139,218,219,222,225,228,231,233],{},[162,220,221],{},"Database",[162,223,224],{},"数据库",[162,226,227],{},"Security",[162,229,230],{},"安全",[162,232],{},[162,234],{},[139,236,237,240,243,246,249,251],{},[162,238,239],{},"Tool",[162,241,242],{},"实用工具",[162,244,245],{},"DevTool",[162,247,248],{},"开发工具",[162,250],{},[162,252],{},[139,254,255,258,260,263,266,268],{},[162,256,257],{},"DevOps",[162,259,257],{},[162,261,262],{},"Middleware",[162,264,265],{},"中间件",[162,267],{},[162,269],{},[139,271,272,275,278,281,284,286],{},[162,273,274],{},"Local",[162,276,277],{},"本地",[162,279,280],{},"Media",[162,282,283],{},"多媒体",[162,285],{},[162,287],{},[42,289,291],{"id":290},"shortdesczhen","shortDescZh/En",[14,293,294],{},"应用的中文/英文描述，用于应用在应用商店列表中和应用详情页上方快速介绍应用，不要太长（中文不超过 30 字）",[42,296,297],{"id":297},"type",[14,299,300,301,304],{},"应用的用途分类，这里主要决定了 1Panel 会怎么对待你的应用，比如",[49,302,303],{"code":303},"website","类型的可以在其网站功能中一键进行反代和分配域名。",[133,306,307,316],{},[136,308,309],{},[139,310,311,313],{},[142,312,144],{},[142,314,315],{},"说明",[157,317,318,325,333],{},[139,319,320,322],{},[162,321,303],{},[162,323,324],{},"website 即网站应用程序类型，支持在网站中一键部署和反代，WordPress 和 Halo 都是此 type",[139,326,327,330],{},[162,328,329],{},"runtime",[162,331,332],{},"mysql openresty redis 等类型的应用，倾向于应用的关键运行环境",[139,334,335,338],{},[162,336,337],{},"tool",[162,339,340],{},"phpMyAdmin redis-commander jenkins 等类型的应用，倾向于应用的维护工具等",[42,342,344],{"id":343},"crossversionupdate","crossVersionUpdate",[14,346,347],{},"决定了应用是否可以跨大版本进行升级，一般来说都可以吧。",[42,349,350],{"id":350},"limit",[14,352,353,354,357],{},"决定了这个应用最多能部署多少个，一般为",[49,355,356],{"code":356},"0","无限制，但是有些应用它确实不能重复安装，比如 Openresty 这样的反向代理服务。",[42,359,303],{"id":303},[14,361,362],{},"应用的官网地址，但不是所有应用都有官网地址，如果真没有那就填写应用的 Github 仓库地址吧，本质上就是一个联系地址",[42,364,365],{"id":365},"github",[14,367,368],{},"应用的 Github 仓库地址，本质上提交到 1Panel 应用商店的应用都是开源应用，所以一般都有这么个开源地址，你本地定制可以按情况来。",[42,370,371],{"id":371},"document",[14,373,374],{},"应用的使用文档地址，按需填写吧，不是所有应用都有完善的使用文档。",[10,376,377],{"id":377},"应用参数配置文件",[14,379,380,381,383],{},"它也是",[49,382,100],{"code":100},"，但是它在应用的版本号目录下，注意不要和应用声明文件搞混了。",[385,386,387],"blockquote",{},[14,388,389],{},"本文件主要用于生成安装时要填写的 form 表单，在应用版本文件夹下面 可以无表单，但是需要有这个 data.yml 文件，并且包含 formFields 字段。\n@1Panel 应用商店仓库官方 Wiki",[14,391,392],{},"以 Halo 的 Form 表单为例：",[14,394,395,400],{},[396,397],"img",{"alt":398,"src":399},"Halo 安装表单示例图（来自 1Panel 官方应用商店仓库）","https://user-images.githubusercontent.com/31820853/226111412-9c7b25a1-83f2-4621-8789-7ef85a2695dd.png","\n如果要生成一个上面这样子的表单，你需要这么填写应用参数配置文件（来自官方 Wiki 示例）：",[68,402,405],{"className":403,"code":404,"language":73},[71],"additionalProperties:  #固定参数\n    formFields:\n        - default: \"\"\n          envKey: PANEL_DB_HOST  #docker-compose 文件中的参数\n          key: mysql  #依赖应用的 key , 例如 mysql\n          labelEn: Database Service  #英文的 label\n          labelZh: 数据库服务  #中文的 label\n          required: true  #是否必填\n          type: service  #如果需要依赖其他应用，例如数据库，使用此 type\n        - default: halo\n          envKey: PANEL_DB_NAME\n          labelEn: Database\n          labelZh: 数据库名\n          random: true  #是否在 default 文字后面，增加随机字符串\n          required: true\n          rule: paramCommon  #校验规则\n          type: text  #需要手动填写的，使用此 type\n        - default: halo\n          envKey: PANEL_DB_USER\n          labelEn: User\n          labelZh: 数据库用户\n          random: true\n          required: true\n          rule: paramCommon\n          type: text\n        - default: halo\n          envKey: PANEL_DB_USER_PASSWORD\n          labelEn: Password\n          labelZh: 数据库用户密码\n          random: true\n          required: true\n          rule: paramComplexity\n          type: password  #密码字段使用此 type\n        - default: admin\n          envKey: HALO_ADMIN\n          labelEn: Admin Username\n          labelZh: 超级管理员用户名\n          required: true\n          rule: paramCommon\n          type: text\n        - default: halo\n          envKey: HALO_ADMIN_PASSWORD\n          labelEn: Admin Password\n          labelZh: 超级管理员密码\n          random: true\n          required: true\n          rule: paramComplexity\n          type: password\n        - default: http://localhost:8080\n          edit: true\n          envKey: HALO_EXTERNAL_URL\n          labelEn: External URL\n          labelZh: 外部访问地址\n          required: true\n          rule: paramExtUrl\n          type: text\n        - default: 8080\n          edit: true\n          envKey: PANEL_APP_PORT_HTTP\n          labelEn: Port\n          labelZh: 端口\n          required: true\n          rule: paramPort\n          type: number #端口使用此 type\n",[49,406,404],{"__ignoreMap":76},[14,408,409],{},"是不是看的眼晕了，我们这里拆出来解释下它这个东西：",[68,411,414],{"className":412,"code":413,"language":73},[71],"        - default: \"\"\n          envKey: PANEL_DB_HOST  #docker-compose 文件中的参数\n          key: mysql  #依赖应用的 key , 例如 mysql\n          labelEn: Database Service  #英文的 label\n          labelZh: 数据库服务  #中文的 label\n          required: true  #是否必填\n          type: service  #如果需要依赖其他应用，例如数据库，使用此 type\n",[49,415,413],{"__ignoreMap":76},[42,417,418],{"id":418},"dafault",[14,420,421,422,425,426,428],{},"应用这个变量值的默认格式，填写上什么应用的设置变量默认就会填写什么东西，比如说你要设置这个应用的默认前端站点是",[49,423,424],{"code":424},"example.com","就在这里这样填写上它，应用就会默认把",[49,427,424],{"code":424},"做前端默认站点值。",[42,430,432],{"id":431},"envkey","envKey",[14,434,435,436,439,440,443,444,447],{},"对应了你的应用的 compose 编排文件中环境变量设置部分，比如",[49,437,438],{"code":438},"environment","下的值，但其实简单点说就是会传递一个变量值给文件，比如",[49,441,442],{"code":442},"HOST","变量可以在 compose 文件中通过",[49,445,446],{"code":446},"${HOST}","来引用它，不难理解吧。",[14,449,450],{},"譬如在如下 Halo 例子中的引用：",[68,452,455],{"className":453,"code":454,"language":73},[71],"services:\n  halo:\n    image: halohub/halo:2.2.0\n    container_name: ${CONTAINER_NAME}\n    restart: always\n    networks:\n      - 1panel-network\n    volumes:\n      - ./data:/root/.halo2\n    ports:\n      - ${PANEL_APP_PORT_HTTP}:8090\n    command:\n      - --spring.r2dbc.url=r2dbc:pool:${HALO_PLATFORM}://${PANEL_DB_HOST}:${HALO_DB_PORT}/${PANEL_DB_NAME}\n      - --spring.r2dbc.username=${PANEL_DB_USER}\n      - --spring.r2dbc.password=${PANEL_DB_USER_PASSWORD}\n      - --spring.sql.init.platform=${HALO_PLATFORM}\n      - --halo.external-url=${HALO_EXTERNAL_URL}\n      - --halo.security.initializer.superadminusername=${HALO_ADMIN}\n      - --halo.security.initializer.superadminpassword=${HALO_ADMIN_PASSWORD}\n    labels:\n      createdBy: \"Apps\"\n\nnetworks:\n  1panel-network:\n    external: true\n",[49,456,454],{"__ignoreMap":76},[42,458,113],{"id":459},"key-1",[14,461,462],{},"这个虽然出现在了 1Panel 的官方 Wiki 示例中，但是似乎实际他们已经弃用这样写了，部分应用会依赖其他服务，比如 Halo 会有依赖 MySQL 数据库，这个时候你就在这里填写上它就能去引用它，1Panel 给的这个例子有点旧，我们使用下面的格式来实现引用外部数据库：",[68,464,467],{"className":465,"code":466,"language":73},[71],"        - child:\n            default: \"\"\n            envKey: PANEL_DB_HOST\n            required: true\n            type: service\n          default: mysql\n          envKey: PANEL_DB_TYPE\n          labelEn: Database Service\n          labelZh: 数据库服务\n          required: true\n          type: apps\n          values:\n            - label: MySQL\n              value: mysql\n            - label: MariaDB\n              value: mariadb\n",[49,468,466],{"__ignoreMap":76},[14,470,471],{},"这样你就可以为你的应用接入选择数据库的方式了，但是我也不是很懂这个，实际写起来直接 Ctrl+C 其他已实现接入外部数据库的应用范例似乎是个好办法。",[42,473,475],{"id":474},"labelenzh","labelEn/Zh",[14,477,478],{},"这个我感觉并不需要过多的介绍，已经在上面写的比较明白了，应用这个项的中英文描述。",[42,480,481],{"id":481},"required",[14,483,484,485,488],{},"决定这个变量值是否是必填的，在它为",[49,486,487],{"code":487},"true","的情况下不填写它是不能继续安装的，你可以视情况决定这个东西。",[42,490,297],{"id":491},"type-1",[14,493,494],{},"看着似乎表格很明白但实际写起来还是挺头疼的东西，自己按表格查询吧，我自己也对这个东西非常头疼，差不多它的设定决定了你的应用这个设置变量只能填什么东西。",[133,496,497,505],{},[136,498,499],{},[139,500,501,503],{},[142,502,144],{},[142,504,315],{},[157,506,507,522,533,543,554,572],{},[139,508,509,512],{},[162,510,511],{},"service",[162,513,514,517,518,521],{},[49,515,516],{"code":516},"type: service"," 如果该应用需要依赖其他组件，如 mysql redis 等，可以通过 ",[49,519,520],{"code":520},"key: mysql"," 定义依赖的名称，在创建应用时会要求先创建依赖的应用。",[139,523,524,527],{},[162,525,526],{},"password",[162,528,529,532],{},[49,530,531],{"code":531},"type: password"," 敏感信息，如密码相关的字段会默认不显示明文。",[139,534,535,537],{},[162,536,73],{},[162,538,539,542],{},[49,540,541],{"code":541},"type: text"," 一般内容，比如数据库名称，默认明文显示。",[139,544,545,548],{},[162,546,547],{},"number",[162,549,550,553],{},[49,551,552],{"code":552},"type: number"," 一般用在端口相关的配置上，只允许输入数字。",[139,555,556,559],{},[162,557,558],{},"select",[162,560,561,564,565,567,568,571],{},[49,562,563],{"code":563},"type: select"," 选项，比如 ",[49,566,487],{"code":487},", ",[49,569,570],{"code":570},"false","，日志等级等。",[139,573,574,577],{},[162,575,576],{},"通过官方给的下方的例子对照查询了解：",[162,578],{},[68,580,583],{"className":581,"code":582,"language":73},[71],"# type: service，定义一个 mysql 的 service 依赖。\n- default: \"\"\n    envKey: DB_HOST\n    key: mysql\n    labelEn: Database Service\n    labelZh: 数据库服务\n    required: true\n    type: service\n\n# type: password\n- default: Np2qgqtiUayA857GpuVI0Wtg\n    edit: true\n    envKey: DB_PASSWORD\n    labelEn: Database password\n    labelZh: 数据库密码\n    required: true\n    type: password\n\n# type: text\n- default: 192.168.100.100\n    disabled: true.\n    envKey: REDIS_HOST\n    labelEn: Redis host\n    labelZh: Redis 主机\n    type: text\n\n# type: number\n- default: 3306\n    disabled: true\n    envKey: DB_PORT\n    labelEn: Database port\n    labelZh: 数据库端口\n    rule: paramPort\n    type: number\n\n# type: select\n- default: \"ERROR\"\n    envKey: LOG_LEVEL\n    labelEn: Log level\n    labelZh: 日志级别\n    required: true\n    type: select\n    values:\n        - label: DEBUG\n          value: \"DEBUG\"\n        - label: INFO\n          value: \"INFO\"\n        - label: WARNING\n          value: \"WARNING\"\n        - label: ERROR\n          value: \"ERROR\"\n        - label: CRITICAL\n          value: \"CRITICAL\"\n",[49,584,582],{"__ignoreMap":76},[42,586,587],{"id":587},"rule",[14,589,590,591,593],{},"在上面的例子中部分登场，主要是校验用户是否书写这个东西的格式是正确的，比如防止某些用户在端口设置这里填写域名的东西，这个",[49,592,587],{"code":587},"就会强制这个填写栏必须填写什么格式。",[133,595,596,605],{},[136,597,598],{},[139,599,600,602],{},[142,601,144],{},[142,603,604],{},"规则",[157,606,607,615,623,631],{},[139,608,609,612],{},[162,610,611],{},"paramPort",[162,613,614],{},"用于限制端口范围为 1-65535",[139,616,617,620],{},[162,618,619],{},"paramExtUrl",[162,621,622],{},"格式为 http(s)://(域名/ip):(端口)",[139,624,625,628],{},[162,626,627],{},"paramCommon",[162,629,630],{},"英文、数字、.-和_，长度 2-30",[139,632,633,636],{},[162,634,635],{},"paramComplexity",[162,637,638],{},"支持英文、数字、.%@$!&~_-,长度 6-30，特殊字符不能在首尾",[10,640,642],{"id":641},"应用-compose-文件","应用 Compose 文件",[14,644,645,646,649],{},"位于应用版本号目录下的",[49,647,648],{"code":648},"docker-compose.yml","文件，注意有格式要求，下面是示例",[42,651,652],{"id":652},"示例文件",[68,654,657],{"className":655,"code":656,"language":73},[71],"services:\n  ghost:\n    container_name: ${CONTAINER_NAME}\n    restart: always\n    networks:\n      - 1panel-network\n    ports:\n      - \"${PANEL_APP_PORT_HTTP}:2368\"\n    volumes:\n      - ./data:/var/lib/ghost/content\n    environment:\n      - database__client=${PANEL_DB_TYPE}\n      - database__connection__host=${PANEL_DB_HOST}\n      - database__connection__user=${PANEL_DB_USER}\n      - database__connection__password=${PANEL_DB_USER_PASSWORD}\n      - database__connection__database=${PANEL_DB_NAME}\n      - database__connection__port=${PANEL_DB_PORT}\n      - url=${GHOST_EXTERNAL_URL}\n    image: ghost:5.96.2\n    labels:\n      createdBy: \"Apps\"\n\nnetworks:\n  1panel-network:\n    external: true\n",[49,658,656],{"__ignoreMap":76},[42,660,661],{"id":661},"要求",[663,664,665,673,684,691,702,713,727,737],"ul",{},[666,667,668,669,672],"li",{},"头部没有",[49,670,671],{"code":671},"version","的变量，记得把它删去。",[666,674,675,676,679,680,683],{},"必须为应用定义",[49,677,678],{"code":678},"container_name","这个设置，且后面必须是",[49,681,682],{"code":682},"${CONTAINER_NAME}","，这样 1Panel 才能在安装时对其正确配置。",[666,685,686,687,690],{},"必须配置应用网络为",[49,688,689],{"code":689},"1panel-network","，这样应用之间才能正常互联，我在部分第三方应用商店库发现它们不是很注重这个，当然这事也可以视情况而论，但是建议是都在 1Panel 官方网络下。",[666,692,693,694,697,698,701],{},"端口",[49,695,696],{"code":696},"ports","这里设置也是必须为其默认定义的",[49,699,700],{"code":700},"${PANEL_APP_PORT_HTTP}:8090","这样的格式，这样 1Panel 才能正确设置应用的开放端口",[666,703,704,705,708,709,712],{},"文件尾部也必须跟示例文件一样，填写了",[49,706,707],{"code":707},"networks","配置，直接",[49,710,711],{"code":711},"Ctrl+C","过去就好。",[666,714,715,716,719,720,723,724,726],{},"应用的",[49,717,718],{"code":718},"image","镜像标签必须和文件夹表示的版本号一致，比如这个版本号文件夹写的是",[49,721,722],{"code":722},"5.96.2","，那么其文件内部",[49,725,718],{"code":718},"标签也必须那样写，不然会影响应用检测和安装更新！",[666,728,729,730,733,734,736],{},"记得填写上面的",[49,731,732],{"code":732},"labels","标签，直接",[49,735,711],{"code":711},"过去就行，当然这个也不算必填项，只是一种规范罢了。",[666,738,739,740,743],{},"记得为应用定义重启相关，比如",[49,741,742],{"code":742},"always","等等，这样保证应用在遇到问题后可以恢复（雾）",[10,745,746],{"id":746},"脚本",[42,748,749],{"id":749},"介绍",[14,751,752],{},"1Panel 在 安装之前、升级之前、卸载之后支持执行 .sh 脚本\n分别对应 init.sh upgrade.sh uninstall.sh\n存放目录 (以 halo 为例) : halo/2.2.0/scripts",[10,754,755],{"id":755},"本地测试",[14,757,758],{},"我十分建议你发布前先在自己已安装 1Panel 的服务器上进行测试，确定它是否可以正常安装",[14,760,761,762,765,766,769],{},"将应用目录上传到 1Panel 的",[49,763,764],{"code":764},"/opt/1panel/resource/apps/local","文件夹下\n注意：",[49,767,768],{"code":768},"/opt"," 为 1Panel 默认安装目录，请根据自己的实际情况修改\n上传完成后，目录结构如下：",[68,771,774],{"className":772,"code":773,"language":73},[71],"├──halo\n    ├── logo.png\n    ├── data.yml\n    ├── README.md\n    ├── 2.2.0\n     &nbsp;&nbsp; ├── data.yml\n     &nbsp;&nbsp; ├── data\n     &nbsp;&nbsp; └── docker-compose.yml\n",[49,775,773],{"__ignoreMap":76},[14,777,778],{},"在 1Panel 应用商店中，点击更新应用列表按钮同步本地应用。",[10,780,781],{"id":781},"收尾",[14,783,784],{},"测试正常后，你就可以去提交官方库或者第三方应用商店库了，或者你自己用，都可以，不过我还是建议你本着分享精神，把它提交到官方或其他第三方应用商店仓库里去。",[14,786,787],{},"官方的要求和拒绝率比较高，一般来说提交第三方仓库也挺好的，这里列举目前个人已知仓库：",[663,789,790,800],{},[666,791,792,799],{},[793,794,798],"a",{"href":795,"rel":796},"https://github.com/AuroraStarTeam/1panel-app-store",[797],"nofollow","AuroraStarTeam/1panel-app-store","，由我所属个人组织极光星进行维护，理念是干净整洁，但是个人经验可能不够丰富。",[666,801,802,807],{},[793,803,806],{"href":804,"rel":805},"https://github.com/okxlin/appstore",[797],"okxlin/appstore","，流行和最早的第三方商店库，应用很多，但是也很乱。",[10,809,811],{"id":810},"参考文档","参考文档：",[663,813,814],{},[666,815,816],{},[793,817,820],{"href":818,"rel":819},"https://github.com/1Panel-dev/appstore/wiki/%E5%A6%82%E4%BD%95%E6%8F%90%E4%BA%A4%E8%87%AA%E5%B7%B1%E6%83%B3%E8%A6%81%E7%9A%84%E5%BA%94%E7%94%A8",[797],"如何提交自己想要的应用（1Panel 官方应用商店仓库 Wiki）",{"title":76,"searchDepth":822,"depth":822,"links":823},4,[824,826,827,844,853,857,860,861,862],{"id":12,"depth":825,"text":12},2,{"id":34,"depth":825,"text":34},{"id":40,"depth":825,"text":40,"children":828},[829,831,832,833,834,835,836,837,838,839,840,841,842,843],{"id":44,"depth":830,"text":44},3,{"id":63,"depth":830,"text":63},{"id":79,"depth":830,"text":80},{"id":94,"depth":830,"text":94},{"id":113,"depth":830,"text":113},{"id":119,"depth":830,"text":119},{"id":125,"depth":830,"text":125},{"id":290,"depth":830,"text":291},{"id":297,"depth":830,"text":297},{"id":343,"depth":830,"text":344},{"id":350,"depth":830,"text":350},{"id":303,"depth":830,"text":303},{"id":365,"depth":830,"text":365},{"id":371,"depth":830,"text":371},{"id":377,"depth":825,"text":377,"children":845},[846,847,848,849,850,851,852],{"id":418,"depth":830,"text":418},{"id":431,"depth":830,"text":432},{"id":459,"depth":830,"text":113},{"id":474,"depth":830,"text":475},{"id":481,"depth":830,"text":481},{"id":491,"depth":830,"text":297},{"id":587,"depth":830,"text":587},{"id":641,"depth":825,"text":642,"children":854},[855,856],{"id":652,"depth":830,"text":652},{"id":661,"depth":830,"text":661},{"id":746,"depth":825,"text":746,"children":858},[859],{"id":749,"depth":830,"text":749},{"id":755,"depth":825,"text":755},{"id":781,"depth":825,"text":781},{"id":810,"depth":825,"text":811},[864],"技术探索","2024-10-17 19:24:26","本文介绍了如何为 1Panel 服务器面板编写并提交自定义应用包；本文记录了从目录结构、Logo、应用声明文件、版本参数表单，到符合规范的 docker-compose.yml 与本地测试的完整流程；本文分享了避开官方高门槛、直接 PR 第三方商店仓库的快捷路线，帮助读者把任意已容器化的开源项目一键搬进 1Panel 应用商店，实现图形化秒装。",false,"md",null,{},true,"/2024/10/write-1panel-app",{"text":874,"minutes":875,"time":876,"words":877},"20 min read",19.76,1185600,3952,{"title":5,"description":866},{"loc":872},"posts/2024/10/write-1panel-app",[882],"1Panel","f9Fp36Ezq3Qvw_3vYn4ECW5eHc6oX7VKxTtG6OA_6jg",[869,885],{"title":886,"path":887,"stem":888,"date":889,"type":869,"children":-1},"GitHub Action 构建 Shiroi Docker 镜像","/2024/10/shiroi-docker-deployment","posts/2024/10/shiroi-docker-deployment","2024-10-21 19:24:26",1761063796228]