[{"data":1,"prerenderedAt":1007},["ShallowReactive",2],{"global-music-player":3,"post-/2024/10/write-1panel-app":114,"surround-/2024/10/write-1panel-app":996},{"musicList":4,"error":113},[5,12,18,24,30,36,42,48,53,58,63,68,72,77,83,89,95,101,107],{"id":6,"title":7,"artist":8,"source":9,"url":10,"cover":11},"403010","Want To Be Close","川村ゆみ/アトラスサウンドチーム","netease","https://api.obdo.cc/meting/?server=netease&type=url&id=403010","https://p3.music.126.net/2QZtLwZhscppyPcH4qHAsw==/109951170737833679.jpg?param=90y90",{"id":13,"title":14,"artist":15,"source":9,"url":16,"cover":17},"2121025432","Full Moon, Full Life","Lotus Juice/高橋あず美","https://api.obdo.cc/meting/?server=netease&type=url&id=2121025432","https://p3.music.126.net/_RrQQv9o4QFB649P7cVmwg==/109951169287473362.jpg?param=90y90",{"id":19,"title":20,"artist":21,"source":9,"url":22,"cover":23},"760528","メグメル (cuckool Mix 2007)","eufonius","https://api.obdo.cc/meting/?server=netease&type=url&id=760528","https://p3.music.126.net/UVSTEnyyWfnQmhI5kqvvMQ==/109951170852620291.jpg?param=90y90",{"id":25,"title":26,"artist":27,"source":9,"url":28,"cover":29},"1484017181","Sofia","Álvaro Soler","https://api.obdo.cc/meting/?server=netease&type=url&id=1484017181","https://p3.music.126.net/Db50NT4VRJJPIBFYRMhdvQ==/109951165359298851.jpg?param=90y90",{"id":31,"title":32,"artist":33,"source":9,"url":34,"cover":35},"22706984","Étude pour les petites supercordes","戸越まごめ","https://api.obdo.cc/meting/?server=netease&type=url&id=22706984","https://p3.music.126.net/kkkPkRGflxLurhhKBbCmPg==/109951171268737495.jpg?param=90y90",{"id":37,"title":38,"artist":39,"source":9,"url":40,"cover":41},"1311319929","アルカテイル","鈴木このみ/VISUAL ARTS / Key","https://api.obdo.cc/meting/?server=netease&type=url&id=1311319929","https://p3.music.126.net/MVWKZCUCNQocuhMRBpL-Qw==/109951169976613728.jpg?param=90y90",{"id":43,"title":44,"artist":45,"source":9,"url":46,"cover":47},"2734259397","Utopia or Dystopia","夢乃ゆき","https://api.obdo.cc/meting/?server=netease&type=url&id=2734259397","https://p3.music.126.net/fgj1rPzHY_l63_jJ2Cg2uw==/109951171811747559.jpg?param=90y90",{"id":49,"title":50,"artist":51,"source":9,"url":52,"cover":23},"760533","だんご大家族","茶太/真理絵/くない瓜/Rio/Morrigan/藤枝あかね/加藤恒太","https://api.obdo.cc/meting/?server=netease&type=url&id=760533",{"id":54,"title":55,"artist":56,"source":9,"url":57,"cover":35},"22706980","渚","VISUAL ARTS / Key","https://api.obdo.cc/meting/?server=netease&type=url&id=22706980",{"id":59,"title":60,"artist":61,"source":9,"url":62,"cover":35},"22707008","潮鳴り","折戸伸治","https://api.obdo.cc/meting/?server=netease&type=url&id=22707008",{"id":64,"title":65,"artist":56,"source":9,"url":66,"cover":67},"1446832656","REFLECTION BLUE","https://api.obdo.cc/meting/?server=netease&type=url&id=1446832656","https://p3.music.126.net/9Z_HRqDjs2iBLz7_qqSPkg==/109951170197587239.jpg?param=90y90",{"id":69,"title":70,"artist":56,"source":9,"url":71,"cover":35},"22706979","汐","https://api.obdo.cc/meting/?server=netease&type=url&id=22706979",{"id":73,"title":74,"artist":75,"source":9,"url":76,"cover":67},"1446837300","しろはの子守歌","小原好美/VISUAL ARTS / Key","https://api.obdo.cc/meting/?server=netease&type=url&id=1446837300",{"id":78,"title":79,"artist":80,"source":9,"url":81,"cover":82},"1303019256","astral ability","橋本みゆき/佐咲紗花","https://api.obdo.cc/meting/?server=netease&type=url&id=1303019256","https://p3.music.126.net/YM3igu2abTjWdIfT_Gn5Lw==/109951163479574970.jpg?param=90y90",{"id":84,"title":85,"artist":86,"source":9,"url":87,"cover":88},"541492408","強がるオトナのSecret Labo","後藤麻衣","https://api.obdo.cc/meting/?server=netease&type=url&id=541492408","https://p3.music.126.net/KyQpNXO_3pvMwcgBhl0oGg==/109951163169040453.jpg?param=90y90",{"id":90,"title":91,"artist":92,"source":9,"url":93,"cover":94},"530057368","PERFECT GIRL","種崎敦美","https://api.obdo.cc/meting/?server=netease&type=url&id=530057368","https://p3.music.126.net/ZGqIyyu7ziQayjXIpID4qg==/109951163108870649.jpg?param=90y90",{"id":96,"title":97,"artist":98,"source":9,"url":99,"cover":100},"542058337","大和撫子はあこがれ","遥そら","https://api.obdo.cc/meting/?server=netease&type=url&id=542058337","https://p3.music.126.net/r4KRde43oriYxAgyD8-MOA==/109951163169043939.jpg?param=90y90",{"id":102,"title":103,"artist":104,"source":9,"url":105,"cover":106},"1958727599","明日への扉","高橋李依","https://api.obdo.cc/meting/?server=netease&type=url&id=1958727599","https://p3.music.126.net/fNvDL1E9IX-__sUBPhLAGw==/109951167585364773.jpg?param=90y90",{"id":108,"title":109,"artist":110,"source":9,"url":111,"cover":112},"1818615632","色香水","神山羊","https://api.obdo.cc/meting/?server=netease&type=url&id=1818615632","https://p3.music.126.net/z-GWtONkPJHkPS8G9v55qw==/109951166198068699.jpg?param=90y90",null,{"id":115,"title":116,"body":117,"categories":974,"date":976,"description":977,"draft":978,"extension":979,"hide-info":978,"image":113,"meta":980,"navigation":982,"path":983,"permalink":113,"published":113,"readingTime":984,"recommend":113,"references":113,"seo":989,"sitemap":990,"stem":991,"subtitle":113,"tags":992,"type":994,"updated":113,"__hash__":995},"content/posts/2024/10/write-1panel-app.md","编写1Panel应用商店第三方程序",{"type":118,"value":119,"toc":932},"minimark",[120,124,128,131,134,137,140,143,146,149,152,156,172,175,178,188,192,203,206,213,219,222,225,228,231,234,237,240,243,399,403,406,409,416,452,456,459,462,469,471,474,477,480,483,486,489,495,501,504,512,518,521,527,530,540,544,559,562,568,571,574,580,583,587,590,593,600,603,606,690,696,699,705,750,754,761,764,770,773,855,858,861,864,867,870,881,887,890,893,896,899,919,923],[121,122,123],"h2",{"id":123},"前言",[125,126,127],"p",{},"1Panel 是我目前在使用的一个服务器管理面板，它的社区版开源且免费，整体面板设计简洁快速，不需要登录，在基本体验上似乎是比隔壁宝塔要强一些。",[125,129,130],{},"不过他被很多小白和部分用户不喜爱的原因是它的应用是通过 Docker 容器化进行部署的。",[125,132,133],{},"采用 Docker 部署的坏处是应用整体内存占用会略高一些，而且配置容器组网是劝退很多小白的原因，配置不好，应用连不上数据库，网站反代不对等等。",[125,135,136],{},"但是 Docker 容器化部署的好处也是不少的，比如没有构建应用这一步，就使得应用在拉取完毕镜像以后即刻就能启动，就跟二进制应用文件差不多的感觉，不需要等上很久，也不需要太多服务器性能用于构建，在部署 Node.js 应用时效果尤为显著。而且配置文件简单，只需要了解 Docker Compose 配置文件格式就能上手，整体体验对于大规模部署是很好的。",[125,138,139],{},"当然 1Panel 也是知道小白们可能玩不明白 Docker 的，所以它还有应用商店，里面都是预先写好的 Docker Compose 文件模板，点击安装就能够一键部署，并且都自动为你做好网络设置，同时你还可以设计自己的应用上传到服务器，也可以一键安装，这样就出现了 1Panel 官方应用商店和第三方应用商店的存储库，只需要拉取仓库到服务器就能畅享海量应用。",[125,141,142],{},"实际上 1Panel 应用的结构很简单，只需要几个文件，就能够设计好你想部署的应用，今天我也来简单讲一下如何设计这个应用。",[121,144,145],{"id":145},"注意",[125,147,148],{},"值得注意的事情是，1Panel 应用商店的本质其实就是一个个 Docker Compose 编排文件的图形体现，所以实际上需要你的应用有公共可访问的 Docker 镜像才能正常使用。",[121,150,151],{"id":151},"格式",[153,154,155],"h3",{"id":155},"初始化模板",[125,157,158,159,163,164,167,168,171],{},"从",[160,161,162],"code",{"code":162},"1panel 1.3","及以上版本开始，可以在安装了 1Panel 的服务器使用",[160,165,166],{"code":166},"1panel app init \u003C应用的key> \u003C应用的版本>","指令来快速初始化应用模板文件（注意不是 ",[160,169,170],{"code":170},"1pctl","命令）",[153,173,174],{"id":174},"文件夹格式",[125,176,177],{},"应用的文件夹格式大概是长下面这个样子：",[179,180,185],"pre",{"className":181,"code":183,"language":184},[182],"language-text","├──halo // 承载应用的文件夹，这里以halo为例\n    ├── logo.png // 应用的 logo\n    ├── data.yml // 应用声明文件\n    ├── README.md // 应用的 README 文件\n    ├── 2.2.0 // 应用版本 注意不要以 v 开头\n    │&nbsp;&nbsp; ├── data.yml // 应用的参数配置，下面有详细介绍\n    │&nbsp;&nbsp; ├── data // 挂载出来的目录\n    |   ├── scripts // 脚本目录 存放 init.sh upgrade.sh uninstall.sh\n    │&nbsp;&nbsp; └── docker-compose.yml // docker-compose 文件\n    └── 2.3.2\n        ├── data.yml\n        ├── data\n        └── docker-compose.yml\n","text",[160,186,183],{"__ignoreMap":187},"",[153,189,191],{"id":190},"应用-logo","应用 Logo",[125,193,194,195,198,199,202],{},"用于在应用概览和应用详情页面展示，应用的 Logo 为 png 格式，长宽比最好是",[160,196,197],{"code":197},"180 * 180 px","，把它放在应用的根目录下，例如",[160,200,201],{"code":201},"/halo/logo.png","，不要使用诸如 webp，jpg，svg 这样的格式。",[153,204,205],{"id":205},"应用声明文件",[125,207,208,209,212],{},"声明你的应用的基本信息，让 1Panel 知道你的应用的一些基本信息，比如叫什么名字，干什么用的等等，是位于应用根目录下的",[160,210,211],{"code":211},"data.yml","文件，格式差不多如下：",[179,214,217],{"className":215,"code":216,"language":184},[182],"# 下边这一部分推荐填写，虽然 1Panel 的应用商店官方 Wiki 没有声明它到底有何用\nname: Halo\ntags:\n  - 建站\ntitle: 强大易用的开源建站工具\ntype: 建站\ndescription: 强大易用的开源建站工具\n# 下边这一部分为应用声明信息部分，注意填写正确！\nadditionalProperties:  #固定参数\n    key: halo   #应用的 key，仅限英文，用于在 Linux 创建文件夹\n    name: Halo  #应用名称\n    tags:\n        - WebSite #应用标签，可以有多个，请参照标签列表\n    shortDescZh: 强大易用的开源建站工具 #应用中文描述，不要超过 30 个字\n    shortDescEn: Powerful and easy-to-use open source website builder #应用英文描述\n    type: website  #应用类型，区别于应用分类，只能有一个，请参照下方的类型列表\n    crossVersionUpdate: true  #是否可以跨大版本升级\n    limit: 0  #应用安装数量限制，0 代表无限制\n    website: https://halo.run/  #应用的官网地址\n    github: https://github.com/halo-dev/halo #应用 GitHub 的仓库地址\n    document: https://docs.halo.run/ #应用的文档地址\n",[160,218,216],{"__ignoreMap":187},[125,220,221],{},"我们对必填应用声明信息部分从上往下进行详细的介绍：",[153,223,224],{"id":224},"key",[125,226,227],{},"诸如 halo 这样的名字，它其实就是你应用文件夹的名字，注意此处一定要与应用文件夹的名字保持一致，不然会导致应用无法正常部署安装。",[153,229,230],{"id":230},"name",[125,232,233],{},"应用的名称部分，用于 1Panel 商店列表中展示和应用详情上方展示，填写好了能提高应用的辨认度。",[153,235,236],{"id":236},"tags",[125,238,239],{},"应用的标签，决定了应用在应用商店所属的分类，可以填写多个。",[125,241,242],{},"标签列表和其对应的分类如下：",[244,245,246,267],"table",{},[247,248,249],"thead",{},[250,251,252,256,259,261,263,265],"tr",{},[253,254,255],"th",{},"值",[253,257,258],{},"所属分类",[253,260,255],{},[253,262,258],{},[253,264,255],{},[253,266,258],{},[268,269,270,291,311,328,346,364,381],"tbody",{},[250,271,272,276,279,282,285,288],{},[273,274,275],"td",{},"WebSite",[273,277,278],{},"建站",[273,280,281],{},"Storage",[273,283,284],{},"云存储",[273,286,287],{},"Email",[273,289,290],{},"邮件服务",[250,292,293,296,299,302,305,308],{},[273,294,295],{},"Server",[273,297,298],{},"Web 服务器",[273,300,301],{},"AI",[273,303,304],{},"AI/大模型",[273,306,307],{},"Game",[273,309,310],{},"休闲游戏",[250,312,313,316,319,322,324,326],{},[273,314,315],{},"Runtime",[273,317,318],{},"运行环境",[273,320,321],{},"BI",[273,323,321],{},[273,325],{},[273,327],{},[250,329,330,333,336,339,342,344],{},[273,331,332],{},"Database",[273,334,335],{},"数据库",[273,337,338],{},"Security",[273,340,341],{},"安全",[273,343],{},[273,345],{},[250,347,348,351,354,357,360,362],{},[273,349,350],{},"Tool",[273,352,353],{},"实用工具",[273,355,356],{},"DevTool",[273,358,359],{},"开发工具",[273,361],{},[273,363],{},[250,365,366,369,371,374,377,379],{},[273,367,368],{},"DevOps",[273,370,368],{},[273,372,373],{},"Middleware",[273,375,376],{},"中间件",[273,378],{},[273,380],{},[250,382,383,386,389,392,395,397],{},[273,384,385],{},"Local",[273,387,388],{},"本地",[273,390,391],{},"Media",[273,393,394],{},"多媒体",[273,396],{},[273,398],{},[153,400,402],{"id":401},"shortdesczhen","shortDescZh/En",[125,404,405],{},"应用的中文/英文描述，用于应用在应用商店列表中和应用详情页上方快速介绍应用，不要太长（中文不超过 30 字）",[153,407,408],{"id":408},"type",[125,410,411,412,415],{},"应用的用途分类，这里主要决定了 1Panel 会怎么对待你的应用，比如",[160,413,414],{"code":414},"website","类型的可以在其网站功能中一键进行反代和分配域名。",[244,417,418,427],{},[247,419,420],{},[250,421,422,424],{},[253,423,255],{},[253,425,426],{},"说明",[268,428,429,436,444],{},[250,430,431,433],{},[273,432,414],{},[273,434,435],{},"website 即网站应用程序类型，支持在网站中一键部署和反代，WordPress 和 Halo 都是此 type",[250,437,438,441],{},[273,439,440],{},"runtime",[273,442,443],{},"mysql openresty redis 等类型的应用，倾向于应用的关键运行环境",[250,445,446,449],{},[273,447,448],{},"tool",[273,450,451],{},"phpMyAdmin redis-commander jenkins 等类型的应用，倾向于应用的维护工具等",[153,453,455],{"id":454},"crossversionupdate","crossVersionUpdate",[125,457,458],{},"决定了应用是否可以跨大版本进行升级，一般来说都可以吧。",[153,460,461],{"id":461},"limit",[125,463,464,465,468],{},"决定了这个应用最多能部署多少个，一般为",[160,466,467],{"code":467},"0","无限制，但是有些应用它确实不能重复安装，比如 Openresty 这样的反向代理服务。",[153,470,414],{"id":414},[125,472,473],{},"应用的官网地址，但不是所有应用都有官网地址，如果真没有那就填写应用的 Github 仓库地址吧，本质上就是一个联系地址",[153,475,476],{"id":476},"github",[125,478,479],{},"应用的 Github 仓库地址，本质上提交到 1Panel 应用商店的应用都是开源应用，所以一般都有这么个开源地址，你本地定制可以按情况来。",[153,481,482],{"id":482},"document",[125,484,485],{},"应用的使用文档地址，按需填写吧，不是所有应用都有完善的使用文档。",[121,487,488],{"id":488},"应用参数配置文件",[125,490,491,492,494],{},"它也是",[160,493,211],{"code":211},"，但是它在应用的版本号目录下，注意不要和应用声明文件搞混了。",[496,497,498],"blockquote",{},[125,499,500],{},"本文件主要用于生成安装时要填写的 form 表单，在应用版本文件夹下面 可以无表单，但是需要有这个 data.yml 文件，并且包含 formFields 字段。\n@1Panel 应用商店仓库官方 Wiki",[125,502,503],{},"以 Halo 的 Form 表单为例：",[125,505,506,511],{},[507,508],"img",{"alt":509,"src":510},"Halo 安装表单示例图（来自 1Panel 官方应用商店仓库）","https://user-images.githubusercontent.com/31820853/226111412-9c7b25a1-83f2-4621-8789-7ef85a2695dd.png","\n如果要生成一个上面这样子的表单，你需要这么填写应用参数配置文件（来自官方 Wiki 示例）：",[179,513,516],{"className":514,"code":515,"language":184},[182],"additionalProperties:  #固定参数\n    formFields:\n        - default: \"\"\n          envKey: PANEL_DB_HOST  #docker-compose 文件中的参数\n          key: mysql  #依赖应用的 key , 例如 mysql\n          labelEn: Database Service  #英文的 label\n          labelZh: 数据库服务  #中文的 label\n          required: true  #是否必填\n          type: service  #如果需要依赖其他应用，例如数据库，使用此 type\n        - default: halo\n          envKey: PANEL_DB_NAME\n          labelEn: Database\n          labelZh: 数据库名\n          random: true  #是否在 default 文字后面，增加随机字符串\n          required: true\n          rule: paramCommon  #校验规则\n          type: text  #需要手动填写的，使用此 type\n        - default: halo\n          envKey: PANEL_DB_USER\n          labelEn: User\n          labelZh: 数据库用户\n          random: true\n          required: true\n          rule: paramCommon\n          type: text\n        - default: halo\n          envKey: PANEL_DB_USER_PASSWORD\n          labelEn: Password\n          labelZh: 数据库用户密码\n          random: true\n          required: true\n          rule: paramComplexity\n          type: password  #密码字段使用此 type\n        - default: admin\n          envKey: HALO_ADMIN\n          labelEn: Admin Username\n          labelZh: 超级管理员用户名\n          required: true\n          rule: paramCommon\n          type: text\n        - default: halo\n          envKey: HALO_ADMIN_PASSWORD\n          labelEn: Admin Password\n          labelZh: 超级管理员密码\n          random: true\n          required: true\n          rule: paramComplexity\n          type: password\n        - default: http://localhost:8080\n          edit: true\n          envKey: HALO_EXTERNAL_URL\n          labelEn: External URL\n          labelZh: 外部访问地址\n          required: true\n          rule: paramExtUrl\n          type: text\n        - default: 8080\n          edit: true\n          envKey: PANEL_APP_PORT_HTTP\n          labelEn: Port\n          labelZh: 端口\n          required: true\n          rule: paramPort\n          type: number #端口使用此 type\n",[160,517,515],{"__ignoreMap":187},[125,519,520],{},"是不是看的眼晕了，我们这里拆出来解释下它这个东西：",[179,522,525],{"className":523,"code":524,"language":184},[182],"        - default: \"\"\n          envKey: PANEL_DB_HOST  #docker-compose 文件中的参数\n          key: mysql  #依赖应用的 key , 例如 mysql\n          labelEn: Database Service  #英文的 label\n          labelZh: 数据库服务  #中文的 label\n          required: true  #是否必填\n          type: service  #如果需要依赖其他应用，例如数据库，使用此 type\n",[160,526,524],{"__ignoreMap":187},[153,528,529],{"id":529},"dafault",[125,531,532,533,536,537,539],{},"应用这个变量值的默认格式，填写上什么应用的设置变量默认就会填写什么东西，比如说你要设置这个应用的默认前端站点是",[160,534,535],{"code":535},"example.com","就在这里这样填写上它，应用就会默认把",[160,538,535],{"code":535},"做前端默认站点值。",[153,541,543],{"id":542},"envkey","envKey",[125,545,546,547,550,551,554,555,558],{},"对应了你的应用的 compose 编排文件中环境变量设置部分，比如",[160,548,549],{"code":549},"environment","下的值，但其实简单点说就是会传递一个变量值给文件，比如",[160,552,553],{"code":553},"HOST","变量可以在 compose 文件中通过",[160,556,557],{"code":557},"${HOST}","来引用它，不难理解吧。",[125,560,561],{},"譬如在如下 Halo 例子中的引用：",[179,563,566],{"className":564,"code":565,"language":184},[182],"services:\n  halo:\n    image: halohub/halo:2.2.0\n    container_name: ${CONTAINER_NAME}\n    restart: always\n    networks:\n      - 1panel-network\n    volumes:\n      - ./data:/root/.halo2\n    ports:\n      - ${PANEL_APP_PORT_HTTP}:8090\n    command:\n      - --spring.r2dbc.url=r2dbc:pool:${HALO_PLATFORM}://${PANEL_DB_HOST}:${HALO_DB_PORT}/${PANEL_DB_NAME}\n      - --spring.r2dbc.username=${PANEL_DB_USER}\n      - --spring.r2dbc.password=${PANEL_DB_USER_PASSWORD}\n      - --spring.sql.init.platform=${HALO_PLATFORM}\n      - --halo.external-url=${HALO_EXTERNAL_URL}\n      - --halo.security.initializer.superadminusername=${HALO_ADMIN}\n      - --halo.security.initializer.superadminpassword=${HALO_ADMIN_PASSWORD}\n    labels:\n      createdBy: \"Apps\"\n\nnetworks:\n  1panel-network:\n    external: true\n",[160,567,565],{"__ignoreMap":187},[153,569,224],{"id":570},"key-1",[125,572,573],{},"这个虽然出现在了 1Panel 的官方 Wiki 示例中，但是似乎实际他们已经弃用这样写了，部分应用会依赖其他服务，比如 Halo 会有依赖 MySQL 数据库，这个时候你就在这里填写上它就能去引用它，1Panel 给的这个例子有点旧，我们使用下面的格式来实现引用外部数据库：",[179,575,578],{"className":576,"code":577,"language":184},[182],"        - child:\n            default: \"\"\n            envKey: PANEL_DB_HOST\n            required: true\n            type: service\n          default: mysql\n          envKey: PANEL_DB_TYPE\n          labelEn: Database Service\n          labelZh: 数据库服务\n          required: true\n          type: apps\n          values:\n            - label: MySQL\n              value: mysql\n            - label: MariaDB\n              value: mariadb\n",[160,579,577],{"__ignoreMap":187},[125,581,582],{},"这样你就可以为你的应用接入选择数据库的方式了，但是我也不是很懂这个，实际写起来直接 Ctrl+C 其他已实现接入外部数据库的应用范例似乎是个好办法。",[153,584,586],{"id":585},"labelenzh","labelEn/Zh",[125,588,589],{},"这个我感觉并不需要过多的介绍，已经在上面写的比较明白了，应用这个项的中英文描述。",[153,591,592],{"id":592},"required",[125,594,595,596,599],{},"决定这个变量值是否是必填的，在它为",[160,597,598],{"code":598},"true","的情况下不填写它是不能继续安装的，你可以视情况决定这个东西。",[153,601,408],{"id":602},"type-1",[125,604,605],{},"看着似乎表格很明白但实际写起来还是挺头疼的东西，自己按表格查询吧，我自己也对这个东西非常头疼，差不多它的设定决定了你的应用这个设置变量只能填什么东西。",[244,607,608,616],{},[247,609,610],{},[250,611,612,614],{},[253,613,255],{},[253,615,426],{},[268,617,618,633,644,654,665,683],{},[250,619,620,623],{},[273,621,622],{},"service",[273,624,625,628,629,632],{},[160,626,627],{"code":627},"type: service"," 如果该应用需要依赖其他组件，如 mysql redis 等，可以通过 ",[160,630,631],{"code":631},"key: mysql"," 定义依赖的名称，在创建应用时会要求先创建依赖的应用。",[250,634,635,638],{},[273,636,637],{},"password",[273,639,640,643],{},[160,641,642],{"code":642},"type: password"," 敏感信息，如密码相关的字段会默认不显示明文。",[250,645,646,648],{},[273,647,184],{},[273,649,650,653],{},[160,651,652],{"code":652},"type: text"," 一般内容，比如数据库名称，默认明文显示。",[250,655,656,659],{},[273,657,658],{},"number",[273,660,661,664],{},[160,662,663],{"code":663},"type: number"," 一般用在端口相关的配置上，只允许输入数字。",[250,666,667,670],{},[273,668,669],{},"select",[273,671,672,675,676,678,679,682],{},[160,673,674],{"code":674},"type: select"," 选项，比如 ",[160,677,598],{"code":598},", ",[160,680,681],{"code":681},"false","，日志等级等。",[250,684,685,688],{},[273,686,687],{},"通过官方给的下方的例子对照查询了解：",[273,689],{},[179,691,694],{"className":692,"code":693,"language":184},[182],"# type: service，定义一个 mysql 的 service 依赖。\n- default: \"\"\n    envKey: DB_HOST\n    key: mysql\n    labelEn: Database Service\n    labelZh: 数据库服务\n    required: true\n    type: service\n\n# type: password\n- default: Np2qgqtiUayA857GpuVI0Wtg\n    edit: true\n    envKey: DB_PASSWORD\n    labelEn: Database password\n    labelZh: 数据库密码\n    required: true\n    type: password\n\n# type: text\n- default: 192.168.100.100\n    disabled: true.\n    envKey: REDIS_HOST\n    labelEn: Redis host\n    labelZh: Redis 主机\n    type: text\n\n# type: number\n- default: 3306\n    disabled: true\n    envKey: DB_PORT\n    labelEn: Database port\n    labelZh: 数据库端口\n    rule: paramPort\n    type: number\n\n# type: select\n- default: \"ERROR\"\n    envKey: LOG_LEVEL\n    labelEn: Log level\n    labelZh: 日志级别\n    required: true\n    type: select\n    values:\n        - label: DEBUG\n          value: \"DEBUG\"\n        - label: INFO\n          value: \"INFO\"\n        - label: WARNING\n          value: \"WARNING\"\n        - label: ERROR\n          value: \"ERROR\"\n        - label: CRITICAL\n          value: \"CRITICAL\"\n",[160,695,693],{"__ignoreMap":187},[153,697,698],{"id":698},"rule",[125,700,701,702,704],{},"在上面的例子中部分登场，主要是校验用户是否书写这个东西的格式是正确的，比如防止某些用户在端口设置这里填写域名的东西，这个",[160,703,698],{"code":698},"就会强制这个填写栏必须填写什么格式。",[244,706,707,716],{},[247,708,709],{},[250,710,711,713],{},[253,712,255],{},[253,714,715],{},"规则",[268,717,718,726,734,742],{},[250,719,720,723],{},[273,721,722],{},"paramPort",[273,724,725],{},"用于限制端口范围为 1-65535",[250,727,728,731],{},[273,729,730],{},"paramExtUrl",[273,732,733],{},"格式为 http(s)://(域名/ip):(端口)",[250,735,736,739],{},[273,737,738],{},"paramCommon",[273,740,741],{},"英文、数字、.-和_，长度 2-30",[250,743,744,747],{},[273,745,746],{},"paramComplexity",[273,748,749],{},"支持英文、数字、.%@$!&~_-,长度 6-30，特殊字符不能在首尾",[121,751,753],{"id":752},"应用-compose-文件","应用 Compose 文件",[125,755,756,757,760],{},"位于应用版本号目录下的",[160,758,759],{"code":759},"docker-compose.yml","文件，注意有格式要求，下面是示例",[153,762,763],{"id":763},"示例文件",[179,765,768],{"className":766,"code":767,"language":184},[182],"services:\n  ghost:\n    container_name: ${CONTAINER_NAME}\n    restart: always\n    networks:\n      - 1panel-network\n    ports:\n      - \"${PANEL_APP_PORT_HTTP}:2368\"\n    volumes:\n      - ./data:/var/lib/ghost/content\n    environment:\n      - database__client=${PANEL_DB_TYPE}\n      - database__connection__host=${PANEL_DB_HOST}\n      - database__connection__user=${PANEL_DB_USER}\n      - database__connection__password=${PANEL_DB_USER_PASSWORD}\n      - database__connection__database=${PANEL_DB_NAME}\n      - database__connection__port=${PANEL_DB_PORT}\n      - url=${GHOST_EXTERNAL_URL}\n    image: ghost:5.96.2\n    labels:\n      createdBy: \"Apps\"\n\nnetworks:\n  1panel-network:\n    external: true\n",[160,769,767],{"__ignoreMap":187},[153,771,772],{"id":772},"要求",[774,775,776,784,795,802,813,824,838,848],"ul",{},[777,778,779,780,783],"li",{},"头部没有",[160,781,782],{"code":782},"version","的变量，记得把它删去。",[777,785,786,787,790,791,794],{},"必须为应用定义",[160,788,789],{"code":789},"container_name","这个设置，且后面必须是",[160,792,793],{"code":793},"${CONTAINER_NAME}","，这样 1Panel 才能在安装时对其正确配置。",[777,796,797,798,801],{},"必须配置应用网络为",[160,799,800],{"code":800},"1panel-network","，这样应用之间才能正常互联，我在部分第三方应用商店库发现它们不是很注重这个，当然这事也可以视情况而论，但是建议是都在 1Panel 官方网络下。",[777,803,804,805,808,809,812],{},"端口",[160,806,807],{"code":807},"ports","这里设置也是必须为其默认定义的",[160,810,811],{"code":811},"${PANEL_APP_PORT_HTTP}:8090","这样的格式，这样 1Panel 才能正确设置应用的开放端口",[777,814,815,816,819,820,823],{},"文件尾部也必须跟示例文件一样，填写了",[160,817,818],{"code":818},"networks","配置，直接",[160,821,822],{"code":822},"Ctrl+C","过去就好。",[777,825,826,827,830,831,834,835,837],{},"应用的",[160,828,829],{"code":829},"image","镜像标签必须和文件夹表示的版本号一致，比如这个版本号文件夹写的是",[160,832,833],{"code":833},"5.96.2","，那么其文件内部",[160,836,829],{"code":829},"标签也必须那样写，不然会影响应用检测和安装更新！",[777,839,840,841,844,845,847],{},"记得填写上面的",[160,842,843],{"code":843},"labels","标签，直接",[160,846,822],{"code":822},"过去就行，当然这个也不算必填项，只是一种规范罢了。",[777,849,850,851,854],{},"记得为应用定义重启相关，比如",[160,852,853],{"code":853},"always","等等，这样保证应用在遇到问题后可以恢复（雾）",[121,856,857],{"id":857},"脚本",[153,859,860],{"id":860},"介绍",[125,862,863],{},"1Panel 在 安装之前、升级之前、卸载之后支持执行 .sh 脚本\n分别对应 init.sh upgrade.sh uninstall.sh\n存放目录 (以 halo 为例) : halo/2.2.0/scripts",[121,865,866],{"id":866},"本地测试",[125,868,869],{},"我十分建议你发布前先在自己已安装 1Panel 的服务器上进行测试，确定它是否可以正常安装",[125,871,872,873,876,877,880],{},"将应用目录上传到 1Panel 的",[160,874,875],{"code":875},"/opt/1panel/resource/apps/local","文件夹下\n注意：",[160,878,879],{"code":879},"/opt"," 为 1Panel 默认安装目录，请根据自己的实际情况修改\n上传完成后，目录结构如下：",[179,882,885],{"className":883,"code":884,"language":184},[182],"├──halo\n    ├── logo.png\n    ├── data.yml\n    ├── README.md\n    ├── 2.2.0\n     &nbsp;&nbsp; ├── data.yml\n     &nbsp;&nbsp; ├── data\n     &nbsp;&nbsp; └── docker-compose.yml\n",[160,886,884],{"__ignoreMap":187},[125,888,889],{},"在 1Panel 应用商店中，点击更新应用列表按钮同步本地应用。",[121,891,892],{"id":892},"收尾",[125,894,895],{},"测试正常后，你就可以去提交官方库或者第三方应用商店库了，或者你自己用，都可以，不过我还是建议你本着分享精神，把它提交到官方或其他第三方应用商店仓库里去。",[125,897,898],{},"官方的要求和拒绝率比较高，一般来说提交第三方仓库也挺好的，这里列举目前个人已知仓库：",[774,900,901,911],{},[777,902,903,910],{},[904,905,909],"a",{"href":906,"rel":907},"https://github.com/AuroraStarTeam/1panel-app-store",[908],"nofollow","AuroraStarTeam/1panel-app-store","，由我所属个人组织极光星进行维护，理念是干净整洁，但是个人经验可能不够丰富。",[777,912,913,918],{},[904,914,917],{"href":915,"rel":916},"https://github.com/okxlin/appstore",[908],"okxlin/appstore","，流行和最早的第三方商店库，应用很多，但是也很乱。",[121,920,922],{"id":921},"参考文档","参考文档：",[774,924,925],{},[777,926,927],{},[904,928,931],{"href":929,"rel":930},"https://github.com/1Panel-dev/appstore/wiki/%E5%A6%82%E4%BD%95%E6%8F%90%E4%BA%A4%E8%87%AA%E5%B7%B1%E6%83%B3%E8%A6%81%E7%9A%84%E5%BA%94%E7%94%A8",[908],"如何提交自己想要的应用（1Panel 官方应用商店仓库 Wiki）",{"title":187,"searchDepth":933,"depth":933,"links":934},4,[935,937,938,955,964,968,971,972,973],{"id":123,"depth":936,"text":123},2,{"id":145,"depth":936,"text":145},{"id":151,"depth":936,"text":151,"children":939},[940,942,943,944,945,946,947,948,949,950,951,952,953,954],{"id":155,"depth":941,"text":155},3,{"id":174,"depth":941,"text":174},{"id":190,"depth":941,"text":191},{"id":205,"depth":941,"text":205},{"id":224,"depth":941,"text":224},{"id":230,"depth":941,"text":230},{"id":236,"depth":941,"text":236},{"id":401,"depth":941,"text":402},{"id":408,"depth":941,"text":408},{"id":454,"depth":941,"text":455},{"id":461,"depth":941,"text":461},{"id":414,"depth":941,"text":414},{"id":476,"depth":941,"text":476},{"id":482,"depth":941,"text":482},{"id":488,"depth":936,"text":488,"children":956},[957,958,959,960,961,962,963],{"id":529,"depth":941,"text":529},{"id":542,"depth":941,"text":543},{"id":570,"depth":941,"text":224},{"id":585,"depth":941,"text":586},{"id":592,"depth":941,"text":592},{"id":602,"depth":941,"text":408},{"id":698,"depth":941,"text":698},{"id":752,"depth":936,"text":753,"children":965},[966,967],{"id":763,"depth":941,"text":763},{"id":772,"depth":941,"text":772},{"id":857,"depth":936,"text":857,"children":969},[970],{"id":860,"depth":941,"text":860},{"id":866,"depth":936,"text":866},{"id":892,"depth":936,"text":892},{"id":921,"depth":936,"text":922},[975],"技术探索","2024-10-17T19:24:26","本文介绍了如何为 1Panel 服务器面板编写并提交自定义应用包；本文记录了从目录结构、Logo、应用声明文件、版本参数表单，到符合规范的 docker-compose.yml 与本地测试的完整流程；本文分享了避开官方高门槛、直接 PR 第三方商店仓库的快捷路线，帮助读者把任意已容器化的开源项目一键搬进 1Panel 应用商店，实现图形化秒装。",false,"md",{"slots":981},{},true,"/2024/10/write-1panel-app",{"text":985,"minutes":986,"time":987,"words":988},"20 min read",19.76,1185600,3952,{"title":116,"description":977},{"loc":983},"posts/2024/10/write-1panel-app",[993],"1Panel","tech","2HWNcWupQheyhx7G53Q-UTIgwJNPTPMMIvSzgZATF0Y",[997,1002],{"title":998,"path":999,"stem":1000,"date":1001,"type":994,"children":-1},"记一次被1Panel官方应用商店拒绝合并","/2024/09/1panel-appstore-refused","posts/2024/09/1panel-appstore-refused","2024-09-07T19:24:26",{"title":1003,"path":1004,"stem":1005,"date":1006,"type":994,"children":-1},"GitHub Action 构建 Shiroi Docker 镜像","/2024/10/shiroi-docker-deployment","posts/2024/10/shiroi-docker-deployment","2024-10-21T19:24:26",1768199114003]