[{"data":1,"prerenderedAt":994},["ShallowReactive",2],{"global-music-player":3,"post-/2024/10/write-1panel-app":102,"surround-/2024/10/write-1panel-app":983},{"musicList":4,"error":101},[5,12,18,24,30,36,41,46,51,56,60,65,71,77,83,89,95],{"id":6,"title":7,"artist":8,"source":9,"url":10,"cover":11},"760528","メグメル (cuckool Mix 2007)","eufonius","netease","https://api.obdo.cc/meting/?server=netease&type=url&id=760528","https://p3.music.126.net/UVSTEnyyWfnQmhI5kqvvMQ==/109951170852620291.jpg?param=90y90",{"id":13,"title":14,"artist":15,"source":9,"url":16,"cover":17},"1484017181","Sofia","Álvaro Soler","https://api.obdo.cc/meting/?server=netease&type=url&id=1484017181","https://p3.music.126.net/Db50NT4VRJJPIBFYRMhdvQ==/109951165359298851.jpg?param=90y90",{"id":19,"title":20,"artist":21,"source":9,"url":22,"cover":23},"22706984","Étude pour les petites supercordes","戸越まごめ","https://api.obdo.cc/meting/?server=netease&type=url&id=22706984","https://p3.music.126.net/kkkPkRGflxLurhhKBbCmPg==/109951171268737495.jpg?param=90y90",{"id":25,"title":26,"artist":27,"source":9,"url":28,"cover":29},"1311319929","アルカテイル","鈴木このみ/VISUAL ARTS / Key","https://api.obdo.cc/meting/?server=netease&type=url&id=1311319929","https://p3.music.126.net/MVWKZCUCNQocuhMRBpL-Qw==/109951169976613728.jpg?param=90y90",{"id":31,"title":32,"artist":33,"source":9,"url":34,"cover":35},"2734259397","Utopia or Dystopia","夢乃ゆき","https://api.obdo.cc/meting/?server=netease&type=url&id=2734259397","https://p3.music.126.net/fgj1rPzHY_l63_jJ2Cg2uw==/109951171811747559.jpg?param=90y90",{"id":37,"title":38,"artist":39,"source":9,"url":40,"cover":11},"760533","だんご大家族","茶太/真理絵/くない瓜/Rio/Morrigan/藤枝あかね/加藤恒太","https://api.obdo.cc/meting/?server=netease&type=url&id=760533",{"id":42,"title":43,"artist":44,"source":9,"url":45,"cover":23},"22706980","渚","VISUAL ARTS / Key","https://api.obdo.cc/meting/?server=netease&type=url&id=22706980",{"id":47,"title":48,"artist":49,"source":9,"url":50,"cover":23},"22707008","潮鳴り","折戸伸治","https://api.obdo.cc/meting/?server=netease&type=url&id=22707008",{"id":52,"title":53,"artist":44,"source":9,"url":54,"cover":55},"1446832656","REFLECTION BLUE","https://api.obdo.cc/meting/?server=netease&type=url&id=1446832656","https://p3.music.126.net/9Z_HRqDjs2iBLz7_qqSPkg==/109951170197587239.jpg?param=90y90",{"id":57,"title":58,"artist":44,"source":9,"url":59,"cover":23},"22706979","汐","https://api.obdo.cc/meting/?server=netease&type=url&id=22706979",{"id":61,"title":62,"artist":63,"source":9,"url":64,"cover":55},"1446837300","しろはの子守歌","小原好美/VISUAL ARTS / Key","https://api.obdo.cc/meting/?server=netease&type=url&id=1446837300",{"id":66,"title":67,"artist":68,"source":9,"url":69,"cover":70},"1303019256","astral ability","橋本みゆき/佐咲紗花","https://api.obdo.cc/meting/?server=netease&type=url&id=1303019256","https://p3.music.126.net/YM3igu2abTjWdIfT_Gn5Lw==/109951163479574970.jpg?param=90y90",{"id":72,"title":73,"artist":74,"source":9,"url":75,"cover":76},"541492408","強がるオトナのSecret Labo","後藤麻衣","https://api.obdo.cc/meting/?server=netease&type=url&id=541492408","https://p3.music.126.net/KyQpNXO_3pvMwcgBhl0oGg==/109951163169040453.jpg?param=90y90",{"id":78,"title":79,"artist":80,"source":9,"url":81,"cover":82},"530057368","PERFECT GIRL","種崎敦美","https://api.obdo.cc/meting/?server=netease&type=url&id=530057368","https://p3.music.126.net/ZGqIyyu7ziQayjXIpID4qg==/109951163108870649.jpg?param=90y90",{"id":84,"title":85,"artist":86,"source":9,"url":87,"cover":88},"542058337","大和撫子はあこがれ","遥そら","https://api.obdo.cc/meting/?server=netease&type=url&id=542058337","https://p3.music.126.net/r4KRde43oriYxAgyD8-MOA==/109951163169043939.jpg?param=90y90",{"id":90,"title":91,"artist":92,"source":9,"url":93,"cover":94},"1958727599","明日への扉","高橋李依","https://api.obdo.cc/meting/?server=netease&type=url&id=1958727599","https://p3.music.126.net/fNvDL1E9IX-__sUBPhLAGw==/109951167585364773.jpg?param=90y90",{"id":96,"title":97,"artist":98,"source":9,"url":99,"cover":100},"1818615632","色香水","神山羊","https://api.obdo.cc/meting/?server=netease&type=url&id=1818615632","https://p3.music.126.net/z-GWtONkPJHkPS8G9v55qw==/109951166198068699.jpg?param=90y90",null,{"id":103,"title":104,"body":105,"categories":962,"date":964,"description":965,"draft":966,"extension":967,"hide-info":966,"image":101,"meta":968,"navigation":969,"path":970,"permalink":101,"readingTime":971,"recommend":101,"references":101,"seo":976,"sitemap":977,"stem":978,"subtitle":101,"tags":979,"type":981,"updated":101,"__hash__":982},"content/posts/2024/10/write-1panel-app.md","编写1Panel应用商店第三方程序",{"type":106,"value":107,"toc":920},"minimark",[108,112,116,119,122,125,128,131,134,137,140,144,160,163,166,176,180,191,194,201,207,210,213,216,219,222,225,228,231,387,391,394,397,404,440,444,447,450,457,459,462,465,468,471,474,477,483,489,492,500,506,509,515,518,528,532,547,550,556,559,562,568,571,575,578,581,588,591,594,678,684,687,693,738,742,749,752,758,761,843,846,849,852,855,858,869,875,878,881,884,887,907,911],[109,110,111],"h2",{"id":111},"前言",[113,114,115],"p",{},"1Panel 是我目前在使用的一个服务器管理面板，它的社区版开源且免费，整体面板设计简洁快速，不需要登录，在基本体验上似乎是比隔壁宝塔要强一些。",[113,117,118],{},"不过他被很多小白和部分用户不喜爱的原因是它的应用是通过 Docker 容器化进行部署的。",[113,120,121],{},"采用 Docker 部署的坏处是应用整体内存占用会略高一些，而且配置容器组网是劝退很多小白的原因，配置不好，应用连不上数据库，网站反代不对等等。",[113,123,124],{},"但是 Docker 容器化部署的好处也是不少的，比如没有构建应用这一步，就使得应用在拉取完毕镜像以后即刻就能启动，就跟二进制应用文件差不多的感觉，不需要等上很久，也不需要太多服务器性能用于构建，在部署 Node.js 应用时效果尤为显著。而且配置文件简单，只需要了解 Docker Compose 配置文件格式就能上手，整体体验对于大规模部署是很好的。",[113,126,127],{},"当然 1Panel 也是知道小白们可能玩不明白 Docker 的，所以它还有应用商店，里面都是预先写好的 Docker Compose 文件模板，点击安装就能够一键部署，并且都自动为你做好网络设置，同时你还可以设计自己的应用上传到服务器，也可以一键安装，这样就出现了 1Panel 官方应用商店和第三方应用商店的存储库，只需要拉取仓库到服务器就能畅享海量应用。",[113,129,130],{},"实际上 1Panel 应用的结构很简单，只需要几个文件，就能够设计好你想部署的应用，今天我也来简单讲一下如何设计这个应用。",[109,132,133],{"id":133},"注意",[113,135,136],{},"值得注意的事情是，1Panel 应用商店的本质其实就是一个个 Docker Compose 编排文件的图形体现，所以实际上需要你的应用有公共可访问的 Docker 镜像才能正常使用。",[109,138,139],{"id":139},"格式",[141,142,143],"h3",{"id":143},"初始化模板",[113,145,146,147,151,152,155,156,159],{},"从",[148,149,150],"code",{"code":150},"1panel 1.3","及以上版本开始，可以在安装了 1Panel 的服务器使用",[148,153,154],{"code":154},"1panel app init \u003C应用的key> \u003C应用的版本>","指令来快速初始化应用模板文件（注意不是 ",[148,157,158],{"code":158},"1pctl","命令）",[141,161,162],{"id":162},"文件夹格式",[113,164,165],{},"应用的文件夹格式大概是长下面这个样子：",[167,168,173],"pre",{"className":169,"code":171,"language":172},[170],"language-text","├──halo // 承载应用的文件夹，这里以halo为例\n    ├── logo.png // 应用的 logo\n    ├── data.yml // 应用声明文件\n    ├── README.md // 应用的 README 文件\n    ├── 2.2.0 // 应用版本 注意不要以 v 开头\n    │&nbsp;&nbsp; ├── data.yml // 应用的参数配置，下面有详细介绍\n    │&nbsp;&nbsp; ├── data // 挂载出来的目录\n    |   ├── scripts // 脚本目录 存放 init.sh upgrade.sh uninstall.sh\n    │&nbsp;&nbsp; └── docker-compose.yml // docker-compose 文件\n    └── 2.3.2\n        ├── data.yml\n        ├── data\n        └── docker-compose.yml\n","text",[148,174,171],{"__ignoreMap":175},"",[141,177,179],{"id":178},"应用-logo","应用 Logo",[113,181,182,183,186,187,190],{},"用于在应用概览和应用详情页面展示，应用的 Logo 为 png 格式，长宽比最好是",[148,184,185],{"code":185},"180 * 180 px","，把它放在应用的根目录下，例如",[148,188,189],{"code":189},"/halo/logo.png","，不要使用诸如 webp，jpg，svg 这样的格式。",[141,192,193],{"id":193},"应用声明文件",[113,195,196,197,200],{},"声明你的应用的基本信息，让 1Panel 知道你的应用的一些基本信息，比如叫什么名字，干什么用的等等，是位于应用根目录下的",[148,198,199],{"code":199},"data.yml","文件，格式差不多如下：",[167,202,205],{"className":203,"code":204,"language":172},[170],"# 下边这一部分推荐填写，虽然 1Panel 的应用商店官方 Wiki 没有声明它到底有何用\nname: Halo\ntags:\n  - 建站\ntitle: 强大易用的开源建站工具\ntype: 建站\ndescription: 强大易用的开源建站工具\n# 下边这一部分为应用声明信息部分，注意填写正确！\nadditionalProperties:  #固定参数\n    key: halo   #应用的 key，仅限英文，用于在 Linux 创建文件夹\n    name: Halo  #应用名称\n    tags:\n        - WebSite #应用标签，可以有多个，请参照标签列表\n    shortDescZh: 强大易用的开源建站工具 #应用中文描述，不要超过 30 个字\n    shortDescEn: Powerful and easy-to-use open source website builder #应用英文描述\n    type: website  #应用类型，区别于应用分类，只能有一个，请参照下方的类型列表\n    crossVersionUpdate: true  #是否可以跨大版本升级\n    limit: 0  #应用安装数量限制，0 代表无限制\n    website: https://halo.run/  #应用的官网地址\n    github: https://github.com/halo-dev/halo #应用 GitHub 的仓库地址\n    document: https://docs.halo.run/ #应用的文档地址\n",[148,206,204],{"__ignoreMap":175},[113,208,209],{},"我们对必填应用声明信息部分从上往下进行详细的介绍：",[141,211,212],{"id":212},"key",[113,214,215],{},"诸如 halo 这样的名字，它其实就是你应用文件夹的名字，注意此处一定要与应用文件夹的名字保持一致，不然会导致应用无法正常部署安装。",[141,217,218],{"id":218},"name",[113,220,221],{},"应用的名称部分，用于 1Panel 商店列表中展示和应用详情上方展示，填写好了能提高应用的辨认度。",[141,223,224],{"id":224},"tags",[113,226,227],{},"应用的标签，决定了应用在应用商店所属的分类，可以填写多个。",[113,229,230],{},"标签列表和其对应的分类如下：",[232,233,234,255],"table",{},[235,236,237],"thead",{},[238,239,240,244,247,249,251,253],"tr",{},[241,242,243],"th",{},"值",[241,245,246],{},"所属分类",[241,248,243],{},[241,250,246],{},[241,252,243],{},[241,254,246],{},[256,257,258,279,299,316,334,352,369],"tbody",{},[238,259,260,264,267,270,273,276],{},[261,262,263],"td",{},"WebSite",[261,265,266],{},"建站",[261,268,269],{},"Storage",[261,271,272],{},"云存储",[261,274,275],{},"Email",[261,277,278],{},"邮件服务",[238,280,281,284,287,290,293,296],{},[261,282,283],{},"Server",[261,285,286],{},"Web 服务器",[261,288,289],{},"AI",[261,291,292],{},"AI/大模型",[261,294,295],{},"Game",[261,297,298],{},"休闲游戏",[238,300,301,304,307,310,312,314],{},[261,302,303],{},"Runtime",[261,305,306],{},"运行环境",[261,308,309],{},"BI",[261,311,309],{},[261,313],{},[261,315],{},[238,317,318,321,324,327,330,332],{},[261,319,320],{},"Database",[261,322,323],{},"数据库",[261,325,326],{},"Security",[261,328,329],{},"安全",[261,331],{},[261,333],{},[238,335,336,339,342,345,348,350],{},[261,337,338],{},"Tool",[261,340,341],{},"实用工具",[261,343,344],{},"DevTool",[261,346,347],{},"开发工具",[261,349],{},[261,351],{},[238,353,354,357,359,362,365,367],{},[261,355,356],{},"DevOps",[261,358,356],{},[261,360,361],{},"Middleware",[261,363,364],{},"中间件",[261,366],{},[261,368],{},[238,370,371,374,377,380,383,385],{},[261,372,373],{},"Local",[261,375,376],{},"本地",[261,378,379],{},"Media",[261,381,382],{},"多媒体",[261,384],{},[261,386],{},[141,388,390],{"id":389},"shortdesczhen","shortDescZh/En",[113,392,393],{},"应用的中文/英文描述，用于应用在应用商店列表中和应用详情页上方快速介绍应用，不要太长（中文不超过 30 字）",[141,395,396],{"id":396},"type",[113,398,399,400,403],{},"应用的用途分类，这里主要决定了 1Panel 会怎么对待你的应用，比如",[148,401,402],{"code":402},"website","类型的可以在其网站功能中一键进行反代和分配域名。",[232,405,406,415],{},[235,407,408],{},[238,409,410,412],{},[241,411,243],{},[241,413,414],{},"说明",[256,416,417,424,432],{},[238,418,419,421],{},[261,420,402],{},[261,422,423],{},"website 即网站应用程序类型，支持在网站中一键部署和反代，WordPress 和 Halo 都是此 type",[238,425,426,429],{},[261,427,428],{},"runtime",[261,430,431],{},"mysql openresty redis 等类型的应用，倾向于应用的关键运行环境",[238,433,434,437],{},[261,435,436],{},"tool",[261,438,439],{},"phpMyAdmin redis-commander jenkins 等类型的应用，倾向于应用的维护工具等",[141,441,443],{"id":442},"crossversionupdate","crossVersionUpdate",[113,445,446],{},"决定了应用是否可以跨大版本进行升级，一般来说都可以吧。",[141,448,449],{"id":449},"limit",[113,451,452,453,456],{},"决定了这个应用最多能部署多少个，一般为",[148,454,455],{"code":455},"0","无限制，但是有些应用它确实不能重复安装，比如 Openresty 这样的反向代理服务。",[141,458,402],{"id":402},[113,460,461],{},"应用的官网地址，但不是所有应用都有官网地址，如果真没有那就填写应用的 Github 仓库地址吧，本质上就是一个联系地址",[141,463,464],{"id":464},"github",[113,466,467],{},"应用的 Github 仓库地址，本质上提交到 1Panel 应用商店的应用都是开源应用，所以一般都有这么个开源地址，你本地定制可以按情况来。",[141,469,470],{"id":470},"document",[113,472,473],{},"应用的使用文档地址，按需填写吧，不是所有应用都有完善的使用文档。",[109,475,476],{"id":476},"应用参数配置文件",[113,478,479,480,482],{},"它也是",[148,481,199],{"code":199},"，但是它在应用的版本号目录下，注意不要和应用声明文件搞混了。",[484,485,486],"blockquote",{},[113,487,488],{},"本文件主要用于生成安装时要填写的 form 表单，在应用版本文件夹下面 可以无表单，但是需要有这个 data.yml 文件，并且包含 formFields 字段。\n@1Panel 应用商店仓库官方 Wiki",[113,490,491],{},"以 Halo 的 Form 表单为例：",[113,493,494,499],{},[495,496],"img",{"alt":497,"src":498},"Halo 安装表单示例图（来自 1Panel 官方应用商店仓库）","https://user-images.githubusercontent.com/31820853/226111412-9c7b25a1-83f2-4621-8789-7ef85a2695dd.png","\n如果要生成一个上面这样子的表单，你需要这么填写应用参数配置文件（来自官方 Wiki 示例）：",[167,501,504],{"className":502,"code":503,"language":172},[170],"additionalProperties:  #固定参数\n    formFields:\n        - default: \"\"\n          envKey: PANEL_DB_HOST  #docker-compose 文件中的参数\n          key: mysql  #依赖应用的 key , 例如 mysql\n          labelEn: Database Service  #英文的 label\n          labelZh: 数据库服务  #中文的 label\n          required: true  #是否必填\n          type: service  #如果需要依赖其他应用，例如数据库，使用此 type\n        - default: halo\n          envKey: PANEL_DB_NAME\n          labelEn: Database\n          labelZh: 数据库名\n          random: true  #是否在 default 文字后面，增加随机字符串\n          required: true\n          rule: paramCommon  #校验规则\n          type: text  #需要手动填写的，使用此 type\n        - default: halo\n          envKey: PANEL_DB_USER\n          labelEn: User\n          labelZh: 数据库用户\n          random: true\n          required: true\n          rule: paramCommon\n          type: text\n        - default: halo\n          envKey: PANEL_DB_USER_PASSWORD\n          labelEn: Password\n          labelZh: 数据库用户密码\n          random: true\n          required: true\n          rule: paramComplexity\n          type: password  #密码字段使用此 type\n        - default: admin\n          envKey: HALO_ADMIN\n          labelEn: Admin Username\n          labelZh: 超级管理员用户名\n          required: true\n          rule: paramCommon\n          type: text\n        - default: halo\n          envKey: HALO_ADMIN_PASSWORD\n          labelEn: Admin Password\n          labelZh: 超级管理员密码\n          random: true\n          required: true\n          rule: paramComplexity\n          type: password\n        - default: http://localhost:8080\n          edit: true\n          envKey: HALO_EXTERNAL_URL\n          labelEn: External URL\n          labelZh: 外部访问地址\n          required: true\n          rule: paramExtUrl\n          type: text\n        - default: 8080\n          edit: true\n          envKey: PANEL_APP_PORT_HTTP\n          labelEn: Port\n          labelZh: 端口\n          required: true\n          rule: paramPort\n          type: number #端口使用此 type\n",[148,505,503],{"__ignoreMap":175},[113,507,508],{},"是不是看的眼晕了，我们这里拆出来解释下它这个东西：",[167,510,513],{"className":511,"code":512,"language":172},[170],"        - default: \"\"\n          envKey: PANEL_DB_HOST  #docker-compose 文件中的参数\n          key: mysql  #依赖应用的 key , 例如 mysql\n          labelEn: Database Service  #英文的 label\n          labelZh: 数据库服务  #中文的 label\n          required: true  #是否必填\n          type: service  #如果需要依赖其他应用，例如数据库，使用此 type\n",[148,514,512],{"__ignoreMap":175},[141,516,517],{"id":517},"dafault",[113,519,520,521,524,525,527],{},"应用这个变量值的默认格式，填写上什么应用的设置变量默认就会填写什么东西，比如说你要设置这个应用的默认前端站点是",[148,522,523],{"code":523},"example.com","就在这里这样填写上它，应用就会默认把",[148,526,523],{"code":523},"做前端默认站点值。",[141,529,531],{"id":530},"envkey","envKey",[113,533,534,535,538,539,542,543,546],{},"对应了你的应用的 compose 编排文件中环境变量设置部分，比如",[148,536,537],{"code":537},"environment","下的值，但其实简单点说就是会传递一个变量值给文件，比如",[148,540,541],{"code":541},"HOST","变量可以在 compose 文件中通过",[148,544,545],{"code":545},"${HOST}","来引用它，不难理解吧。",[113,548,549],{},"譬如在如下 Halo 例子中的引用：",[167,551,554],{"className":552,"code":553,"language":172},[170],"services:\n  halo:\n    image: halohub/halo:2.2.0\n    container_name: ${CONTAINER_NAME}\n    restart: always\n    networks:\n      - 1panel-network\n    volumes:\n      - ./data:/root/.halo2\n    ports:\n      - ${PANEL_APP_PORT_HTTP}:8090\n    command:\n      - --spring.r2dbc.url=r2dbc:pool:${HALO_PLATFORM}://${PANEL_DB_HOST}:${HALO_DB_PORT}/${PANEL_DB_NAME}\n      - --spring.r2dbc.username=${PANEL_DB_USER}\n      - --spring.r2dbc.password=${PANEL_DB_USER_PASSWORD}\n      - --spring.sql.init.platform=${HALO_PLATFORM}\n      - --halo.external-url=${HALO_EXTERNAL_URL}\n      - --halo.security.initializer.superadminusername=${HALO_ADMIN}\n      - --halo.security.initializer.superadminpassword=${HALO_ADMIN_PASSWORD}\n    labels:\n      createdBy: \"Apps\"\n\nnetworks:\n  1panel-network:\n    external: true\n",[148,555,553],{"__ignoreMap":175},[141,557,212],{"id":558},"key-1",[113,560,561],{},"这个虽然出现在了 1Panel 的官方 Wiki 示例中，但是似乎实际他们已经弃用这样写了，部分应用会依赖其他服务，比如 Halo 会有依赖 MySQL 数据库，这个时候你就在这里填写上它就能去引用它，1Panel 给的这个例子有点旧，我们使用下面的格式来实现引用外部数据库：",[167,563,566],{"className":564,"code":565,"language":172},[170],"        - child:\n            default: \"\"\n            envKey: PANEL_DB_HOST\n            required: true\n            type: service\n          default: mysql\n          envKey: PANEL_DB_TYPE\n          labelEn: Database Service\n          labelZh: 数据库服务\n          required: true\n          type: apps\n          values:\n            - label: MySQL\n              value: mysql\n            - label: MariaDB\n              value: mariadb\n",[148,567,565],{"__ignoreMap":175},[113,569,570],{},"这样你就可以为你的应用接入选择数据库的方式了，但是我也不是很懂这个，实际写起来直接 Ctrl+C 其他已实现接入外部数据库的应用范例似乎是个好办法。",[141,572,574],{"id":573},"labelenzh","labelEn/Zh",[113,576,577],{},"这个我感觉并不需要过多的介绍，已经在上面写的比较明白了，应用这个项的中英文描述。",[141,579,580],{"id":580},"required",[113,582,583,584,587],{},"决定这个变量值是否是必填的，在它为",[148,585,586],{"code":586},"true","的情况下不填写它是不能继续安装的，你可以视情况决定这个东西。",[141,589,396],{"id":590},"type-1",[113,592,593],{},"看着似乎表格很明白但实际写起来还是挺头疼的东西，自己按表格查询吧，我自己也对这个东西非常头疼，差不多它的设定决定了你的应用这个设置变量只能填什么东西。",[232,595,596,604],{},[235,597,598],{},[238,599,600,602],{},[241,601,243],{},[241,603,414],{},[256,605,606,621,632,642,653,671],{},[238,607,608,611],{},[261,609,610],{},"service",[261,612,613,616,617,620],{},[148,614,615],{"code":615},"type: service"," 如果该应用需要依赖其他组件，如 mysql redis 等，可以通过 ",[148,618,619],{"code":619},"key: mysql"," 定义依赖的名称，在创建应用时会要求先创建依赖的应用。",[238,622,623,626],{},[261,624,625],{},"password",[261,627,628,631],{},[148,629,630],{"code":630},"type: password"," 敏感信息，如密码相关的字段会默认不显示明文。",[238,633,634,636],{},[261,635,172],{},[261,637,638,641],{},[148,639,640],{"code":640},"type: text"," 一般内容，比如数据库名称，默认明文显示。",[238,643,644,647],{},[261,645,646],{},"number",[261,648,649,652],{},[148,650,651],{"code":651},"type: number"," 一般用在端口相关的配置上，只允许输入数字。",[238,654,655,658],{},[261,656,657],{},"select",[261,659,660,663,664,666,667,670],{},[148,661,662],{"code":662},"type: select"," 选项，比如 ",[148,665,586],{"code":586},", ",[148,668,669],{"code":669},"false","，日志等级等。",[238,672,673,676],{},[261,674,675],{},"通过官方给的下方的例子对照查询了解：",[261,677],{},[167,679,682],{"className":680,"code":681,"language":172},[170],"# type: service，定义一个 mysql 的 service 依赖。\n- default: \"\"\n    envKey: DB_HOST\n    key: mysql\n    labelEn: Database Service\n    labelZh: 数据库服务\n    required: true\n    type: service\n\n# type: password\n- default: Np2qgqtiUayA857GpuVI0Wtg\n    edit: true\n    envKey: DB_PASSWORD\n    labelEn: Database password\n    labelZh: 数据库密码\n    required: true\n    type: password\n\n# type: text\n- default: 192.168.100.100\n    disabled: true.\n    envKey: REDIS_HOST\n    labelEn: Redis host\n    labelZh: Redis 主机\n    type: text\n\n# type: number\n- default: 3306\n    disabled: true\n    envKey: DB_PORT\n    labelEn: Database port\n    labelZh: 数据库端口\n    rule: paramPort\n    type: number\n\n# type: select\n- default: \"ERROR\"\n    envKey: LOG_LEVEL\n    labelEn: Log level\n    labelZh: 日志级别\n    required: true\n    type: select\n    values:\n        - label: DEBUG\n          value: \"DEBUG\"\n        - label: INFO\n          value: \"INFO\"\n        - label: WARNING\n          value: \"WARNING\"\n        - label: ERROR\n          value: \"ERROR\"\n        - label: CRITICAL\n          value: \"CRITICAL\"\n",[148,683,681],{"__ignoreMap":175},[141,685,686],{"id":686},"rule",[113,688,689,690,692],{},"在上面的例子中部分登场，主要是校验用户是否书写这个东西的格式是正确的，比如防止某些用户在端口设置这里填写域名的东西，这个",[148,691,686],{"code":686},"就会强制这个填写栏必须填写什么格式。",[232,694,695,704],{},[235,696,697],{},[238,698,699,701],{},[241,700,243],{},[241,702,703],{},"规则",[256,705,706,714,722,730],{},[238,707,708,711],{},[261,709,710],{},"paramPort",[261,712,713],{},"用于限制端口范围为 1-65535",[238,715,716,719],{},[261,717,718],{},"paramExtUrl",[261,720,721],{},"格式为 http(s)://(域名/ip):(端口)",[238,723,724,727],{},[261,725,726],{},"paramCommon",[261,728,729],{},"英文、数字、.-和_，长度 2-30",[238,731,732,735],{},[261,733,734],{},"paramComplexity",[261,736,737],{},"支持英文、数字、.%@$!&~_-,长度 6-30，特殊字符不能在首尾",[109,739,741],{"id":740},"应用-compose-文件","应用 Compose 文件",[113,743,744,745,748],{},"位于应用版本号目录下的",[148,746,747],{"code":747},"docker-compose.yml","文件，注意有格式要求，下面是示例",[141,750,751],{"id":751},"示例文件",[167,753,756],{"className":754,"code":755,"language":172},[170],"services:\n  ghost:\n    container_name: ${CONTAINER_NAME}\n    restart: always\n    networks:\n      - 1panel-network\n    ports:\n      - \"${PANEL_APP_PORT_HTTP}:2368\"\n    volumes:\n      - ./data:/var/lib/ghost/content\n    environment:\n      - database__client=${PANEL_DB_TYPE}\n      - database__connection__host=${PANEL_DB_HOST}\n      - database__connection__user=${PANEL_DB_USER}\n      - database__connection__password=${PANEL_DB_USER_PASSWORD}\n      - database__connection__database=${PANEL_DB_NAME}\n      - database__connection__port=${PANEL_DB_PORT}\n      - url=${GHOST_EXTERNAL_URL}\n    image: ghost:5.96.2\n    labels:\n      createdBy: \"Apps\"\n\nnetworks:\n  1panel-network:\n    external: true\n",[148,757,755],{"__ignoreMap":175},[141,759,760],{"id":760},"要求",[762,763,764,772,783,790,801,812,826,836],"ul",{},[765,766,767,768,771],"li",{},"头部没有",[148,769,770],{"code":770},"version","的变量，记得把它删去。",[765,773,774,775,778,779,782],{},"必须为应用定义",[148,776,777],{"code":777},"container_name","这个设置，且后面必须是",[148,780,781],{"code":781},"${CONTAINER_NAME}","，这样 1Panel 才能在安装时对其正确配置。",[765,784,785,786,789],{},"必须配置应用网络为",[148,787,788],{"code":788},"1panel-network","，这样应用之间才能正常互联，我在部分第三方应用商店库发现它们不是很注重这个，当然这事也可以视情况而论，但是建议是都在 1Panel 官方网络下。",[765,791,792,793,796,797,800],{},"端口",[148,794,795],{"code":795},"ports","这里设置也是必须为其默认定义的",[148,798,799],{"code":799},"${PANEL_APP_PORT_HTTP}:8090","这样的格式，这样 1Panel 才能正确设置应用的开放端口",[765,802,803,804,807,808,811],{},"文件尾部也必须跟示例文件一样，填写了",[148,805,806],{"code":806},"networks","配置，直接",[148,809,810],{"code":810},"Ctrl+C","过去就好。",[765,813,814,815,818,819,822,823,825],{},"应用的",[148,816,817],{"code":817},"image","镜像标签必须和文件夹表示的版本号一致，比如这个版本号文件夹写的是",[148,820,821],{"code":821},"5.96.2","，那么其文件内部",[148,824,817],{"code":817},"标签也必须那样写，不然会影响应用检测和安装更新！",[765,827,828,829,832,833,835],{},"记得填写上面的",[148,830,831],{"code":831},"labels","标签，直接",[148,834,810],{"code":810},"过去就行，当然这个也不算必填项，只是一种规范罢了。",[765,837,838,839,842],{},"记得为应用定义重启相关，比如",[148,840,841],{"code":841},"always","等等，这样保证应用在遇到问题后可以恢复（雾）",[109,844,845],{"id":845},"脚本",[141,847,848],{"id":848},"介绍",[113,850,851],{},"1Panel 在 安装之前、升级之前、卸载之后支持执行 .sh 脚本\n分别对应 init.sh upgrade.sh uninstall.sh\n存放目录 (以 halo 为例) : halo/2.2.0/scripts",[109,853,854],{"id":854},"本地测试",[113,856,857],{},"我十分建议你发布前先在自己已安装 1Panel 的服务器上进行测试，确定它是否可以正常安装",[113,859,860,861,864,865,868],{},"将应用目录上传到 1Panel 的",[148,862,863],{"code":863},"/opt/1panel/resource/apps/local","文件夹下\n注意：",[148,866,867],{"code":867},"/opt"," 为 1Panel 默认安装目录，请根据自己的实际情况修改\n上传完成后，目录结构如下：",[167,870,873],{"className":871,"code":872,"language":172},[170],"├──halo\n    ├── logo.png\n    ├── data.yml\n    ├── README.md\n    ├── 2.2.0\n     &nbsp;&nbsp; ├── data.yml\n     &nbsp;&nbsp; ├── data\n     &nbsp;&nbsp; └── docker-compose.yml\n",[148,874,872],{"__ignoreMap":175},[113,876,877],{},"在 1Panel 应用商店中，点击更新应用列表按钮同步本地应用。",[109,879,880],{"id":880},"收尾",[113,882,883],{},"测试正常后，你就可以去提交官方库或者第三方应用商店库了，或者你自己用，都可以，不过我还是建议你本着分享精神，把它提交到官方或其他第三方应用商店仓库里去。",[113,885,886],{},"官方的要求和拒绝率比较高，一般来说提交第三方仓库也挺好的，这里列举目前个人已知仓库：",[762,888,889,899],{},[765,890,891,898],{},[892,893,897],"a",{"href":894,"rel":895},"https://github.com/AuroraStarTeam/1panel-app-store",[896],"nofollow","AuroraStarTeam/1panel-app-store","，由我所属个人组织极光星进行维护，理念是干净整洁，但是个人经验可能不够丰富。",[765,900,901,906],{},[892,902,905],{"href":903,"rel":904},"https://github.com/okxlin/appstore",[896],"okxlin/appstore","，流行和最早的第三方商店库，应用很多，但是也很乱。",[109,908,910],{"id":909},"参考文档","参考文档：",[762,912,913],{},[765,914,915],{},[892,916,919],{"href":917,"rel":918},"https://github.com/1Panel-dev/appstore/wiki/%E5%A6%82%E4%BD%95%E6%8F%90%E4%BA%A4%E8%87%AA%E5%B7%B1%E6%83%B3%E8%A6%81%E7%9A%84%E5%BA%94%E7%94%A8",[896],"如何提交自己想要的应用（1Panel 官方应用商店仓库 Wiki）",{"title":175,"searchDepth":921,"depth":921,"links":922},4,[923,925,926,943,952,956,959,960,961],{"id":111,"depth":924,"text":111},2,{"id":133,"depth":924,"text":133},{"id":139,"depth":924,"text":139,"children":927},[928,930,931,932,933,934,935,936,937,938,939,940,941,942],{"id":143,"depth":929,"text":143},3,{"id":162,"depth":929,"text":162},{"id":178,"depth":929,"text":179},{"id":193,"depth":929,"text":193},{"id":212,"depth":929,"text":212},{"id":218,"depth":929,"text":218},{"id":224,"depth":929,"text":224},{"id":389,"depth":929,"text":390},{"id":396,"depth":929,"text":396},{"id":442,"depth":929,"text":443},{"id":449,"depth":929,"text":449},{"id":402,"depth":929,"text":402},{"id":464,"depth":929,"text":464},{"id":470,"depth":929,"text":470},{"id":476,"depth":924,"text":476,"children":944},[945,946,947,948,949,950,951],{"id":517,"depth":929,"text":517},{"id":530,"depth":929,"text":531},{"id":558,"depth":929,"text":212},{"id":573,"depth":929,"text":574},{"id":580,"depth":929,"text":580},{"id":590,"depth":929,"text":396},{"id":686,"depth":929,"text":686},{"id":740,"depth":924,"text":741,"children":953},[954,955],{"id":751,"depth":929,"text":751},{"id":760,"depth":929,"text":760},{"id":845,"depth":924,"text":845,"children":957},[958],{"id":848,"depth":929,"text":848},{"id":854,"depth":924,"text":854},{"id":880,"depth":924,"text":880},{"id":909,"depth":924,"text":910},[963],"技术探索","2024-10-17T19:24:26","本文介绍了如何为 1Panel 服务器面板编写并提交自定义应用包；本文记录了从目录结构、Logo、应用声明文件、版本参数表单，到符合规范的 docker-compose.yml 与本地测试的完整流程；本文分享了避开官方高门槛、直接 PR 第三方商店仓库的快捷路线，帮助读者把任意已容器化的开源项目一键搬进 1Panel 应用商店，实现图形化秒装。",false,"md",{},true,"/2024/10/write-1panel-app",{"text":972,"minutes":973,"time":974,"words":975},"20 min read",19.76,1185600,3952,{"title":104,"description":965},{"loc":970},"posts/2024/10/write-1panel-app",[980],"1Panel","tech","1JlP64H6YY5rIv9YSCXiEsBCrawYNDlw2mjwS6jVWPs",[984,989],{"title":985,"path":986,"stem":987,"date":988,"type":981,"children":-1},"记一次被1Panel官方应用商店拒绝合并","/2024/09/1panel-appstore-refused","posts/2024/09/1panel-appstore-refused","2024-09-07T19:24:26",{"title":990,"path":991,"stem":992,"date":993,"type":981,"children":-1},"GitHub Action 构建 Shiroi Docker 镜像","/2024/10/shiroi-docker-deployment","posts/2024/10/shiroi-docker-deployment","2024-10-21T19:24:26",1765727088226]