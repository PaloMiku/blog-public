[{"data":1,"prerenderedAt":533},["ShallowReactive",2],{"/2025/10/misskey-fediverse-deploy/":3,"surround-/2025/10/misskey-fediverse-deploy":522},{"id":4,"title":5,"body":6,"categories":497,"date":499,"description":500,"draft":501,"extension":502,"image":503,"meta":504,"navigation":505,"path":506,"permalink":507,"readingTime":508,"recommend":513,"references":507,"seo":514,"sitemap":515,"stem":516,"tags":517,"type":520,"updated":507,"__hash__":521},"content/posts/2025/10/misskey-fediverse-deploy.md","Misskey éƒ¨ç½²ï¼šæ–°ä¸€ä»£è”é‚¦æ˜Ÿé™…å¾®åšå¹³å°",{"type":7,"value":8,"toc":463},"minimark",[9,13,17,20,23,26,33,36,51,54,58,61,64,74,77,80,84,87,98,102,105,111,118,122,133,141,155,162,172,176,180,183,189,192,198,202,213,218,221,229,233,238,244,247,269,275,281,284,287,290,296,300,303,309,312,315,321,325,328,334,337,340,346,350,357,363,367,370,377,383,387,394,400,404,407,413,417,424,430,433,436,439,445,448,454,457,460],[10,11,12],"h2",{"id":12},"å‰è¨€",[14,15,16],"p",{},"æˆ‘è¸å…¥è”é‚¦å®‡å®™çš„ç¬¬ä¸€ä¸ªå®ä¾‹æ˜¯ Misskey....çš„ Fork ç‰ˆæœ¬ Firefishï¼Œè¿™äº›å¹´è¿‡å»äº†ï¼ŒFirefish å·²ç»åœæ­¢ç»´æŠ¤ï¼Œä½† Misskey ä»åœ¨è“¬å‹ƒå‘å±•ï¼Œä»Šå¤©æˆ‘ä»¬åœ¨è¿™ç¯‡æ–‡ç« å°†è¯¦ç»†è®²è§£å¦‚ä½•åœ¨ä¸€å°æœåŠ¡å™¨ä¸Šå…¨é‡éƒ¨ç½² Misskey å’Œå…¶é…å¥—æœåŠ¡ã€‚",[10,18,19],{"id":19},"å‡†å¤‡",[14,21,22],{},"åœ¨éƒ¨ç½² Misskey å‰ï¼Œä½ éœ€è¦æœ‰ä¸€å°æ€§èƒ½å¼ºæ‚çš„æœåŠ¡å™¨ï¼Œè™½ç„¶ Misskey å¹¶ä¸åƒ Mastodon é‚£ä¹ˆåºå¤§ï¼Œä½†ä¾ç„¶éœ€è¦ä½ çš„æœåŠ¡å™¨æœ‰è¾ƒé«˜çš„é…ç½®ï¼Œä¸ªäººå»ºè®®è‡³å°‘ 2c4g èµ·æ­¥ã€‚",[14,24,25],{},"ä½ å¯ä»¥å‚è§ä¸ªäººæ–‡ç« ã€Šè‡ªå»ºä¸€ä¸ª Fediverse å®ä¾‹ï¼Œæˆ‘ä»¬éœ€è¦å‡†å¤‡ä»€ä¹ˆï¼Ÿã€‹ï¼Œåœ¨æ­¤ç¯‡æ–‡ç« é‡Œä¸ªäººä»åŸŸååˆ°æœåŠ¡å™¨å‡†å¤‡ä»¥åŠå¯¹è±¡å­˜å‚¨ç­‰å…¨é¢è¯¦è§£äº†ä½ åº”è¯¥ä¸ºè”é‚¦å®‡å®™å®ä¾‹åšä»€ä¹ˆå‡†å¤‡ã€‚",[27,28],"link-banner",{":description":29,"banner":30,"link":31,"title":32},"null","https://engagemedia.org/wp-content/uploads/2020/07/Fediverse-3D_logojpg.jpg","/2025/06/self-fediverse-prepare","è‡ªå»ºä¸€ä¸ª Fediverse å®ä¾‹ï¼Œæˆ‘ä»¬éœ€è¦å‡†å¤‡ä»€ä¹ˆï¼Ÿ",[14,34,35],{},"åœ¨æœ‰ä¸€å°åˆé€‚çš„æœåŠ¡å™¨å’ŒåŸŸååï¼Œæˆ‘ä»¬å°±å¯ä»¥å¼€å§‹å®‰è£… Misskey çš„ç¬¬ä¸€æ­¥äº†ã€‚",[37,38,42,48],"alert",{":card":39,"card":40,"type":41},"true","","warning",[43,44,45],"template",{"v-slot:title":40},[14,46,47],{},"æ³¨æ„ï¼",[14,49,50],{},"åŸŸåä¸€å®šè¦æ…é‡å†³å®šï¼Œä¸€æ—¦ä½ å¯åŠ¨äº†å®ä¾‹ï¼Œåœ¨æ­¤ä¹‹åä¸è¦æ›´æ”¹åŸŸåï¼",[14,52,53],{},"æ³¨æ„å› ä¸º Misskey æ‰€ä½¿ç”¨çš„ ActivityPub åè®®çš„ç‰¹æ®Šæ€§ï¼Œéƒ¨ç½²åä¸æ”¯æŒæ›´æ¢åŸŸåï¼æ‰€ä»¥é€‰æ‹©åŸŸåä¸€å®šè¦æ…é‡é€‰æ‹©ã€‚",[10,55,57],{"id":56},"å®‰è£…-docker","å®‰è£… Docker",[14,59,60],{},"Misskey å®˜æ–¹æ¨èçš„éƒ¨ç½²æ–¹å¼æ˜¯ Docker Composeï¼Œè¿™éœ€è¦æˆ‘ä»¬åœ¨æœåŠ¡å™¨ä¸Šå®‰è£… Dockerã€‚",[14,62,63],{},"æˆ‘ä»¬ä½¿ç”¨ Linuxmirrors æä¾›çš„ Docker å®‰è£…è„šæœ¬æ¥æ‰§è¡Œ Docker çš„å®‰è£…ï¼Œå®ƒå¯ä»¥åœ¨å¤šç§ Linux ç³»ç»Ÿä¸Šå®‰è£… Dockerã€‚",[65,66,71],"pre",{"className":67,"code":69,"language":70,"meta":40},[68],"language-bash","bash \u003C(curl -sSL https://linuxmirrors.cn/docker.sh)\n","bash",[72,73,69],"code",{"__ignoreMap":40},[14,75,76],{},"åœ¨éµç…§è„šæœ¬æ­¥éª¤å®Œæˆå®‰è£… Docker åï¼Œæˆ‘ä»¬è¿›è¡Œä¸‹ä¸€æ­¥æ“ä½œã€‚",[10,78,79],{"id":79},"å®‰è£…åå‘ä»£ç†æœåŠ¡",[81,82,83],"h3",{"id":83},"åå‘ä»£ç†",[14,85,86],{},"åœ¨ Misskey æˆ‘ä¸ªäººæ˜¯æ¨èä½¿ç”¨ Caddy è¿™æ¬¾ Web æœåŠ¡å™¨çš„ï¼Œè‡ªèº«å ç”¨ä½ä¸”æ€§èƒ½ä¸é”™ï¼Œè€Œä¸”å®ƒèƒ½å¤Ÿè‡ªåŠ¨ç”³è¯· https è¯ä¹¦ï¼Œæ¥å…¥è”é‚¦å®‡å®™æ˜¯å¿…é¡»è¦æœ‰ https åè®®çš„ï¼Œæ‰€ä»¥ä½ è‚¯å®šæ˜¯ä¸èƒ½ç”¨ http æˆ–è€… ip è®¿é—® Misskey å®ä¾‹çš„ï¼ŒCaddy å°±èƒ½å¸®åŠ©æˆ‘ä»¬ç®€åŒ–è¿™ä¸ªè¿‡ç¨‹ã€‚",[14,88,89,90,97],{},"Caddy çš„éƒ¨ç½²å’Œå®‰è£…å¯ä»¥å‚è§",[91,92,96],"a",{"href":93,"rel":94},"https://caddyserver.com/docs/install",[95],"nofollow","å®˜æ–¹æ–‡æ¡£","ï¼Œæˆ‘ä»¬åœ¨è¿™é‡Œä»…ä»‹ç» Debian/Ubuntu ç¯å¢ƒä¸‹çš„å®‰è£…å’Œä½¿ç”¨æ–¹å¼ã€‚",[81,99,101],{"id":100},"å®‰è£…-caddy","å®‰è£… Caddy",[14,103,104],{},"ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤åœ¨ Debian/Ubuntu ç¯å¢ƒä¸‹ä¸€é”®å®‰è£…å’Œå¯åŠ¨ Caddy æœ¬èº«ä»¥åŠéœ€æ±‚çš„ç»„ä»¶ä»¥åŠé…ç½® Caddy å®˜æ–¹è½¯ä»¶åŒ…ä»“åº“ï¼ˆç¨³å®šç‰ˆï¼‰ï¼š",[65,106,109],{"className":107,"code":108,"language":70,"meta":40},[68],"sudo apt install -y debian-keyring debian-archive-keyring apt-transport-https curl \ncurl -1sLf 'https://dl.cloudsmith.io/public/caddy/stable/gpg.key' | sudo gpg --dearmor -o /usr/share/keyrings/caddy-stable-archive-keyring.gpg \ncurl -1sLf 'https://dl.cloudsmith.io/public/caddy/stable/debian.deb.txt' | sudo tee /etc/apt/sources.list.d/caddy-stable.list \nchmod o+r /usr/share/keyrings/caddy-stable-archive-keyring.gpg \nchmod o+r /etc/apt/sources.list.d/caddy-stable.list \nsudo apt update \nsudo apt install caddy\n",[72,110,108],{"__ignoreMap":40},[14,112,113,114,117],{},"æ‰§è¡Œæ­¤å®‰è£…æ“ä½œåï¼ŒCaddy å°†è‡ªåŠ¨å¯åŠ¨å¹¶ä½œä¸ºåä¸ºÂ ",[72,115,116],{"code":116},"caddy","Â çš„ systemd æœåŠ¡è¿è¡Œ Caddyã€‚",[81,119,121],{"id":120},"é…ç½®-caddy-åå‘ä»£ç†","é…ç½® Caddy åå‘ä»£ç†",[14,123,124,125,128,129,132],{},"æˆ‘ä»¬æ‰“å¼€",[72,126,127],{"code":127},"/etc/caddy/","ç›®å½•ä¸‹çš„",[72,130,131],{"code":131},"Caddyfile","æ–‡ä»¶ï¼Œåœ¨æœ€ä¸‹é¢é¦–å…ˆæ·»åŠ å¦‚ä¸‹é…ç½®ï¼š",[65,134,139],{"className":135,"code":137,"language":138,"meta":40},[136],"language-json","misskey.example.com {\n  reverse_proxy 127.0.0.1:3000\n  encode zstd gzip\n}\n","json",[72,140,137],{"__ignoreMap":40},[14,142,143,144,147,148,151,152,154],{},"è¿™ä»£è¡¨ Caddy ä¼šåä»£",[72,145,146],{"code":146},"misskey.example.com","çš„è¯·æ±‚ï¼Œå¹¶æŠŠè¯·æ±‚è½¬å‘åˆ°åœ¨æœ¬åœ°",[72,149,150],{"code":150},"3000","ç«¯å£ä¸Šæš´éœ²çš„æœåŠ¡ï¼Œæˆ‘ä»¬è¿™ç¯‡æ•™ç¨‹ä¼šè®© Misskey åœ¨",[72,153,150],{"code":150},"ç«¯å£ä¸Šéƒ¨ç½²ï¼Œå¦‚æœä½ æƒ³è¦æ›´æ¢ç«¯å£ï¼Œé‚£ä¹ˆåœ¨ä¸Šé¢çš„é…ç½®æ–‡ä»¶å’Œåé¢çš„é…ç½®æ–‡ä»¶ä¸­ä½ éƒ½éœ€è¦æ›´æ¢å¯¹åº”ç«¯å£ã€‚",[14,156,157,158,161],{},"Caddy æ”¯æŒé€šè¿‡é…ç½®æ–‡ä»¶å¯ç”¨ Zstandardå’Œ Gzip å‹ç¼©åŠŸèƒ½ï¼Œè¿™æ˜¯ä¸»æµçš„ä¸¤ç§å‹ç¼©ç®—æ³•ã€‚æˆ‘ä»¬åªéœ€è¦æŠŠ",[72,159,160],{"code":160}," encode zstd gzip","åŠ å…¥åŸŸåé…ç½®æ–‡ä»¶ä¸‹æ–¹å³å¯ï¼Œåç»­åŠ å…¥å…¶ä»–é…ç½®ä¹Ÿæ˜¯ç±»ä¼¼è¿™æ ·æ”¾ç½®ã€‚",[14,163,164,165,167,168,171],{},"åŒæ ·ä½ ä¹Ÿéœ€è¦æ›´æ¢",[72,166,146],{"code":146},"ä¸ºä½ å®é™…æƒ³éƒ¨ç½²çš„åŸŸåï¼Œå®Œæˆé…ç½®åï¼Œç¡®ä¿åŸŸåå·²ç»è§£æåˆ°æœåŠ¡å™¨çš„å‰æä¸‹ï¼Œä½¿ç”¨",[72,169,170],{"code":170},"systemctl restart caddy","é‡å¯ Caddy æœåŠ¡ã€‚",[10,173,175],{"id":174},"å®‰è£…-misskey-æœåŠ¡","å®‰è£… Misskey æœåŠ¡",[81,177,179],{"id":178},"è·å–-misskey-å’Œåˆå§‹åŒ–é…ç½®æ–‡ä»¶","è·å– Misskey å’Œåˆå§‹åŒ–é…ç½®æ–‡ä»¶",[14,181,182],{},"ä½¿ç”¨ä»¥ä¸‹æŒ‡ä»¤ä» Github è·å– Misskey ä»“åº“å’Œç›¸å…³æ–‡ä»¶ï¼Œå¹¶è¿›å…¥ Misskey æ–‡ä»¶å¤¹",[65,184,187],{"className":185,"code":186,"language":70,"meta":40},[68],"git clone -b master https://github.com/misskey-dev/misskey.git\ncd misskey\n",[72,188,186],{"__ignoreMap":40},[14,190,191],{},"ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å¤åˆ¶å„ç§é…ç½®æ–‡ä»¶çš„ç¤ºä¾‹åˆ°å¯ç¼–è¾‘é…ç½®æ–‡ä»¶ï¼š",[65,193,196],{"className":194,"code":195,"language":70,"meta":40},[68],"cp .config/docker_example.yml .config/default.yml\ncp .config/docker_example.env .config/docker.env\ncp ./compose_example.yml ./compose.yml\n",[72,197,195],{"__ignoreMap":40},[81,199,201],{"id":200},"ä¿®æ”¹-misskey-é…ç½®æ–‡ä»¶","ä¿®æ”¹ Misskey é…ç½®æ–‡ä»¶",[14,203,204,205,208,209,212],{},"è¿›å…¥ Misskey ç›®å½•ä¸‹çš„",[72,206,207],{"code":207},".config","æ–‡ä»¶å¤¹ï¼Œé¦–å…ˆæ‰“å¼€",[72,210,211],{"code":211},"default.yml","ï¼Œæˆ‘ä»¬è¦è¿›è¡Œ Misskey é…ç½®æ–‡ä»¶å„é¡¹é…ç½®çš„ä¿®æ”¹ã€‚",[214,215,217],"h4",{"id":216},"å®ä¾‹-url-é…ç½®","å®ä¾‹ URL é…ç½®",[14,219,220],{},"é¦–å…ˆæˆ‘ä»¬éœ€è¦ç¼–è¾‘é…ç½®æ–‡ä»¶çš„ URL è®¾ç½®ï¼Œæ­¤å¤„å³ä¸ºä½ çš„å®ä¾‹ä»¥åå¯¹å¤–çš„ URLï¼Œæ‰€ä»¥å†æ¬¡é‡ç”³ä¸€å®šè¦æ…é‡å†³å®šï¼Œä¸€æ—¦ä½ å¯åŠ¨äº†å®ä¾‹ï¼Œåœ¨æ­¤ä¹‹åä¸è¦æ›´æ”¹ URL è®¾ç½®ï¼",[65,222,227],{"className":223,"code":225,"language":226,"meta":40},[224],"language-yaml","# æœ€ç»ˆç”¨æˆ·çœ‹åˆ°çš„å¯è®¿é—® URLã€‚\n# ä½ ä¹Ÿå¯ä»¥é€šè¿‡ç¯å¢ƒå˜é‡æ¥è®¾ç½® URLã€‚\nurl: https://misskey.example.com\n","yaml",[72,228,225],{"__ignoreMap":40},[214,230,232],{"id":231},"ç«¯å£ä¸-tls-è®¾ç½®","ç«¯å£ä¸ TLS è®¾ç½®",[14,234,235,236],{},"åœ¨æ­¤å¤„æˆ‘ä»¬éœ€è¦æ³¨æ„å’Œä¸Šæ–‡æˆ‘ä»¬é¢„é…ç½®åå‘ä»£ç†çš„æ—¶å€™è¦ä¿æŒä¸€ä¸ªç«¯å£ï¼Œæ­¤å¤„å³",[72,237,150],{"code":150},[65,239,242],{"className":240,"code":241,"language":226,"meta":40},[224],"# Misskey æœåŠ¡å™¨åº”ç›‘å¬çš„ç«¯å£ã€‚\nport: 3000\n",[72,243,241],{"__ignoreMap":40},[214,245,246],{"id":246},"æ•°æ®åº“è®¾ç½®",[14,248,249,250,253,254,257,258,261,262,265,266,268],{},"åœ¨æ­¤æ®µæˆ‘ä»¬è¦è¿›è¡Œçš„æ˜¯æ•°æ®åº“è¿æ¥ä¿¡æ¯è®¾ç½®ï¼Œå°†",[72,251,252],{"code":252},"example-misskey-user","å’Œ",[72,255,256],{"code":256},"example-misskey-pass","æ›´æ¢ä¸ºä½ æƒ³ä½¿ç”¨çš„è´¦æˆ·å’Œå¯†ç ï¼Œå¦‚æœä½ çš„æ•°æ®åº“åœ°å€å¼€å¯äº† SSL è¿æ¥ï¼Œè¿˜éœ€è¦æŠŠ",[72,259,260],{"code":260},"extra","ä¸‹çš„",[72,263,264],{"code":264},"ssl","è®¾ä¸º",[72,267,39],{"code":39},"ï¼Œä½†æˆ‘ä»¬é»˜è®¤ä½¿ç”¨çš„æ˜¯ Docker Compose çš„ PostgreSQL æ•°æ®åº“æ‰€ä»¥ä¸éœ€è¦å¼€å¯ SSLã€‚",[65,270,273],{"className":271,"code":272,"language":226,"meta":40},[224],"db:\n  host: db\n  port: 5432\n\n  # æ•°æ®åº“åç§°\n  # ä½ ä¹Ÿå¯ä»¥é€šè¿‡ç¯å¢ƒå˜é‡æ¥è®¾ç½®æ•°æ®åº“åç§°ã€‚\n  db: misskey\n\n  # è®¤è¯ä¿¡æ¯\n  # ä½ ä¹Ÿå¯ä»¥é€šè¿‡ç¯å¢ƒå˜é‡æ¥è®¾ç½®ç”¨æˆ·åå’Œå¯†ç ã€‚\n  user: example-misskey-user\n  pass: example-misskey-pass\n\n  # æ˜¯å¦ç¦ç”¨æŸ¥è¯¢ç¼“å­˜\n  #disableCache: true\n\n  # é¢å¤–çš„è¿æ¥é€‰é¡¹\n  #extra:\n  #  ssl: true\n",[72,274,272],{"__ignoreMap":40},[14,276,277],{},[278,279,280],"strong",{},"dbReplications / dbSlavesï¼ˆè¯»å†™åˆ†ç¦»ï¼‰",[14,282,283],{},"è¿™æ˜¯ä¸€ä¸ªè¿›é˜¶ç©æ³•ï¼Œé€‚ç”¨äºè¶…å¤§å‹å®ä¾‹ï¼Œç®€å•ä»‹ç»å°±æ˜¯æŠŠè¯»ï¼Œæ¯”å¦‚æœç´¢ï¼Œå±•ç¤º Note è´´æ–‡ç­‰æ›´å¤šåªéœ€è¦è¯»å–çš„åœºæ™¯è·¯ç”±åˆ°åªè¯»å‰¯æœ¬ä¸Šï¼Œå¯ä»¥æœ‰æ•ˆå‡å°‘ä¸»åº“å‹åŠ›ã€‚",[14,285,286],{},"å°å‹å®ä¾‹åŸºæœ¬ç”¨ä¸åˆ°ï¼Œç­‰ä½ ç”¨åˆ°å®ƒèµ·ç å¾—ä¸‡äººä»¥ä¸Šå®ä¾‹æ‰å¯èƒ½æ˜¾å‡ºä¸»åº“å‹åŠ›é—®é¢˜äº†ï¼Œè€Œä¸”ä½¿ç”¨è¿™ä¸ªåŠŸèƒ½æ³¨å®šä¼šæœ‰å»¶è¿Ÿï¼Œä»åº“å»¶è¿Ÿ 100~300 ms å¾ˆå¸¸è§ï¼Œä¾‹å¦‚åˆšå‘çš„ Note å¯èƒ½ç¬é—´åœ¨ä¸ªäººæ—¶é—´çº¿é‡Œçœ‹ä¸åˆ°ï¼Œç„¶ååˆ·æ–°ä¸€ä¸‹åˆæœ‰äº†ã€‚",[14,288,289],{},"æœ¬æ–‡ä»…å¯¹æ­¤ä½œè§£é‡Šã€‚",[65,291,294],{"className":292,"code":293,"language":226,"meta":40},[224],"dbReplications: false\n\n# ä½ å¯ä»¥åœ¨è¿™é‡Œé…ç½®ä»»æ„æ•°é‡çš„åªè¯»å‰¯æœ¬\n#dbSlaves:\n#  -\n#    host:\n#    port:\n#    db:\n#    user:\n#    pass:\n#  -\n#    host:\n#    port:\n#    db:\n#    user:\n#    pass:\n",[72,295,293],{"__ignoreMap":40},[214,297,299],{"id":298},"redis-æ•°æ®åº“è®¾ç½®","Redis æ•°æ®åº“è®¾ç½®",[14,301,302],{},"Redis ä½œä¸ºå†…å­˜æ•°æ®åº“ï¼Œåœ¨æœç´¢æŸ¥è¯¢è¿˜æœ‰æŠ•é€’ç­‰é˜Ÿåˆ—æ“ä½œä¸Šéƒ½ç”¨å¾—åˆ°ï¼Œæ˜¯å¿…é¡»é…ç½®çš„ï¼Œå¦‚æœä½ è¿æ¥çš„å¤–éƒ¨å¸¦åŠ å¯†æ•°æ®åº“æˆ–è€…æœåŠ¡å™¨ä¸€ä¸ª Redis æä¾›ç»™å¤šä¸ªæœåŠ¡é‚£ä¹ˆå°±éœ€è¦è¯¦ç»†é…ç½®å®ƒäº†ï¼Œä½¿ç”¨ Docker Compose é…ç½®ä¿æŒé»˜è®¤å³å¯ã€‚",[65,304,307],{"className":305,"code":306,"language":226,"meta":40},[224],"redis:\n  host: redis\n  port: 6379\n  #family: 0  # 0=Both, 4=IPv4, 6=IPv6\n  #pass: example-pass\n  #prefix: example-prefix\n  db: 1\n",[72,308,306],{"__ignoreMap":40},[214,310,311],{"id":311},"å…¨æ–‡æœç´¢è®¾ç½®",[14,313,314],{},"å¾—ç›Šäºæˆ‘åœ¨ Sharkey å®ä¾‹è¿è¥ä¸Šå¾—åˆ°çš„å®è´µç»éªŒï¼Œæˆ‘ä»¬åœ¨æ­¤å¤„é€‰æ‹© sqlPgroonga ä½œä¸ºæ•°æ®åº“å…¨æ–‡æœç´¢å¼•æ“ï¼Œå®ƒå¯¹ä¸­æ–‡åœ¨å†…çš„äºšæ´²è¯­è¨€ç­‰å…¨æ–‡æœç´¢å…¼å®¹æ€§æ›´å¥½æ›´å¿«ï¼Œè€Œä¸”ä¸éœ€è¦éƒ¨ç½²é¢å¤–çš„æœç´¢æœåŠ¡ï¼Œæœ¬èº«å°±æ˜¯åœ¨ PostgreSQL æœåŠ¡ä¸Šæä¾›çš„é¢å¤–æ”¯æŒï¼Œå› æ­¤æˆ‘ä»¬åç»­ä¹Ÿéœ€è¦åœ¨ Compose æ–‡ä»¶ä¸Šåšä¸€äº›å°ä¿®æ”¹æ¥è®©å®ƒä½¿ç”¨ sqlPgroonga ä½œä¸ºæ•°æ®åº“å…¨æ–‡æœç´¢ã€‚",[65,316,319],{"className":317,"code":318,"language":226,"meta":40},[224],"fulltextSearch:\n  provider: sqlPgroonga\n",[72,320,318],{"__ignoreMap":40},[214,322,324],{"id":323},"id-ç”Ÿæˆè®¾ç½®","ID ç”Ÿæˆè®¾ç½®",[14,326,327],{},"è¿™é‡Œä½ å¯ä»¥è°ƒæ•´ Misskey çš„ ID ç”Ÿæˆç®—æ³•ï¼Œé€šå¸¸ä¸éœ€è¦ä¿®æ”¹å®ƒï¼Œä½†ä½ ä¾ç„¶å¯ä»¥æ ¹æ®ä¸ªäººè°ƒæ•´å®ƒã€‚",[65,329,332],{"className":330,"code":331,"language":226,"meta":40},[224],"\n# å¯é€‰ç®—æ³•ï¼š\n# aid   ... æœ€çŸ­ï¼Œæ¯«ç§’çº§\n# aidx  ... æ¯«ç§’çº§ï¼ˆé»˜è®¤æ¨èï¼‰\n# meid  ... ç±»ä¼¼ Mongo ObjectIDï¼Œæ¯«ç§’çº§\n# ulid  ... æ¯«ç§’çº§ï¼Œå­—å…¸åºå‹å¥½\n# objectid ... ä»…ç”¨äºå…¼å®¹æ—§å®ä¾‹\n\n# å®ä¾‹ä¸€æ—¦å¯åŠ¨ï¼Œåˆ‡å‹¿å†ä¿®æ”¹æ­¤é…ç½®ï¼\nid: 'aidx'\n",[72,333,331],{"__ignoreMap":40},[214,335,336],{"id":336},"å…¶ä»–è®¾ç½®",[14,338,339],{},"é€šå¸¸ä¸éœ€è¦ä¿®æ”¹å®ƒï¼Œæˆ‘åœ¨è¿™æ”¾ä¸€ä¸‹å¸¦ä¸­æ–‡æ³¨é‡Šç¿»è¯‘çš„é…ç½®æ–‡ä»¶ï¼Œä½ å¯ä»¥æŒ‰éœ€è¦ä¿®æ”¹å®ƒã€‚",[65,341,344],{"className":342,"code":343,"language":226,"meta":40},[224],"\n# æ˜¯å¦ç¦ç”¨ HSTSï¼ˆHTTP ä¸¥æ ¼ä¼ è¾“å®‰å…¨ï¼‰\n#disableHsts: true\n\n# Worker è¿›ç¨‹æ•°\n#clusterLimit: 1\n\n# æ¯ä¸ª worker çš„å¹¶å‘ä»»åŠ¡æ•°\n# deliverJobConcurrency: 128   # æŠ•é€’ï¼ˆå‡ºç«™ï¼‰ä»»åŠ¡å¹¶å‘\n# inboxJobConcurrency: 16      # æ”¶ä»¶ï¼ˆå…¥ç«™ï¼‰ä»»åŠ¡å¹¶å‘\n\n# ä»»åŠ¡é€Ÿç‡é™åˆ¶ï¼ˆæ¯ç§’ï¼‰\n# deliverJobPerSec: 128\n# inboxJobPerSec: 32\n\n# ä»»åŠ¡æœ€å¤§é‡è¯•æ¬¡æ•°\n# deliverJobMaxAttempts: 12\n# inboxJobMaxAttempts: 8\n\n# å¯¹å¤–å‘èµ·è¯·æ±‚æ—¶ä½¿ç”¨çš„ IP åè®®æ—ï¼ˆipv4ã€ipv6 æˆ– dualï¼‰\n#outgoingAddressFamily: ipv4\n\n# HTTP/HTTPS ä»£ç†\n#proxy: http://127.0.0.1:3128 \n\n# ä¸èµ°ä»£ç†çš„ç›´è¿ç™½åå•\nproxyBypassHosts:\n  - api.deepl.com\n  - api-free.deepl.com\n  - www.recaptcha.net\n  - hcaptcha.com\n  - challenges.cloudflare.com\n\n# SMTP/SMTPS ä»£ç†\n#proxySmtp: http://127.0.0.1:3128    # ä½¿ç”¨ HTTP/1.1 CONNECT\n#proxySmtp: socks4://127.0.0.1:1080 # ä½¿ç”¨ SOCKS4\n#proxySmtp: socks5://127.0.0.1:1080 # ä½¿ç”¨ SOCKS5\n\n# åª’ä½“ä»£ç†ï¼ˆç”¨äºéšè—ç”¨æˆ·çœŸå®åœ°å€ã€ç¼“å­˜ç¼©ç•¥å›¾ç­‰ï¼‰\n#mediaProxy: https://example.com/proxy \n\n# å‡ºäºå®‰å…¨è€ƒè™‘ï¼Œé»˜è®¤ç¦æ­¢ä»ç§ç½‘åœ°å€ä¸Šä¼ é™„ä»¶ã€‚\n# å¯é€šè¿‡ä»¥ä¸‹è®¾ç½®æ”¾è¡Œï¼Œé»˜è®¤å€¼ä¸ºâ€œæœªå®šä¹‰â€ã€‚\n# è¯¦è§ 12.90.0 (2021/09/04) æ›´æ–°æ—¥å¿—ã€‚\n#allowedPrivateNetworks: [\n#  '127.0.0.1/32'\n#]\n\n# ä¸Šä¼ /ä¸‹è½½æ–‡ä»¶å¤§å°é™åˆ¶ï¼ˆå•ä½ï¼šå­—èŠ‚ï¼‰\n#maxFileSize: 262144000    # çº¦ 250 MiB\n\n# æ—¥å¿—ç›¸å…³\n# logging:\n#   sql:\n#     # æ˜¯å¦åœ¨æ—¥å¿—ä¸­è¾“å‡º SQL æŸ¥è¯¢å‚æ•°\n#     # é»˜è®¤ï¼šfalse\n#     enableQueryParamLogging: false\n#     # æ˜¯å¦ç¦ç”¨ SQL æˆªæ–­ï¼Œè®¾ä¸º true åˆ™è¾“å‡ºå®Œæ•´ SQL æ–‡æœ¬\n#     # é»˜è®¤ï¼šfalse\n#     disableQueryTruncation: false\n",[72,345,343],{"__ignoreMap":40},[81,347,349],{"id":348},"docker-ç¯å¢ƒå˜é‡æ–‡ä»¶ä¿®æ”¹","Docker ç¯å¢ƒå˜é‡æ–‡ä»¶ä¿®æ”¹",[14,351,352,353,356],{},"ä¿å­˜å…³é—­ä¸Šé¢çš„ Misskey é…ç½®æ–‡ä»¶åï¼Œæˆ‘ä»¬æ‰“å¼€åŒç›®å½•çš„",[72,354,355],{"code":355},"docker.env","æ–‡ä»¶ï¼Œè¿™é‡Œå°†å†³å®šç¼–æ’æ–‡ä»¶å¯åŠ¨æ—¶çš„ç¯å¢ƒå˜é‡ï¼Œä¸€èˆ¬åªéœ€è¦ä¿®æ”¹æ­¤å¤„æ•°æ®åº“çš„ä¸‰æ®µå†…å®¹ï¼Œå’Œé…ç½®æ–‡ä»¶é‡Œé…ç½®çš„ä¸€æ¨¡ä¸€æ ·å³å¯ã€‚",[65,358,361],{"className":359,"code":360,"language":226,"meta":40},[224],"# Misskey è®¾ç½®\n# MISSKEY_URL=https://example.tld/ \n\n# æ•°æ®åº“è®¾ç½®\nPOSTGRES_PASSWORD=example-misskey-pass\n# DATABASE_PASSWORD=${POSTGRES_PASSWORD}\nPOSTGRES_USER=example-misskey-user\n# DATABASE_USER=${POSTGRES_USER}\nPOSTGRES_DB=misskey\n# DATABASE_DB=${POSTGRES_DB}\nDATABASE_URL=\"postgres://${POSTGRES_USER}:${POSTGRES_PASSWORD}@db:5432/${POSTGRES_DB}}\"\n",[72,362,360],{"__ignoreMap":40},[81,364,366],{"id":365},"docker-ç¼–æ’æ–‡ä»¶ä¿®æ”¹","Docker ç¼–æ’æ–‡ä»¶ä¿®æ”¹",[14,368,369],{},"å› ä¸ºæˆ‘ä»¬å‰é¢ä¿®æ”¹è¿‡æ•°æ®åº“å…¨æ–‡æœç´¢å¼•æ“ä»¥åŠæˆ‘ä»¬ä¹Ÿéœ€è¦åšä¸€äº›å®‰å…¨ç­‰ä¿®æ”¹éœ€æ±‚ï¼Œæ­¤å¤„æˆ‘ä»¬ä¹Ÿéœ€è¦å¯¹ Compose ç¼–æ’æ–‡ä»¶åšä¸€äº›ä¿®æ”¹ã€‚",[14,371,372,373,376],{},"å›åˆ° Misskey ä¸»ç›®å½•ï¼Œæ‰“å¼€ç›®å½•ä¸‹çš„",[72,374,375],{"code":375},"compose.yml","ï¼Œå†…å®¹åº”è¯¥ç±»ä¼¼å¦‚ä¸‹ï¼š",[65,378,381],{"className":379,"code":380,"language":226,"meta":40},[224],"services:\n  web:\n    build: .\n    restart: always\n    links:\n      - db\n      - redis\n#     - mcaptcha\n#     - meilisearch\n    depends_on:\n      db:\n        condition: service_healthy\n      redis:\n        condition: service_healthy\n    ports:\n      - \"3000:3000\"\n    networks:\n      - internal_network\n      - external_network\n    # env_file:\n    #   - .config/docker.env\n    volumes:\n      - ./files:/misskey/files\n      - ./.config:/misskey/.config:ro\n\n  redis:\n    restart: always\n    image: redis:7-alpine\n    networks:\n      - internal_network\n    volumes:\n      - ./redis:/data\n    healthcheck:\n      test: \"redis-cli ping\"\n      interval: 5s\n      retries: 20\n\n  db:\n    restart: always\n    image: postgres:15-alpine\n    networks:\n      - internal_network\n    env_file:\n      - .config/docker.env\n    volumes:\n      - ./db:/var/lib/postgresql/data\n    healthcheck:\n      test: \"pg_isready -U $$POSTGRES_USER -d $$POSTGRES_DB\"\n      interval: 5s\n      retries: 20\n\n#  mcaptcha:\n#    restart: always\n#    image: mcaptcha/mcaptcha:latest\n#    networks:\n#      internal_network:\n#      external_network:\n#        aliases:\n#          - localhost\n#    ports:\n#      - 7493:7493\n#    env_file:\n#      - .config/docker.env\n#    environment:\n#      PORT: 7493\n#      MCAPTCHA_redis_URL: \"redis://mcaptcha_redis/\"\n#    depends_on:\n#      db:\n#        condition: service_healthy\n#      mcaptcha_redis:\n#        condition: service_healthy\n#\n#  mcaptcha_redis:\n#    image: mcaptcha/cache:latest\n#    networks:\n#      - internal_network\n#    healthcheck:\n#      test: \"redis-cli ping\"\n#      interval: 5s\n#      retries: 20\n\n#  meilisearch:\n#    restart: always\n#    image: getmeili/meilisearch:v1.3.4\n#    environment:\n#      - MEILI_NO_ANALYTICS=true\n#      - MEILI_ENV=production\n#    env_file:\n#      - .config/meilisearch.env\n#    networks:\n#      - internal_network\n#    volumes:\n#      - ./meili_data:/meili_data\n\nnetworks:\n  internal_network:\n    internal: true\n  external_network:\n\n",[72,382,380],{"__ignoreMap":40},[214,384,386],{"id":385},"web-ç¨‹åºæœ¬ä½“","Web ç¨‹åºæœ¬ä½“",[14,388,389,390,393],{},"æˆ‘ä»¬éœ€è¦ä¿®æ”¹å®¹å™¨å¯¹å¤–æš´éœ²ä¸º",[72,391,392],{"code":392},"127.0.0.1:3000","ä½¿å¾— Misskey ä»…å¯¹ Caddy åå‘ä»£ç†æš´éœ²ç«¯å£ï¼Œä»¥åŠç§»é™¤æ‰æ— ç”¨çš„é…ç½®ï¼Œä¿®æ”¹åçš„é…ç½®æ–‡ä»¶å¤§æ¦‚å¦‚ä¸‹ï¼š",[65,395,398],{"className":396,"code":397,"language":226,"meta":40},[224],"  web:\n    build: .\n    restart: always\n    links:\n      - db\n      - redis\n    depends_on:\n      db:\n        condition: service_healthy\n      redis:\n        condition: service_healthy\n    ports:\n      - \"127.0.0.1:3000:3000\"\n    networks:\n      - internal_network\n      - external_network\n    volumes:\n      - ./files:/misskey/files\n      - ./.config:/misskey/.config:ro\n",[72,399,397],{"__ignoreMap":40},[214,401,403],{"id":402},"redis-æ•°æ®åº“","Redis æ•°æ®åº“",[14,405,406],{},"æ­¤å¤„æ— éœ€ä¿®æ”¹ï¼Œä¿æŒåŸé…ç½®å³å¯ã€‚",[65,408,411],{"className":409,"code":410,"language":226,"meta":40},[224],"\n  redis:\n    restart: always\n    image: redis:7-alpine\n    networks:\n      - internal_network\n    volumes:\n      - ./redis:/data\n    healthcheck:\n      test: \"redis-cli ping\"\n      interval: 5s\n      retries: 20\n",[72,412,410],{"__ignoreMap":40},[214,414,416],{"id":415},"postgresql-æ•°æ®åº“","PostgreSQL æ•°æ®åº“",[14,418,419,420,423],{},"æˆ‘ä»¬éœ€è¦æŠŠæ•°æ®åº“é•œåƒæ›´æ¢ä¸º",[72,421,422],{"code":422},"pgroonga","ä»¥è®©å®ƒæ”¯æŒ sqlPgroonga å…¨æ–‡æœç´¢ã€‚",[65,425,428],{"className":426,"code":427,"language":226,"meta":40},[224],"  db:\n    restart: always\n    image: groonga/pgroonga:4.0.1-alpine-17\n    networks:\n      - internal_network\n    env_file:\n      - .config/docker.env\n    volumes:\n      - ./db:/var/lib/postgresql/data\n    healthcheck:\n      test: \"pg_isready -U $$POSTGRES_USER -d $$POSTGRES_DB\"\n      interval: 5s\n      retries: 20\n",[72,429,427],{"__ignoreMap":40},[14,431,432],{},"ä¿å­˜å…³é—­é€€å‡ºï¼Œæˆ‘ä»¬å°±å®Œæˆäº† Docker Compose çš„ç›¸å…³é…ç½®äº†ï¼Œè¯¥å‡†å¤‡å¯åŠ¨ç¼–æ’äº†ã€‚",[81,434,435],{"id":435},"æ„å»ºå’Œåˆå§‹åŒ–",[14,437,438],{},"æ‰§è¡Œä»¥ä¸‹å‘½ä»¤è¿›è¡Œ Misskey é•œåƒæ„å»ºå’Œæ•°æ®åº“åˆå§‹åŒ–ï¼Œéœ€è¦ç­‰å¾…ä¸€æ®µæ—¶é—´å®Œæˆã€‚",[65,440,443],{"className":441,"code":442,"language":70,"meta":40},[68],"sudo docker compose build\nsudo docker compose run --rm web pnpm run init\n",[72,444,442],{"__ignoreMap":40},[81,446,447],{"id":447},"å¯åŠ¨ç¼–æ’",[65,449,452],{"className":450,"code":451,"language":70,"meta":40},[68],"sudo docker compose up -d\n",[72,453,451],{"__ignoreMap":40},[10,455,456],{"id":456},"å®Œæˆ",[14,458,459],{},"åœ¨ç¼–æ’å¯åŠ¨åï¼Œå¦‚æœä½ çš„åŸŸåå’ŒæœåŠ¡å™¨ Caddy é…ç½®æ­£ç¡®ï¼Œä½ åº”è¯¥å°±å¯ä»¥åœ¨ä½ è®¾ç½®çš„åŸŸåä¸Šçœ‹åˆ° Misskey çš„åˆå§‹åŒ–é¡µé¢äº†ï¼",[14,461,462],{},"ğŸ‰æ­å–œä½ å®Œæˆäº† Misskey çš„åŸºæœ¬å…¨é‡éƒ¨ç½²ï¼",{"title":40,"searchDepth":464,"depth":464,"links":465},4,[466,468,469,470,476,496],{"id":12,"depth":467,"text":12},2,{"id":19,"depth":467,"text":19},{"id":56,"depth":467,"text":57},{"id":79,"depth":467,"text":79,"children":471},[472,474,475],{"id":83,"depth":473,"text":83},3,{"id":100,"depth":473,"text":101},{"id":120,"depth":473,"text":121},{"id":174,"depth":467,"text":175,"children":477},[478,479,488,489,494,495],{"id":178,"depth":473,"text":179},{"id":200,"depth":473,"text":201,"children":480},[481,482,483,484,485,486,487],{"id":216,"depth":464,"text":217},{"id":231,"depth":464,"text":232},{"id":246,"depth":464,"text":246},{"id":298,"depth":464,"text":299},{"id":311,"depth":464,"text":311},{"id":323,"depth":464,"text":324},{"id":336,"depth":464,"text":336},{"id":348,"depth":473,"text":349},{"id":365,"depth":473,"text":366,"children":490},[491,492,493],{"id":385,"depth":464,"text":386},{"id":402,"depth":464,"text":403},{"id":415,"depth":464,"text":416},{"id":435,"depth":473,"text":435},{"id":447,"depth":473,"text":447},{"id":456,"depth":467,"text":456},[498],"è”é‚¦å®‡å®™","2025-10-24 05:00:00","æœ¬æ–‡ä»‹ç»äº†å¦‚ä½•åœ¨å•å°æœåŠ¡å™¨ä¸Šå…¨é‡éƒ¨ç½²è”é‚¦å®‡å®™ç¤¾äº¤å¹³å° Misskey åŠå…¶é…å¥—ç»„ä»¶ã€‚æ–‡ç« ä»å‡†å¤‡é˜¶æ®µå¼€å§‹ï¼Œå»ºè®®ä½¿ç”¨è‡³å°‘ 2 æ ¸ 4G çš„æœåŠ¡å™¨ï¼Œå¹¶å¼ºè°ƒéƒ¨ç½²åä¸å¯æ›´æ¢åŸŸåã€‚æ¥ç€è¯¦ç»†è¯´æ˜äº†å®‰è£… Dockerã€Caddy åå‘ä»£ç†çš„æ­¥éª¤ï¼ŒåŒ…æ‹¬è‡ªåŠ¨ HTTPS è¯ä¹¦çš„ç”³è¯·ä¸é…ç½®ã€‚ç„¶åé€æ­¥æŒ‡å¯¼è·å– Misskey æºç ã€é…ç½®æ•°æ®åº“ï¼ˆPostgreSQL ä¸ Redisï¼‰ã€è®¾ç½®å…¨æ–‡æœç´¢ï¼ˆä½¿ç”¨ sqlPgroongaï¼‰ä»¥åŠè°ƒæ•´ Docker Compose æ–‡ä»¶ã€‚æœ€åï¼Œé€šè¿‡æ„å»ºé•œåƒã€åˆå§‹åŒ–æ•°æ®åº“å¹¶å¯åŠ¨å®¹å™¨ï¼Œå®Œæˆ Misskey çš„éƒ¨ç½²ï¼Œç”¨æˆ·å¯é€šè¿‡åŸŸåè®¿é—®åˆå§‹åŒ–é¡µé¢ã€‚",false,"md","https://misskey-hub.net/img/hero/ss/tl.light.webp",{},true,"/2025/10/misskey-fediverse-deploy",null,{"text":509,"minutes":510,"time":511,"words":512},"15 min read",14.37,862200,2874,6,{"title":5,"description":500},{"loc":506},"posts/2025/10/misskey-fediverse-deploy",[518,519],"Fediverse","Website","tech","NRnLCTfhZX4SEDjEeJSEYoX64fXeQmL4AvpuxW-veS4",[523,528],{"title":524,"path":525,"stem":526,"date":527,"type":520,"children":-1},"Affine éƒ¨ç½²ï¼šè‡ªæ‰˜ç®¡ç±» Notion çŸ¥è¯†åº“ç³»ç»Ÿ","/2025/10/affine-deploy","posts/2025/10/affine-deploy","2025-10-23 05:00:00",{"title":529,"path":530,"stem":531,"date":532,"type":520,"children":-1},"OtterWiki éƒ¨ç½²ï¼šåŸºäº Python çš„è½»é‡çŸ¥è¯†åº“ç³»ç»Ÿ","/2025/10/otterwiki-deploy","posts/2025/10/otterwiki-deploy","2025-10-24 22:00:00",1761868721231]